\usepackage[utf8]{inputenc}
---
output:
  pdf_document: default
  html_document: default
---


![](../tmp/cropped-banner_efpt.jpg)

# EFPT
The European Federation of psychiatric trainees (EFPT) is an independent federation of psychiatric trainees associations. It represents the consensus of psychiatric trainees organizations across European countries and advocates for what training should look like, regardless of the country. 

[EFPT website](http://efpt.eu/) 

# Presentation
The psychotherapy study run from 2013 to 2015 to understand the actual opportunities and wishes for training in psychotherapy in Europe among psychiatrist trainees in 19 countries.

## Presentations of the survey
### Past
* "The EFPT Psychotherapy working Group and its Survey on Psychotherapy Training 2013-2015" was presented at the [Royal College of Psychiatrists](http://www.rcpsych.ac.uk/pdf/CALC_MedPsych2015confbooklet.pdf) - faculty of Psychotherapy Annual Meeting 22-24 April 2015 by Alina Petricean (UK, Romania)
* "The EFPT Psychotherapy working group" was presented at the "Portuguese Psychiatric National Congress in 2013 by Rita Silva (Portugal)
* "Should all psychiatrists be skilled to practice psychotherapy ? Thomas GARGOT (France) and Ekin Sonmez (Turkey), [European Psychiatric Association Congress](http://efpt.eu/events/european-psychiatric-association-congress/), March 12th - March 15th 2016, [slides](http://efpt.eu/wp-content/uploads/2014/07/ES_TG_EPA_Psychotherapy.pdf)
* "How psychiatrist trainees are trained in Psychotherapies in Europe ? A European trainee survey", Thomas GARGOT (France), [European Association of Behavioural and Cognitive Therapies conference (EABCT)](http://eabct2016.org/), August 31st - September 3rd 2016, deadline 31st march
![](https://i0.wp.com/efpt.eu/wp-content/uploads/2014/07/eabct.jpg?w=720)


# To do list
It can be found [here](https://github.com/r0bis/efptPWG/blob/master/about-data/todolist.md).

# Actual recommandations
## EFPT Psychotherapy Working Group statement
"A working knowledge of psychotherapy is an integral part of being a psychiatrist and this must be reflected in training in psychiatry. All trainees must gain the knowledge, skills and attitudes to be competent in psychotherapy. Competence should be gained in at least one recognised form of psychotherapy (of the trainees choice) and basic knowledge should be gained in the other forms of psychotherapy to allow the trainee to evaluate suitability for referral to specialist psychotherapist.
Training in psychotherapy must include supervision by qualified therapists. A personal psychotherapeutic experience is seen as a valuable component of training. It is crucial that trainees have access to relevant psychotherapy experience to cater to the needs of the appropriate patient group that the trainee is dealing with or is expected to deal with in the future.

Relevant training authorities should ensure that time, resources and funding are available to all trainees to meet the above mentioned psychotherapy training needs."

Discussed and voted by EFPT delegates in Lisbon 1996, Tampere 1999, Napoli 2001, Sinaia 2002, Paris 2003, Istanbul 2005, Gothenburg 2008, Cambridge 2009 and Zurich 2013

[See all EFPT statements](http://efpt.eu/statements/).

## UEMS Psychotherapy Reports
See all UEMS reports related to [psychiatry training](http://uemspsychiatry.org/board/training-reports/).

# Get the data
You can download our data and our analysis script on [GitHub](https://github.com/r0bis/efptPWG).

```{r, include = FALSE}
#install.packages(c("lattice", "ggplot2", "knitr", "plyr", likert", "rmarkdown", "maps", "mapdata","stringr"))
library (lattice)
library(ggplot2)
library(knitr)
library(likert)
library(plyr)
library(rmarkdown)
library(stringr)
library(Hmisc)
library(choroplethr)
library(choroplethrMaps)
search()
```

```{r, echo=TRUE, include=FALSE}
#Set working directory
setwd("~/src/efptPWG/bin")
getwd()

## Import the data and change the variables names
readEFPTfiles <- function(f) {
  if (as.character(f)!="") {
    oldwd <- getwd()
    z <- file.path("..","data",f)
    setwd(z)
    source(paste(f,"_R_syntax_file.R",sep = ""),local = T)
    toGlEnvFrame <- data[str_detect(colnames(data),"^id$|^q_.*")]
    parentFrame <- paste(f,"_data",sep = "")
    assign(parentFrame,toGlEnvFrame,envir=.GlobalEnv)
    setwd(oldwd)
    }
  else {print("")}
}

dat.files  <- list.files(path="..", recursive=F, pattern=".*syntax_file.R$",full.names=F)
dat.dirs  <- list.dirs(path="../data/", recursive=T,full.names=F)

sapply(dat.dirs, readEFPTfiles)

correctColumns <- colnames(Bulgaria_data)
incorrectColumns <- colnames(Czech_Republic_data)
setdiff(correctColumns,incorrectColumns)

Czech_Republic_data["q_0000"] <- as.factor("Czech Republic")
Czech_Republic_data["q_0012_other"] <- as.numeric(NA)
Czech_Republic_data <- Czech_Republic_data[colnames(Bulgaria_data)]

Slovenia_data["q_0000"] <- as.factor("Slovenia")
Slovenia_data["q_0012_other"] <- as.numeric(NA)
Slovenia_data <- Slovenia_data[colnames(Bulgaria_data)]

# France_data$q_0000 <- ifelse((is.na(France_data$q_0000)==FALSE), c("France"), c(NA)) 
#France_data$q_0000 <- ifelse((is.na(France_data$q_0000)==FALSE), c("France"), c(NA))
### List of countries studied
list <- list.files("data", full.names=FALSE)
print(list)

### Binding datasets
listof.df <- lapply(ls(), function(x) if (class(get(x)) == "data.frame") get(x))
data_Europe <- do.call("rbind", listof.df)
```

# European results
```{r,include = FALSE, eval=TRUE}
dim(data_Europe)
str(data_Europe)
summary(data_Europe)

data_mini_Europe <- subset(data_Europe, select=c(q_0000, q_0005_S05A1, q_0005_S05A2, q_0008, q_0019_SQ002, q_0019_SQ003))
supervision <- (data_Europe$q_0014_SQ001+ data_Europe$q_0014_SQ002 + data_Europe$q_0014_SQ003 + data_Europe$q_0014_SQ004 + data_Europe$q_0014_SQ005)

data_mini_Europe <- cbind(data_mini_Europe,supervision)

#Country variable
#str(data_mini_Europe)
#unique(data_mini_Europe$q_0000)

#I am undertaking training in Psychotherapy within my training programme in Psychiatry : in.training
#unique(data_mini_Europe$q_0005_S05A1)
#length(unique(data_mini_Europe$q_0005_S05A1))
data_mini_Europe$q_0005_S05A1 <- as.character(data_mini_Europe$q_0005_S05A1)
data_mini_Europe$q_0005_S05A1[data_mini_Europe$q_0005_S05A1=="Yes"]<-"1"
data_mini_Europe$q_0005_S05A1[data_mini_Europe$q_0005_S05A1=="Not selected"]<-"0"
data_mini_Europe$q_0005_S05A1 <- as.numeric(data_mini_Europe$q_0005_S05A1)
#str(data_mini_Europe$q_0005_S05A1)

#I am undertaking training in Psychotherapy on my own initiative (outside my training programme in Psychiatry): own.initiative
#unique(data_mini_Europe$q_0005_S05A2)
#length(unique(data_mini_Europe$q_0005_S05A2))
data_mini_Europe$q_0005_S05A2 <- as.character(data_mini_Europe$q_0005_S05A2)
data_mini_Europe$q_0005_S05A2[data_mini_Europe$q_0005_S05A2=="Yes"]<-"1"
data_mini_Europe$q_0005_S05A2[data_mini_Europe$q_0005_S05A2=="Not selected"]<-"0"
data_mini_Europe$q_0005_S05A2 <- as.numeric(data_mini_Europe$q_0005_S05A2)
#str(data_mini_Europe$q_0005_S05A2)

#Do you want to practise Psychotherapy after your training in Psychiatry? : future.practice
unique(data_mini_Europe$q_0008)
data_mini_Europe$q_0008 <- as.character(data_mini_Europe$q_0008)
data_mini_Europe$q_0008[data_mini_Europe$q_0008=="Yes"]<-"1"
data_mini_Europe$q_0008[data_mini_Europe$q_0008=="No"]<-"0"
data_mini_Europe$q_0008 <- as.numeric(data_mini_Europe$q_0008)
#str(data_mini_Europe$q_0008)

#I am satisfied with Psychotherapy training options in my country : satisfied
#unique(data_mini_Europe$q_0019_SQ002)
data_mini_Europe$q_0019_SQ002 <- as.character(data_mini_Europe$q_0019_SQ002)
data_mini_Europe$q_0019_SQ002[data_mini_Europe$q_0019_SQ002=="Strongly Disagree"] <- "-2"
data_mini_Europe$q_0019_SQ002[data_mini_Europe$q_0019_SQ002=="Disagree"] <- "-1"
data_mini_Europe$q_0019_SQ002[data_mini_Europe$q_0019_SQ002=="Neutral"] <- "0"
data_mini_Europe$q_0019_SQ002[data_mini_Europe$q_0019_SQ002=="Agree"] <- "1"
data_mini_Europe$q_0019_SQ002[data_mini_Europe$q_0019_SQ002=="Strongly Agree"] <- "2"
data_mini_Europe$q_0019_SQ002 <- as.numeric(data_mini_Europe$q_0019_SQ002)
#str(data_mini_Europe$q_0019_SQ002)

# I am satisfied with the level of funding for Psychotherapy training within Psychiatry in my country : satisfied.funding
#unique(data_mini_Europe$q_0019_SQ003)
data_mini_Europe$q_0019_SQ003 <- as.character(data_mini_Europe$q_0019_SQ003)
data_mini_Europe$q_0019_SQ003[data_mini_Europe$q_0019_SQ003=="Strongly Disagree"] <- "-2"
data_mini_Europe$q_0019_SQ003[data_mini_Europe$q_0019_SQ003=="Disagree"] <- "-1"
data_mini_Europe$q_0019_SQ003[data_mini_Europe$q_0019_SQ003=="Neutral"] <- "0"
data_mini_Europe$q_0019_SQ003[data_mini_Europe$q_0019_SQ003=="Agree"] <- "1"
data_mini_Europe$q_0019_SQ003[data_mini_Europe$q_0019_SQ003=="Strongly Agree"] <- "2"

#View(data_mini_Europe)
data_mini_Europe$q_0019_SQ003 <- as.numeric(data_mini_Europe$q_0019_SQ003)
data_mini_Europe$q_0000 <- as.character(data_mini_Europe$q_0000)
unique(data_mini_Europe$q_0000)
data_mini_Europe <-data_mini_Europe[!is.na(data_mini_Europe$q_0000),]
data_mini_Europe$q_0000 <- as.factor(data_mini_Europe$q_0000)
#str(data_mini_Europe)
```

```{r, eval=TRUE}
names(data_mini_Europe) <- c("country", "in.training", "own.initiative", "future.practice", "satisfied", "satisfied.funding", "hours.supervision")
#str(data_mini_Europe)
country <- data_mini_Europe$country
mini <- aggregate(data_mini_Europe[-1], by=list(country), FUN = mean, na.rm=TRUE, simplify = TRUE)
colnames(mini)[colnames(mini)=="Group.1"] <- "country"
#Exclusion of Belarus, Serbia, Croatia : not full
mini <- mini[complete.cases(mini),]

in.training.sort <- mini[with(mini, order(-in.training)), ]
par(mar=c(11,3,3,3))
barplot(in.training.sort$in.training, names=in.training.sort$country, las=2, main="Proportion of respondents in psychotherapy training 
        in each country", col="cornflowerblue")
abline(h=0.52, lty=2)
text(23, 0.6, "Mean")
oi.sort <- mini[with(mini, order(-own.initiative)), ]
barplot(oi.sort$own.initiative, names=oi.sort$country, las=2, main="Proportion of respondents in psychotherapy training 
        in each country on their own initiative", col="cornflowerblue")
abline(h=0.33, lty=2)
text(22, 0.40, "Mean")

future.sort <- mini[with(mini, order(-future.practice)), ]
barplot(future.sort$future.practice, names=future.sort$country, las=2, main="Proportion of respondents who would 
        like to practice psychotherapy in the future", col="cornflowerblue")
abline(h=0.89, lty=2)
text(23, 0.95, "Mean")

par(mar=c(11,3,3,2))
satisfied.sort <- mini[with(mini, order(-satisfied)), ]
barplot(satisfied.sort$satisfied, names=satisfied.sort$country, las=2, main="Mean satisfaction of respondents regarding 
        the quality of their psychotherapy training", col="cornflowerblue", ylim=c(-2,2))
abline(h=-0.20, lty=2)
text(15, -1, "Mean")

par(mar=c(11,3,3,2))
satisfied.funding <- mini[with(mini, order(-satisfied.funding)), ]
barplot(satisfied.funding$satisfied.funding, names=satisfied.funding$country, las=2, main="Mean satisfaction of respondents regarding the  
    funding of their psychotherapy training", col="cornflowerblue", ylim=c(-2,2))
abline(h=-1.03, lty=2)
text(13, -1.5, "Mean")
#write.csv(mini,"aggregate.file.csv")
```

## Number of participants by country (barplot)
```{r, echo = FALSE}
# table(data_Europe[which(complete.cases(data_Europe$q_0000)==TRUE),]$q_0000)
countryanswers <- sort(table(data_Europe$q_0000), decreasing = FALSE)
answering_countries <- countryanswers[which (countryanswers > 0)]
#delete France false data
answering_countries <- answering_countries[-3]

par(mar=c(2.5,9.5,2,2))
barplot(answering_countries, cex.names=0.9, las=1, main="Number of answers by country", col="cornflowerblue", horiz=TRUE, border=NA)
text(45,6, paste(length(answering_countries), "countries
                Total of answers :", sum(answering_countries),
                 "
                              Mean answers by country: " , round(mean(answering_countries)),"
               
                      Top 4: Romania, France, 
                      Slovenia, Czech Republic"), cex=1.2)
abline(v=mean(answering_countries), lty=2)
```

## Number of participants by country (map)
```{r, echo=TRUE, warning=FALSE, eval=TRUE}
names <- names(countryanswers)
namesLower <- upFirst(names, alllower=TRUE)

#Replace the upper cases by lower cases
DF <- data.frame(namesLower, countryanswers, stringsAsFactors=FALSE)
names(DF) <- c("region", "value")

# change serbia by republic of serbia
DF[which(DF$region=="serbia"),1] <- "republic of serbia"

# deleting malta which is not in your regions
DF <-DF[-which(DF$region=="malta" | DF$region=="andorra" | DF$region=="liechtenstein" | DF$region=="monaco" | DF$region=="san marino"),]

## Problem with France data
DF <- DF[-26,]
## Discussion here

country_choropleth(DF,
                legend = "Number",
               zoom = c("albania", "armenia", "austria", "azerbaijan", "belgium", "bosnia and herzegovina", "belarus", "bulgaria", "croatia",   "cyprus"  , "czech republic", "denmark", "greece", "estonia", "finland", "france",  "georgia", "germany", "hungary", "iceland", "kazakhstan", "luxembourg", "netherlands", "norway", "ireland", "israel", "italy", "ireland", "latvia", "lithuania", "macedonia", "moldova", "montenegro", "poland", "portugal", "romania", "russia", "slovakia", "slovenia", "spain", "sweden", "switzerland", "united kingdom", "republic of serbia", "turkey", "ukraine")) + xlim(-20,30) + ylim(30,75) + ggtitle("Participants of the study") + theme(plot.title = element_text(lineheight=15, face="bold"))
```

## Gender
```{r, echo=TRUE, fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
gender <-table(data_Europe$q_0001)
#prop.table(gender)
pie(gender, main="Gender of participants in Europe reponses")
gender
prop.table(gender)
prop.test(gender)
```

##Age
```{r, echo=TRUE,  fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
#error max = 1969 !!!
age_Europe <- data_Europe$q_0002[which(data_Europe$q_0002<1969)]
hist(age_Europe, col="cornflowerblue",
     xlab="Age", ylab="Number", main="Age distribution", freq=TRUE, border=NA, breaks=25 )
text(47, 40, paste("Mean age:", round(mean(age_Europe),0), "years"))
text(47, 30, paste("Median age:", round(median(age_Europe),0), "years"))
abline(v=mean(age_Europe), lty=2)
median(age_Europe)
mean(age_Europe)
sd(age_Europe)
```

## Year in Training
```{r, echo=TRUE}
YoT <- table(data_Europe$q_0003)
names(YoT)<- c(1:8, "> 8", "TF")
par(mfrow=c(1,1), mar=c(3,3,2,2))
barplot(YoT, main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number", cex.names=1)

#Proportion of trainees 
length(YoT)
sum(YoT[1:9])
YoT[10]
YoT[10]/sum(YoT[1:9])
```
>TF : for training finished

## Are you receiving personal psychotherapy or have you received it in the past?
```{r, echo=TRUE}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
data_Europe[, 7] <- as.numeric(data_Europe[, 7])
attributes(data_Europe)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
data_Europe[, 7] <- factor(data_Europe[, 7], levels=c(1,2),labels=c("Yes","No"))
names(data_Europe)[7] <- "q_0004"
#table(data_Europe$q_0004)
par(mar=c(3,3,2,2))
table(data_Europe$q_0004)
prop.table(table(data_Europe$q_0004))
prop.test(table(data_Europe$q_0004))
pie(table(data_Europe$q_0004), main = "Receiving personal psychotherapy (present or past)")
```

```{r, echo=TRUE}
## I am undertaking training in Psychotherapy within my training programme in Psychiatry
## NO DATA ????
#tab <- table(data_Europe$q_0005_S05A1)
#length(tab)
#pie(table(data_Europe$q_0005_S05A1), main="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r, echo=TRUE}
table(data_Europe$q_0005_S05A2)
prop.table(table(data_Europe$q_0005_S05A2))
prop.test(table(data_Europe$q_0005_S05A2))
pie(table(data_Europe$q_0005_S05A2), main="Training in psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r, echo=TRUE}
table(data_Europe$q_0005_S05A3)
prop.table(table(data_Europe$q_0005_S05A3))

prop.test(table(data_Europe$q_0005_S05A3))
pie(table(data_Europe$q_0005_S05A3),  main="I am not undertaking any training in Psychotherapy")
```
> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r, echo=TRUE}
#table(data_Europe$q_0005_S05A4)
table(data_Europe$q_0005_S05A4)
prop.table(table(data_Europe$q_0005_S05A4))
prop.test(table(data_Europe$q_0005_S05A4))
pie(table(data_Europe$q_0005_S05A4), main="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality of psychotherapy
```{r, echo=TRUE}
#If NA : I am not training in any modality of psychotherapy
table(is.na(data_Europe$q_0006))
prop.table(table(is.na(data_Europe$q_0006)))
prop.test((table(is.na(data_Europe$q_0006))))
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r, echo=TRUE}
table(data_Europe$q_0007)
prop.table(table(data_Europe$q_0007))
tab <- table(data_Europe$q_0007)
k = sum(na.omit(data_Europe$q_0007 == "Yes"))
n= length(na.omit(data_Europe$q_0007))
prop.test(k,n)
k  
n
pie(table(data_Europe$q_0007), main="Psychotherapy important for the professional identity", col=terrain.colors(3))
```

## Do you want to practise Psychotherapy ?
```{r, echo=TRUE}
table(data_Europe$q_0008)
prop.table(table(data_Europe$q_0008))
prop.test(table(data_Europe$q_0008))
k = sum(na.omit(data_Europe$q_0007 == "Yes"))
n= length(na.omit(data_Europe$q_0007))
prop.test(k,n)
k  
n
pie(table(data_Europe$q_0008), main="Plan to practise Psychotherapy after training")
```

## Are you interested in this psychotherapy?
```{r, echo=TRUE}
q9df <- data_Europe[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","Not Any","Other"),main="Interested in this therapy", las=1, col=rainbow(6),)

#How many for more than one psychotherapy ?
for  (i in 1:4)
  {q9df[,i] <- as.character(q9df[,i])
  q9df[(which(q9df[,i]=="Yes")),i] <- 1
  q9df[(which(q9df[,i]=="Not selected")),i] <- 0}

for ( i in 1:4)
{q9df[,i] <- as.numeric(q9df[,i])}

q9df$cum <- rowSums(q9df[,1:4])
prop.table(table(q9df$cum))

c(sum(prop.table(table(q9df$cum))[1:2]),
sum(prop.table(table(q9df$cum))[3:4]))
```

##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"
```{r, echo=TRUE, eval=FALSE}

barplot(table(data_Europe$q_0011_SQ001), col="green", main="Theoretical lectures or seminars in psychotherapy", border=NA)
abline(v=1.3, lwd=3)
text(0.6,215, "UEMS <", adj = c(0, -.1), font=2)
```
> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r, echo=TRUE}
TL <- table(data_Europe$q_0011_SQ001)
PNS <- table(data_Europe$q_0011_SQ002)
PWS <- table(data_Europe$q_0011_SQ003)
PP <- table(data_Europe$q_0011_SQ004)

k = sum(na.omit(data_Europe$q_0011_SQ001 == "Yes"))
n= length(na.omit(data_Europe$q_0011_SQ001))
prop.test(k,n)

k = sum(na.omit(data_Europe$q_0011_SQ003 == "Yes"))
n= length(na.omit(data_Europe$q_0011_SQ003))
prop.test(k,n)

k = sum(na.omit(data_Europe$q_0011_SQ004 == "Yes"))
n= length(na.omit(data_Europe$q_0011_SQ004))
prop.test(k,n)

mandatory <- cbind(prop.table(TL),prop.table(PNS), prop.table(PWS), prop.table(PP))
par(mar=c(8,6,7,9), xpd=TRUE)
barplot(mandatory, col=terrain.colors(3), names=c("Theorical lectures", "Psychotherapy 
without supervision", "Psychotherapy 
with supervision", "Personnal 
psychotherapy"), cex.name=0.9, las=2, main="The following experience in psychotherapy 
is a mandatory part of my training in Psychiatry", cex.main=1.5)
legend("topright", inset=c(-0.4,-0.3), legend = c("Yes", "No", "Uncertain"), fill=(terrain.colors(3)), cex=0.5, bty="n")
mandatory
bmp(file = "fig2.bmp")
```

```{r, echo=TRUE}
table(data_Europe$q_0012)
qualified <- prop.table(table(data_Europe$q_0012))
prop.table(table(data_Europe$q_0012))

k = sum(na.omit(data_Europe$q_0012 == "Yes"))
n= length(na.omit(data_Europe$q_0012))
prop.test(k,n)

par(mar=c(4,5,5,3))
barplot(qualified, col=terrain.colors(3) , main="Are you qualified 
        to practice psychotherapy after your training ?", las=1, ylab="Frequency", cex.names=1.4, cex.lab=1.4, cex.main=1.4)
qualified
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
```{r, echo=TRUE}
#table(data_Europe$q_0013)
```

## How many hours of supervision
```{r, echo=TRUE}
par(mar=c(5,5,3,3), xpd=FALSE)
hist(data_Europe$q_0014_SQ001[which(is.na(data_Europe$q_0014_SQ001)==FALSE)], col="cornflowerblue", xlim=c(0,10), main ="Repartition of the hours of supervision in Europe", ylab="Frequency", xlab= "Hours by month", lwd=3, las=1, cex.lab=1.3, cex.main=1.3, breaks=10, freq=FALSE)
text(3.5, 0.30, paste(" Mean :",round(mean(data_Europe$q_0014_SQ001[which(is.na(data_Europe$q_0014_SQ001)==FALSE)]),2), "h"), font=2, cex=1.5, col="cornflowerblue")
text(3.3, 0.20, paste(" Median :", (median(data_Europe$q_0014_SQ001[which(is.na(data_Europe$q_0014_SQ001)==FALSE)])), "h"), font=2, cex=1.5, col="cornflowerblue")
abline(v=mean(data_Europe$q_0014_SQ001[which(is.na(data_Europe$q_0014_SQ001)==FALSE)]), col="cornflowerblue", lwd=3)
abline(v=1.7, lty=3, lwd=3)
text(3.5,0.40, "UEMS > 1.7h", font=2, cex=1.5)
#lines(density(data_Europe$q_0014_SQ002[which(is.na(data_Europe$q_0014_SQ002)==FALSE)]), col=rainbow(5)[2])
#lines(density(data_Europe$q_0014_SQ003[which(is.na(data_Europe$q_0014_SQ003)==FALSE)]), col=rainbow(5)[3])
#lines(density(data_Europe$q_0014_SQ004[which(is.na(data_Europe$q_0014_SQ004)==FALSE)]), col=rainbow(5)[4])
#lines(density(data_Europe$q_0014_SQ005[which(is.na(data_Europe$q_0014_SQ005)==FALSE)]), col=rainbow(5)[5])
#legend("topright", legend=c("Hours of Psychotherapy supervision per month", "Small group supervision (3 - 5 people)", "Large group supervision (more than 5 people)", "Generic Balint group", "Other form of supervision"), fill = rainbow(4), cex=0.7)
mean = mean(data_Europe$q_0014_SQ001[which(is.na(data_Europe$q_0014_SQ001)==FALSE)])
median(data_Europe$q_0014_SQ001[which(is.na(data_Europe$q_0014_SQ001)==FALSE)])
s <- sd(data_Europe$q_0014_SQ001[which(is.na(data_Europe$q_0014_SQ001)==FALSE)])
n <- length((data_Europe$q_0014_SQ001[which(is.na(data_Europe$q_0014_SQ001)==FALSE)]))
error <- qnorm(0.975)*s/sqrt(n)
IC = c(mean - error, mean+error)
IC

super <- data_Europe$q_0014_SQ001[which(is.na(data_Europe$q_0014_SQ001)==FALSE)]

super<-cut(super, c(0,1,10), include.lowest = TRUE, right=FALSE)

table(super)
barplot(prop.table(table(super)))
 a<- sort(table(super))
 str(table(super))
 sort(table(super))
str(sort(table(super)))
prop.test(as.table(sort(table(super))))
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r, echo=TRUE, eval=FALSE}
hist(data_Europe$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(2.5,300, "> UEMS", font=2)
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(data_Europe$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(data_Europe$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(data_Europe$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r, echo=TRUE, eval=FALSE}
hist(data_Europe$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

```{r}
#table(data_Europe$q_0015)
```


##Who pays?

```{r, echo=TRUE}
par(mar=c(6,2.5,3,9), xpd=TRUE)
payTL <- table(data_Europe$q_0016_SQ001)
paySI <- table(data_Europe$q_0016_SQ002)
paySG <- table(data_Europe$q_0016_SQ003)
payBG <- table(data_Europe$q_0016_SQ004)
paySP <- table(data_Europe$q_0016_SQ005)
paySE <- table(data_Europe$q_0016_SQ006)
pay <- cbind(prop.table(payTL), prop.table(paySI), prop.table(paySG), prop.table(payBG), prop.table(paySP), prop.table(paySE))
barplot(pay, col=terrain.colors(4),
        main="Who pays?",
        names=c("Theorectical 
lectures", "Supervision 
indiv.", "Supervision 
group", "Balint
groups ", "Sessions
with patient(s)", "Self
experience"), cex.name=0.8, las=2)
legend("topright", inset=c(-0.38,0), legend = c("I pay", "The state pays", "I don't have", "Free"), fill=(terrain.colors(4)), cex=0.9, bty="n")

payTL
payTL <- table(data_Europe$q_0016_SQ001)
prop.table(payTL)
k = sum(na.omit(data_Europe$q_0016_SQ001 == "State / 3rd party pays"))
n= length(na.omit(data_Europe$q_0016_SQ001))
prop.test(k,n)

prop.table(payTL)
k = sum(na.omit(data_Europe$q_0016_SQ001 == "I pay"))
n= length(na.omit(data_Europe$q_0016_SQ001))
prop.test(k,n)

paySG
paySG <- table(data_Europe$q_0016_SQ003)
prop.table(paySG)
k = sum(na.omit(data_Europe$q_0016_SQ003 == "State / 3rd party pays"))
n= length(na.omit(data_Europe$q_0016_SQ003))
prop.test(k,n)
```

## Would you train for free?
```{r, echo=TRUE}
table(data_Europe$q_0017)
prop.table(table(data_Europe$q_0017))
prop.test(table(data_Europe$q_0017))
par(mar=c(3,2,2,2))
pie(table(data_Europe$q_0017),
    main="Motivated to train in Psychotherapy for free?")
text(-0.2,-0.95, "UEMS recommendations states that psychotherapy training 
of trainees should be funded publicly and free for trainees.")
```

## How much would you invest in psychotherapy training ?
```{r, echo=TRUE}
par(mar=c(6,2.5,3,2), xpd=FALSE)
hist(data_Europe$q_0018[which(data_Europe$q_0018<100)], col="light green",
     main="% of annual salary for psychotherapy training",
     xlab="Percentage of your annual salary do you intend to spend on funding your psychotherapy training In the next 12 months?", cex.lab=1.1, cex.main=1.7)
abline(v=mean(data_Europe$q_0018[which(data_Europe$q_0018<100)]), lwd=2, lty=2)
text(20, 200, paste("Mean :",round( mean(data_Europe$q_0018[which(data_Europe$q_0018<100)])), " %"), font=2, cex=1.3)
text(20, 150, paste("Median :" , median(data_Europe$q_0018[which(data_Europe$q_0018<100)]), " %"), font=2, cex=1.3)

salary<-cut(data_Europe$q_0018[which(data_Europe$q_0018<100)], c(0,5,100), right=FALSE, include.lowest = TRUE)
prop.table(table(salary))

prop.test(as.table(sort(table(salary), decreasing =TRUE)))
```

## Satisfaction group
```{r, echo=TRUE}
# make auxiliary table to hold our likert data_Europe
sat1<-data_Europe[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(data_Europe$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- data_Europe[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## UEMS recommendations awareness
```{r, echo=TRUE}
# and same with the
uems2 <- data_Europe[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

# Albania results
```{r,include = FALSE}
dim(Albania_data)
str(Albania_data)
summary(Albania_data)
```

## Number of participants
```{r, echo = FALSE}
# table(Albania_data[which(complete.cases(Albania_data$q_0000)==TRUE),]$q_0000)
countryanswers <- sort(table(Albania_data$q_0000), decreasing = FALSE)
answering_countries <- countryanswers[which (countryanswers > 0)]
#delete France false data
answering_countries <- answering_countries[-3]

par(mar=c(2.5,9.5,2,2))
barplot(answering_countries, cex.names=0.9, las=1, main="Number of answers by country", col="cornflowerblue", horiz=TRUE, border=NA)
text(45,6, paste(length(answering_countries), "countries
                Total of answers :", sum(answering_countries),
                 "
                              Mean answers by country: " , round(mean(answering_countries)),"
               
                      Top 4: Romania, France, 
                      Slovenia, Czech Republic"), cex=1.2)
abline(v=mean(answering_countries), lty=2)
text(19, 0.7,"Mean", font=2)
```

## Gender
```{r, echo=TRUE, fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
gender <-table(Albania_data$q_0001)
#prop.table(gender)
pie(gender, main="Gender of participants in Europe reponses")
```

##Age
```{r, echo=TRUE,  fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
#error max = 1969 !!!
age_Europe <- Albania_data$q_0002[which(Albania_data$q_0002<1969)]
hist(age_Europe, col="cornflowerblue",
     xlab="Age", ylab="Number", main="Age distribution", freq=TRUE, border=NA, breaks=25 )
text(47, 40, paste("Mean age:", round(mean(age_Europe),0), "years"))
abline(v=mean(age_Europe), lty=2)
```

## Year in Training
```{r, echo=TRUE}
YoT <- table(Albania_data$q_0003)
names(YoT)<- c(1:8, "> 8", "TF")
par(mfrow=c(1,1), mar=c(3,3,2,2))
barplot(YoT, main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number", cex.names=1)
```
>TF for training finished

## Are you receiving personal psychotherapy or have you received it in the past?
```{r, echo=TRUE}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
Albania_data[, 7] <- as.numeric(Albania_data[, 7])
attributes(Albania_data)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
Albania_data[, 7] <- factor(Albania_data[, 7], levels=c(1,2),labels=c("Yes","No"))
names(Albania_data)[7] <- "q_0004"
#table(Albania_data$q_0004)
par(mar=c(3,3,2,2))
prop.table(table(Albania_data$q_0004))
pie(table(Albania_data$q_0004), main = "Receiving personal psychotherapy (present or past)")
```

```{r, echo=TRUE}
## I am undertaking training in Psychotherapy within my training programme in Psychiatry
## NO DATA ????
#tab <- table(Albania_data$q_0005_S05A1)
#length(tab)
#pie(table(Albania_data$q_0005_S05A1), main="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r, echo=TRUE}
table(Albania_data$q_0005_S05A2)
prop.table(table(Albania_data$q_0005_S05A2))
pie(table(Albania_data$q_0005_S05A2), main="Training in psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r, echo=TRUE}
#table(Albania_data$q_0005_S05A3)
pie(table(Albania_data$q_0005_S05A3),  main="I am not undertaking any training in Psychotherapy")
```

> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r, echo=TRUE}
#table(Albania_data$q_0005_S05A4)
prop.table(table(Albania_data$q_0005_S05A4))
pie(table(Albania_data$q_0005_S05A4), main="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality
```{r, echo=TRUE}
table(is.na(Albania_data$q_0006))
prop.table(table(is.na(Albania_data$q_0006)))
pie(table(is.na(Albania_data$q_0006)),main="I am training in some modality of psychotherapy")
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r, echo=TRUE}
table(Albania_data$q_0007)
prop.table(table(Albania_data$q_0007))
pie(table(Albania_data$q_0007), main="Psychotherapy important for the professional identity", col=terrain.colors(3))
```

## Do you want to practise Psychotherapy ?
```{r, echo=TRUE}
#table(Albania_data$q_0008)
prop.table(table(Albania_data$q_0008))
pie(table(Albania_data$q_0008), main="Plan to practise Psychotherapy after training")
```

## Are you interested in this psychotherapy?
```{r, echo=TRUE}
q9df <- Albania_data[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","Not Any","Other"),main="Interested in this therapy", las=1, col=rainbow(6),)
```

##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"
```{r, echo=TRUE, eval=FALSE}

barplot(table(Albania_data$q_0011_SQ001), col="green", main="Theoretical lectures or seminars in psychotherapy", border=NA)
abline(v=1.3, lwd=3)
text(0.6,215, "UEMS <", adj = c(0, -.1), font=2)
```
> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r, echo=TRUE, eval=FALSE}
#barplot(PWS, col="blue", main="Conducting Psychotherapy without supervision", border=NA)
```

```{r, echo=TRUE, eval=FALSE}

barplot(table(Albania_data$q_0011_SQ003), col="yellow", main="Conducting Psychotherapy under supervision")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Albania_data$q_0011_SQ004), col="orange", main="Personal Psychotherapy")
```

```{r, echo=TRUE}
TL <- table(Albania_data$q_0011_SQ001)
PNS <- table(Albania_data$q_0011_SQ002)
PWS <- table(Albania_data$q_0011_SQ003)
PP <- table(Albania_data$q_0011_SQ004)

mandatory <- cbind(prop.table(TL),prop.table(PNS), prop.table(PWS), prop.table(PP))
par(mar=c(3,3,5,9), xpd=TRUE)
barplot(mandatory, col=terrain.colors(3), names=c("Theorical lectures", "Psychotherapy 
without supervision", "Psychotherapy 
with supervision", "Personnal 
psychotherapy"), cex.name=1, main="The following experience in psychotherapy 
is a mandatory part of my training in Psychiatry", cex.main=1.5)
legend("topright", inset=c(-0.27,0), legend = c("Yes", "No", "Uncertain"), fill=(terrain.colors(3)), cex=0.9, bty="n")
```

```{r, echo=TRUE}
qualified <- prop.table(table(Albania_data$q_0012))
par(mar=c(4,5,5,3))
barplot(qualified, col=terrain.colors(3) , main="Are you qualified 
        to practice psychotherapy after your training ?", las=1, ylab="Frequency", cex.names=1.4, cex.lab=1.4, cex.main=1.4)
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
```{r, echo=TRUE}
#table(Albania_data$q_0013)
```

## How many hours of supervision
```{r, echo=TRUE}
par(mar=c(5,5,3,3), xpd=FALSE)
hist(Albania_data$q_0014_SQ001[which(is.na(Albania_data$q_0014_SQ001)==FALSE)], col="cornflowerblue", xlim=c(0,10), main ="Repartition of the hours of supervision in Europe", ylab="Frequency", xlab= "Hours by month", lwd=3, las=1, cex.lab=1.3, cex.main=1.3, breaks=10, freq=FALSE)
text(3.5, 0.30, paste(" Mean :",round(mean(Albania_data$q_0014_SQ001[which(is.na(Albania_data$q_0014_SQ001)==FALSE)]),2), "h"), font=2, cex=1.5, col="cornflowerblue")
text(3.3, 0.20, paste(" Median :", (median(Albania_data$q_0014_SQ001[which(is.na(Albania_data$q_0014_SQ001)==FALSE)])), "h"), font=2, cex=1.5, col="cornflowerblue")
abline(v=mean(Albania_data$q_0014_SQ001[which(is.na(Albania_data$q_0014_SQ001)==FALSE)]), col="cornflowerblue", lwd=3)
abline(v=1.7, lty=3, lwd=3)
text(3.5,0.40, "UEMS > 1.7h", font=2, cex=1.5)
#lines(density(Albania_data$q_0014_SQ002[which(is.na(Albania_data$q_0014_SQ002)==FALSE)]), col=rainbow(5)[2])
#lines(density(Albania_data$q_0014_SQ003[which(is.na(Albania_data$q_0014_SQ003)==FALSE)]), col=rainbow(5)[3])
#lines(density(Albania_data$q_0014_SQ004[which(is.na(Albania_data$q_0014_SQ004)==FALSE)]), col=rainbow(5)[4])
#lines(density(Albania_data$q_0014_SQ005[which(is.na(Albania_data$q_0014_SQ005)==FALSE)]), col=rainbow(5)[5])
#legend("topright", legend=c("Hours of Psychotherapy supervision per month", "Small group supervision (3 - 5 people)", "Large group supervision (more than 5 people)", "Generic Balint group", "Other form of supervision"), fill = rainbow(4), cex=0.7)
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r, echo=TRUE, eval=FALSE}
hist(Albania_data$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(2.5,300, "> UEMS", font=2)
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Albania_data$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Albania_data$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Albania_data$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r, echo=TRUE, eval=FALSE}
hist(Albania_data$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

table(Albania_data$q_0015)

##Who pays?
```{r, echo=TRUE, eval=FALSE}
barplot(table(Albania_data$q_0016_SQ002), col="light blue",
        xlab="Who pays for this component of Psychotherapy experience?",
        names=c("I pay", "State pays", "I don't have", "Free"),
        main="Supervision - individual")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Albania_data$q_0016_SQ003), col="light blue",
        main="Supervision - group",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Albania_data$q_0016_SQ004), col="light blue",
        main="Balint groups",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Albania_data$q_0016_SQ005), col="light blue",
        main="Sessions with patient(s)",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Albania_data$q_0016_SQ006), col="light blue",
        main="Self-experience",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays")
```

```{r, echo=TRUE}
par(mar=c(6,2.5,3,9), xpd=TRUE)
payTL <- table(Albania_data$q_0016_SQ001)
paySI <- table(Albania_data$q_0016_SQ002)
paySG <- table(Albania_data$q_0016_SQ003)
payBG <- table(Albania_data$q_0016_SQ004)
paySP <- table(Albania_data$q_0016_SQ005)
paySE <- table(Albania_data$q_0016_SQ006)
pay <- cbind(prop.table(payTL), prop.table(paySI), prop.table(paySG), prop.table(payBG), prop.table(paySP), prop.table(paySE))
barplot(pay, col=terrain.colors(4),
        main="Who pays?",
        names=c("Theorectical 
lectures", "Supervision 
indiv.", "Supervision 
group", "Balint
groups ", "Sessions
with patient(s)", "Self
experience"), cex.name=0.8, las=2)
legend("topright", inset=c(-0.38,0), legend = c("I pay", "The state pays", "I don't have", "Free"), fill=(terrain.colors(4)), cex=0.9, bty="n")
```

## Would you train for free?
```{r, echo=TRUE}
prop.table(table(Albania_data$q_0017))
par(mar=c(3,2,2,2))
pie(table(Albania_data$q_0017),
    main="Motivated to train in Psychotherapy for free?")
text(-0.2,-0.95, "UEMS recommendations states that psychotherapy training 
of trainees should be funded publicly and free for trainees.")
```

## How much would you invest in psychotherapy training ?
```{r, echo=TRUE}
par(mar=c(6,2.5,3,2), xpd=FALSE)
hist(Albania_data$q_0018[which(Albania_data$q_0018<100)], col="light green",
     main="% of annual salary for psychotherapy training",
     xlab="Percentage of your annual salary do you intend to spend on funding your psychotherapy training In the next 12 months?", cex.lab=1.1, cex.main=1.7)
abline(v=mean(Albania_data$q_0018[which(Albania_data$q_0018<100)]), lwd=2, lty=2)
text(20, 200, paste("Mean :",round( mean(Albania_data$q_0018[which(Albania_data$q_0018<100)])), " %"), font=2, cex=1.3)
text(20, 150, paste("Median :" , median(Albania_data$q_0018[which(Albania_data$q_0018<100)]), " %"), font=2, cex=1.3)
```

## Satisfaction group
```{r, echo=TRUE}
# make auxiliary table to hold our likert Albania_data
sat1<-Albania_data[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(Albania_data$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- Albania_data[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## UEMS recommendations awareness
```{r, echo=TRUE}
# and same with the
uems2 <- Albania_data[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

# Belgium results
```{r,include = FALSE}
dim(Belgium_data)
str(Belgium_data)
summary(Belgium_data)
```

## Number of participants
```{r, echo = FALSE}
# table(Belgium_data[which(complete.cases(Belgium_data$q_0000)==TRUE),]$q_0000)
countryanswers <- sort(table(Belgium_data$q_0000), decreasing = FALSE)
answering_countries <- countryanswers[which (countryanswers > 0)]
#delete France false data
answering_countries <- answering_countries[-3]

par(mar=c(2.5,9.5,2,2))
barplot(answering_countries, cex.names=0.9, las=1, main="Number of answers by country", col="cornflowerblue", horiz=TRUE, border=NA)
text(45,6, paste(length(answering_countries), "countries
                Total of answers :", sum(answering_countries),
                 "
                              Mean answers by country: " , round(mean(answering_countries)),"
               
                      Top 4: Romania, France, 
                      Slovenia, Czech Republic"), cex=1.2)
abline(v=mean(answering_countries), lty=2)
text(19, 0.7,"Mean", font=2)
```

## Gender
```{r, echo=TRUE, fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
gender <-table(Belgium_data$q_0001)
#prop.table(gender)
pie(gender, main="Gender of participants in Europe reponses")
```

##Age
```{r, echo=TRUE,  fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
#error max = 1969 !!!
age_Europe <- Belgium_data$q_0002[which(Belgium_data$q_0002<1969)]
hist(age_Europe, col="cornflowerblue",
     xlab="Age", ylab="Number", main="Age distribution", freq=TRUE, border=NA, breaks=25 )
text(47, 40, paste("Mean age:", round(mean(age_Europe),0), "years"))
abline(v=mean(age_Europe), lty=2)
```

## Year in Training
```{r, echo=TRUE}
YoT <- table(Belgium_data$q_0003)
names(YoT)<- c(1:8, "> 8", "TF")
par(mfrow=c(1,1), mar=c(3,3,2,2))
barplot(YoT, main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number", cex.names=1)
```
>TF for training finished

## Are you receiving personal psychotherapy or have you received it in the past?
```{r, echo=TRUE}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
Belgium_data[, 7] <- as.numeric(Belgium_data[, 7])
attributes(Belgium_data)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
Belgium_data[, 7] <- factor(Belgium_data[, 7], levels=c(1,2),labels=c("Yes","No"))
names(Belgium_data)[7] <- "q_0004"
#table(Belgium_data$q_0004)
par(mar=c(3,3,2,2))
prop.table(table(Belgium_data$q_0004))
pie(table(Belgium_data$q_0004), main = "Receiving personal psychotherapy (present or past)")
```

```{r, echo=TRUE}
## I am undertaking training in Psychotherapy within my training programme in Psychiatry
## NO DATA ????
#tab <- table(Belgium_data$q_0005_S05A1)
#length(tab)
#pie(table(Belgium_data$q_0005_S05A1), main="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r, echo=TRUE}
table(Belgium_data$q_0005_S05A2)
prop.table(table(Belgium_data$q_0005_S05A2))
pie(table(Belgium_data$q_0005_S05A2), main="Training in psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r, echo=TRUE}
#table(Belgium_data$q_0005_S05A3)
pie(table(Belgium_data$q_0005_S05A3),  main="I am not undertaking any training in Psychotherapy")
```

> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r, echo=TRUE}
#table(Belgium_data$q_0005_S05A4)
prop.table(table(Belgium_data$q_0005_S05A4))
pie(table(Belgium_data$q_0005_S05A4), main="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality
```{r, echo=TRUE}
table(is.na(Belgium_data$q_0006))
prop.table(table(is.na(Belgium_data$q_0006)))
pie(table(is.na(Belgium_data$q_0006)),main="I am training in some modality of psychotherapy")
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r, echo=TRUE}
table(Belgium_data$q_0007)
prop.table(table(Belgium_data$q_0007))
pie(table(Belgium_data$q_0007), main="Psychotherapy important for the professional identity", col=terrain.colors(3))
```

## Do you want to practise Psychotherapy ?
```{r, echo=TRUE}
#table(Belgium_data$q_0008)
prop.table(table(Belgium_data$q_0008))
pie(table(Belgium_data$q_0008), main="Plan to practise Psychotherapy after training")
```

## Are you interested in this psychotherapy?
```{r, echo=TRUE}
q9df <- Belgium_data[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","Not Any","Other"),main="Interested in this therapy", las=1, col=rainbow(6),)
```

##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"
```{r, echo=TRUE, eval=FALSE}

barplot(table(Belgium_data$q_0011_SQ001), col="green", main="Theoretical lectures or seminars in psychotherapy", border=NA)
abline(v=1.3, lwd=3)
text(0.6,215, "UEMS <", adj = c(0, -.1), font=2)
```
> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r, echo=TRUE, eval=FALSE}
#barplot(PWS, col="blue", main="Conducting Psychotherapy without supervision", border=NA)
```

```{r, echo=TRUE, eval=FALSE}

barplot(table(Belgium_data$q_0011_SQ003), col="yellow", main="Conducting Psychotherapy under supervision")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Belgium_data$q_0011_SQ004), col="orange", main="Personal Psychotherapy")
```

```{r, echo=TRUE}
TL <- table(Belgium_data$q_0011_SQ001)
PNS <- table(Belgium_data$q_0011_SQ002)
PWS <- table(Belgium_data$q_0011_SQ003)
PP <- table(Belgium_data$q_0011_SQ004)

mandatory <- cbind(prop.table(TL),prop.table(PNS), prop.table(PWS), prop.table(PP))
par(mar=c(3,3,5,9), xpd=TRUE)
barplot(mandatory, col=terrain.colors(3), names=c("Theorical lectures", "Psychotherapy 
without supervision", "Psychotherapy 
with supervision", "Personnal 
psychotherapy"), cex.name=1, main="The following experience in psychotherapy 
is a mandatory part of my training in Psychiatry", cex.main=1.5)
legend("topright", inset=c(-0.27,0), legend = c("Yes", "No", "Uncertain"), fill=(terrain.colors(3)), cex=0.9, bty="n")
```

```{r, echo=TRUE}
qualified <- prop.table(table(Belgium_data$q_0012))
par(mar=c(4,5,5,3))
barplot(qualified, col=terrain.colors(3) , main="Are you qualified 
        to practice psychotherapy after your training ?", las=1, ylab="Frequency", cex.names=1.4, cex.lab=1.4, cex.main=1.4)
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
```{r, echo=TRUE}
#table(Belgium_data$q_0013)
```

## How many hours of supervision
```{r, echo=TRUE}
par(mar=c(5,5,3,3), xpd=FALSE)
hist(Belgium_data$q_0014_SQ001[which(is.na(Belgium_data$q_0014_SQ001)==FALSE)], col="cornflowerblue", xlim=c(0,10), main ="Repartition of the hours of supervision in Europe", ylab="Frequency", xlab= "Hours by month", lwd=3, las=1, cex.lab=1.3, cex.main=1.3, breaks=10, freq=FALSE)
text(3.5, 0.30, paste(" Mean :",round(mean(Belgium_data$q_0014_SQ001[which(is.na(Belgium_data$q_0014_SQ001)==FALSE)]),2), "h"), font=2, cex=1.5, col="cornflowerblue")
text(3.3, 0.20, paste(" Median :", (median(Belgium_data$q_0014_SQ001[which(is.na(Belgium_data$q_0014_SQ001)==FALSE)])), "h"), font=2, cex=1.5, col="cornflowerblue")
abline(v=mean(Belgium_data$q_0014_SQ001[which(is.na(Belgium_data$q_0014_SQ001)==FALSE)]), col="cornflowerblue", lwd=3)
abline(v=1.7, lty=3, lwd=3)
text(3.5,0.40, "UEMS > 1.7h", font=2, cex=1.5)
#lines(density(Belgium_data$q_0014_SQ002[which(is.na(Belgium_data$q_0014_SQ002)==FALSE)]), col=rainbow(5)[2])
#lines(density(Belgium_data$q_0014_SQ003[which(is.na(Belgium_data$q_0014_SQ003)==FALSE)]), col=rainbow(5)[3])
#lines(density(Belgium_data$q_0014_SQ004[which(is.na(Belgium_data$q_0014_SQ004)==FALSE)]), col=rainbow(5)[4])
#lines(density(Belgium_data$q_0014_SQ005[which(is.na(Belgium_data$q_0014_SQ005)==FALSE)]), col=rainbow(5)[5])
#legend("topright", legend=c("Hours of Psychotherapy supervision per month", "Small group supervision (3 - 5 people)", "Large group supervision (more than 5 people)", "Generic Balint group", "Other form of supervision"), fill = rainbow(4), cex=0.7)
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r, echo=TRUE, eval=FALSE}
hist(Belgium_data$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(2.5,300, "> UEMS", font=2)
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Belgium_data$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Belgium_data$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Belgium_data$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r, echo=TRUE, eval=FALSE}
hist(Belgium_data$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

table(Belgium_data$q_0015)

##Who pays?
```{r, echo=TRUE, eval=FALSE}
barplot(table(Belgium_data$q_0016_SQ002), col="light blue",
        xlab="Who pays for this component of Psychotherapy experience?",
        names=c("I pay", "State pays", "I don't have", "Free"),
        main="Supervision - individual")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Belgium_data$q_0016_SQ003), col="light blue",
        main="Supervision - group",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Belgium_data$q_0016_SQ004), col="light blue",
        main="Balint groups",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Belgium_data$q_0016_SQ005), col="light blue",
        main="Sessions with patient(s)",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Belgium_data$q_0016_SQ006), col="light blue",
        main="Self-experience",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays")
```

```{r, echo=TRUE}
par(mar=c(6,2.5,3,9), xpd=TRUE)
payTL <- table(Belgium_data$q_0016_SQ001)
paySI <- table(Belgium_data$q_0016_SQ002)
paySG <- table(Belgium_data$q_0016_SQ003)
payBG <- table(Belgium_data$q_0016_SQ004)
paySP <- table(Belgium_data$q_0016_SQ005)
paySE <- table(Belgium_data$q_0016_SQ006)
pay <- cbind(prop.table(payTL), prop.table(paySI), prop.table(paySG), prop.table(payBG), prop.table(paySP), prop.table(paySE))
barplot(pay, col=terrain.colors(4),
        main="Who pays?",
        names=c("Theorectical 
lectures", "Supervision 
indiv.", "Supervision 
group", "Balint
groups ", "Sessions
with patient(s)", "Self
experience"), cex.name=0.8, las=2)
legend("topright", inset=c(-0.38,0), legend = c("I pay", "The state pays", "I don't have", "Free"), fill=(terrain.colors(4)), cex=0.9, bty="n")
```

## Would you train for free?
```{r, echo=TRUE}
prop.table(table(Belgium_data$q_0017))
par(mar=c(3,2,2,2))
pie(table(Belgium_data$q_0017),
    main="Motivated to train in Psychotherapy for free?")
text(-0.2,-0.95, "UEMS recommendations states that psychotherapy training 
of trainees should be funded publicly and free for trainees.")
```

## How much would you invest in psychotherapy training ?
```{r, echo=TRUE}
par(mar=c(6,2.5,3,2), xpd=FALSE)
hist(Belgium_data$q_0018[which(Belgium_data$q_0018<100)], col="light green",
     main="% of annual salary for psychotherapy training",
     xlab="Percentage of your annual salary do you intend to spend on funding your psychotherapy training In the next 12 months?", cex.lab=1.1, cex.main=1.7)
abline(v=mean(Belgium_data$q_0018[which(Belgium_data$q_0018<100)]), lwd=2, lty=2)
text(20, 200, paste("Mean :",round( mean(Belgium_data$q_0018[which(Belgium_data$q_0018<100)])), " %"), font=2, cex=1.3)
text(20, 150, paste("Median :" , median(Belgium_data$q_0018[which(Belgium_data$q_0018<100)]), " %"), font=2, cex=1.3)
```

## Satisfaction group
```{r, echo=TRUE}
# make auxiliary table to hold our likert Belgium_data
sat1<-Belgium_data[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(Belgium_data$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- Belgium_data[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## UEMS recommendations awareness
```{r, echo=TRUE}
# and same with the
uems2 <- Belgium_data[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

# Bosnia-Herzegovina results
```{r,include = FALSE}
dim(Bosnia_Herzegovina_data)
str(Bosnia_Herzegovina_data)
summary(Bosnia_Herzegovina_data)
```

## Number of participants
```{r, echo = FALSE}
# table(Bosnia_Herzegovina_data[which(complete.cases(Bosnia_Herzegovina_data$q_0000)==TRUE),]$q_0000)
countryanswers <- sort(table(Bosnia_Herzegovina_data$q_0000), decreasing = FALSE)
answering_countries <- countryanswers[which (countryanswers > 0)]
#delete France false data
answering_countries <- answering_countries[-3]

par(mar=c(2.5,9.5,2,2))
barplot(answering_countries, cex.names=0.9, las=1, main="Number of answers by country", col="cornflowerblue", horiz=TRUE, border=NA)
text(45,6, paste(length(answering_countries), "countries
                Total of answers :", sum(answering_countries),
                 "
                              Mean answers by country: " , round(mean(answering_countries)),"
               
                      Top 4: Romania, France, 
                      Slovenia, Czech Republic"), cex=1.2)
abline(v=mean(answering_countries), lty=2)
text(19, 0.7,"Mean", font=2)
```

## Gender
```{r, echo=TRUE, fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
gender <-table(Bosnia_Herzegovina_data$q_0001)
#prop.table(gender)
pie(gender, main="Gender of participants in Europe reponses")
```

##Age
```{r, echo=TRUE,  fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
#error max = 1969 !!!
age_Europe <- Bosnia_Herzegovina_data$q_0002[which(Bosnia_Herzegovina_data$q_0002<1969)]
hist(age_Europe, col="cornflowerblue",
     xlab="Age", ylab="Number", main="Age distribution", freq=TRUE, border=NA, breaks=25 )
text(47, 40, paste("Mean age:", round(mean(age_Europe),0), "years"))
abline(v=mean(age_Europe), lty=2)
```

## Year in Training
```{r, echo=TRUE}
YoT <- table(Bosnia_Herzegovina_data$q_0003)
names(YoT)<- c(1:8, "> 8", "TF")
par(mfrow=c(1,1), mar=c(3,3,2,2))
barplot(YoT, main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number", cex.names=1)
```
>TF for training finished

## Are you receiving personal psychotherapy or have you received it in the past?
```{r, echo=TRUE}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
Bosnia_Herzegovina_data[, 7] <- as.numeric(Bosnia_Herzegovina_data[, 7])
attributes(Bosnia_Herzegovina_data)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
Bosnia_Herzegovina_data[, 7] <- factor(Bosnia_Herzegovina_data[, 7], levels=c(1,2),labels=c("Yes","No"))
names(Bosnia_Herzegovina_data)[7] <- "q_0004"
#table(Bosnia_Herzegovina_data$q_0004)
par(mar=c(3,3,2,2))
prop.table(table(Bosnia_Herzegovina_data$q_0004))
pie(table(Bosnia_Herzegovina_data$q_0004), main = "Receiving personal psychotherapy (present or past)")
```

```{r, echo=TRUE}
## I am undertaking training in Psychotherapy within my training programme in Psychiatry
## NO DATA ????
#tab <- table(Bosnia_Herzegovina_data$q_0005_S05A1)
#length(tab)
#pie(table(Bosnia_Herzegovina_data$q_0005_S05A1), main="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r, echo=TRUE}
table(Bosnia_Herzegovina_data$q_0005_S05A2)
prop.table(table(Bosnia_Herzegovina_data$q_0005_S05A2))
pie(table(Bosnia_Herzegovina_data$q_0005_S05A2), main="Training in psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r, echo=TRUE}
#table(Bosnia_Herzegovina_data$q_0005_S05A3)
pie(table(Bosnia_Herzegovina_data$q_0005_S05A3),  main="I am not undertaking any training in Psychotherapy")
```

> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r, echo=TRUE}
#table(Bosnia_Herzegovina_data$q_0005_S05A4)
prop.table(table(Bosnia_Herzegovina_data$q_0005_S05A4))
pie(table(Bosnia_Herzegovina_data$q_0005_S05A4), main="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality
```{r, echo=TRUE}
table(is.na(Bosnia_Herzegovina_data$q_0006))
prop.table(table(is.na(Bosnia_Herzegovina_data$q_0006)))
pie(table(is.na(Bosnia_Herzegovina_data$q_0006)),main="I am training in some modality of psychotherapy")
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r, echo=TRUE}
table(Bosnia_Herzegovina_data$q_0007)
prop.table(table(Bosnia_Herzegovina_data$q_0007))
pie(table(Bosnia_Herzegovina_data$q_0007), main="Psychotherapy important for the professional identity", col=terrain.colors(3))
```

## Do you want to practise Psychotherapy ?
```{r, echo=TRUE}
#table(Bosnia_Herzegovina_data$q_0008)
prop.table(table(Bosnia_Herzegovina_data$q_0008))
pie(table(Bosnia_Herzegovina_data$q_0008), main="Plan to practise Psychotherapy after training")
```

## Are you interested in this psychotherapy?
```{r, echo=TRUE}
q9df <- Bosnia_Herzegovina_data[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","Not Any","Other"),main="Interested in this therapy", las=1, col=rainbow(6),)
```

##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"
```{r, echo=TRUE, eval=FALSE}

barplot(table(Bosnia_Herzegovina_data$q_0011_SQ001), col="green", main="Theoretical lectures or seminars in psychotherapy", border=NA)
abline(v=1.3, lwd=3)
text(0.6,215, "UEMS <", adj = c(0, -.1), font=2)
```
> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r, echo=TRUE, eval=FALSE}
#barplot(PWS, col="blue", main="Conducting Psychotherapy without supervision", border=NA)
```

```{r, echo=TRUE, eval=FALSE}

barplot(table(Bosnia_Herzegovina_data$q_0011_SQ003), col="yellow", main="Conducting Psychotherapy under supervision")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Bosnia_Herzegovina_data$q_0011_SQ004), col="orange", main="Personal Psychotherapy")
```

```{r, echo=TRUE}
TL <- table(Bosnia_Herzegovina_data$q_0011_SQ001)
PNS <- table(Bosnia_Herzegovina_data$q_0011_SQ002)
PWS <- table(Bosnia_Herzegovina_data$q_0011_SQ003)
PP <- table(Bosnia_Herzegovina_data$q_0011_SQ004)

mandatory <- cbind(prop.table(TL),prop.table(PNS), prop.table(PWS), prop.table(PP))
par(mar=c(3,3,5,9), xpd=TRUE)
barplot(mandatory, col=terrain.colors(3), names=c("Theorical lectures", "Psychotherapy 
without supervision", "Psychotherapy 
with supervision", "Personnal 
psychotherapy"), cex.name=1, main="The following experience in psychotherapy 
is a mandatory part of my training in Psychiatry", cex.main=1.5)
legend("topright", inset=c(-0.27,0), legend = c("Yes", "No", "Uncertain"), fill=(terrain.colors(3)), cex=0.9, bty="n")
```

```{r, echo=TRUE}
qualified <- prop.table(table(Bosnia_Herzegovina_data$q_0012))
par(mar=c(4,5,5,3))
barplot(qualified, col=terrain.colors(3) , main="Are you qualified 
        to practice psychotherapy after your training ?", las=1, ylab="Frequency", cex.names=1.4, cex.lab=1.4, cex.main=1.4)
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
```{r, echo=TRUE}
#table(Bosnia_Herzegovina_data$q_0013)
```

## How many hours of supervision
```{r, echo=TRUE}
par(mar=c(5,5,3,3), xpd=FALSE)
hist(Bosnia_Herzegovina_data$q_0014_SQ001[which(is.na(Bosnia_Herzegovina_data$q_0014_SQ001)==FALSE)], col="cornflowerblue", xlim=c(0,10), main ="Repartition of the hours of supervision in Europe", ylab="Frequency", xlab= "Hours by month", lwd=3, las=1, cex.lab=1.3, cex.main=1.3, breaks=10, freq=FALSE)
text(3.5, 0.30, paste(" Mean :",round(mean(Bosnia_Herzegovina_data$q_0014_SQ001[which(is.na(Bosnia_Herzegovina_data$q_0014_SQ001)==FALSE)]),2), "h"), font=2, cex=1.5, col="cornflowerblue")
text(3.3, 0.20, paste(" Median :", (median(Bosnia_Herzegovina_data$q_0014_SQ001[which(is.na(Bosnia_Herzegovina_data$q_0014_SQ001)==FALSE)])), "h"), font=2, cex=1.5, col="cornflowerblue")
abline(v=mean(Bosnia_Herzegovina_data$q_0014_SQ001[which(is.na(Bosnia_Herzegovina_data$q_0014_SQ001)==FALSE)]), col="cornflowerblue", lwd=3)
abline(v=1.7, lty=3, lwd=3)
text(3.5,0.40, "UEMS > 1.7h", font=2, cex=1.5)
#lines(density(Bosnia_Herzegovina_data$q_0014_SQ002[which(is.na(Bosnia_Herzegovina_data$q_0014_SQ002)==FALSE)]), col=rainbow(5)[2])
#lines(density(Bosnia_Herzegovina_data$q_0014_SQ003[which(is.na(Bosnia_Herzegovina_data$q_0014_SQ003)==FALSE)]), col=rainbow(5)[3])
#lines(density(Bosnia_Herzegovina_data$q_0014_SQ004[which(is.na(Bosnia_Herzegovina_data$q_0014_SQ004)==FALSE)]), col=rainbow(5)[4])
#lines(density(Bosnia_Herzegovina_data$q_0014_SQ005[which(is.na(Bosnia_Herzegovina_data$q_0014_SQ005)==FALSE)]), col=rainbow(5)[5])
#legend("topright", legend=c("Hours of Psychotherapy supervision per month", "Small group supervision (3 - 5 people)", "Large group supervision (more than 5 people)", "Generic Balint group", "Other form of supervision"), fill = rainbow(4), cex=0.7)
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r, echo=TRUE, eval=FALSE}
hist(Bosnia_Herzegovina_data$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(2.5,300, "> UEMS", font=2)
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Bosnia_Herzegovina_data$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Bosnia_Herzegovina_data$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Bosnia_Herzegovina_data$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r, echo=TRUE, eval=FALSE}
hist(Bosnia_Herzegovina_data$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

table(Bosnia_Herzegovina_data$q_0015)

##Who pays?
```{r, echo=TRUE, eval=FALSE}
barplot(table(Bosnia_Herzegovina_data$q_0016_SQ002), col="light blue",
        xlab="Who pays for this component of Psychotherapy experience?",
        names=c("I pay", "State pays", "I don't have", "Free"),
        main="Supervision - individual")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Bosnia_Herzegovina_data$q_0016_SQ003), col="light blue",
        main="Supervision - group",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Bosnia_Herzegovina_data$q_0016_SQ004), col="light blue",
        main="Balint groups",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Bosnia_Herzegovina_data$q_0016_SQ005), col="light blue",
        main="Sessions with patient(s)",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Bosnia_Herzegovina_data$q_0016_SQ006), col="light blue",
        main="Self-experience",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays")
```

```{r, echo=TRUE}
par(mar=c(6,2.5,3,9), xpd=TRUE)
payTL <- table(Bosnia_Herzegovina_data$q_0016_SQ001)
paySI <- table(Bosnia_Herzegovina_data$q_0016_SQ002)
paySG <- table(Bosnia_Herzegovina_data$q_0016_SQ003)
payBG <- table(Bosnia_Herzegovina_data$q_0016_SQ004)
paySP <- table(Bosnia_Herzegovina_data$q_0016_SQ005)
paySE <- table(Bosnia_Herzegovina_data$q_0016_SQ006)
pay <- cbind(prop.table(payTL), prop.table(paySI), prop.table(paySG), prop.table(payBG), prop.table(paySP), prop.table(paySE))
barplot(pay, col=terrain.colors(4),
        main="Who pays?",
        names=c("Theorectical 
lectures", "Supervision 
indiv.", "Supervision 
group", "Balint
groups ", "Sessions
with patient(s)", "Self
experience"), cex.name=0.8, las=2)
legend("topright", inset=c(-0.38,0), legend = c("I pay", "The state pays", "I don't have", "Free"), fill=(terrain.colors(4)), cex=0.9, bty="n")
```

## Would you train for free?
```{r, echo=TRUE}
prop.table(table(Bosnia_Herzegovina_data$q_0017))
par(mar=c(3,2,2,2))
pie(table(Bosnia_Herzegovina_data$q_0017),
    main="Motivated to train in Psychotherapy for free?")
text(-0.2,-0.95, "UEMS recommendations states that psychotherapy training 
of trainees should be funded publicly and free for trainees.")
```

## How much would you invest in psychotherapy training ?
```{r, echo=TRUE}
par(mar=c(6,2.5,3,2), xpd=FALSE)
hist(Bosnia_Herzegovina_data$q_0018[which(Bosnia_Herzegovina_data$q_0018<100)], col="light green",
     main="% of annual salary for psychotherapy training",
     xlab="Percentage of your annual salary do you intend to spend on funding your psychotherapy training In the next 12 months?", cex.lab=1.1, cex.main=1.7)
abline(v=mean(Bosnia_Herzegovina_data$q_0018[which(Bosnia_Herzegovina_data$q_0018<100)]), lwd=2, lty=2)
text(20, 200, paste("Mean :",round( mean(Bosnia_Herzegovina_data$q_0018[which(Bosnia_Herzegovina_data$q_0018<100)])), " %"), font=2, cex=1.3)
text(20, 150, paste("Median :" , median(Bosnia_Herzegovina_data$q_0018[which(Bosnia_Herzegovina_data$q_0018<100)]), " %"), font=2, cex=1.3)
```

## Satisfaction group
```{r, echo=TRUE}
# make auxiliary table to hold our likert Bosnia_Herzegovina_data
sat1<-Bosnia_Herzegovina_data[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(Bosnia_Herzegovina_data$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- Bosnia_Herzegovina_data[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## UEMS recommendations awareness
```{r, echo=TRUE}
# and same with the
uems2 <- Bosnia_Herzegovina_data[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

# Bulgaria results
```{r,include = FALSE}
dim(Bulgaria_data)
str(Bulgaria_data)
summary(Bulgaria_data)
```

## Number of participants
```{r, echo = FALSE}
# table(Bulgaria_data[which(complete.cases(Bulgaria_data$q_0000)==TRUE),]$q_0000)
countryanswers <- sort(table(Bulgaria_data$q_0000), decreasing = FALSE)
answering_countries <- countryanswers[which (countryanswers > 0)]
#delete France false data
answering_countries <- answering_countries[-3]

par(mar=c(2.5,9.5,2,2))
barplot(answering_countries, cex.names=0.9, las=1, main="Number of answers by country", col="cornflowerblue", horiz=TRUE, border=NA)
text(45,6, paste(length(answering_countries), "countries
                Total of answers :", sum(answering_countries),
                 "
                              Mean answers by country: " , round(mean(answering_countries)),"
               
                      Top 4: Romania, France, 
                      Slovenia, Czech Republic"), cex=1.2)
abline(v=mean(answering_countries), lty=2)
text(19, 0.7,"Mean", font=2)
```

## Gender
```{r, echo=TRUE, fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
gender <-table(Bulgaria_data$q_0001)
#prop.table(gender)
pie(gender, main="Gender of participants in Europe reponses")
```

##Age
```{r, echo=TRUE,  fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
#error max = 1969 !!!
age_Europe <- Bulgaria_data$q_0002[which(Bulgaria_data$q_0002<1969)]
hist(age_Europe, col="cornflowerblue",
     xlab="Age", ylab="Number", main="Age distribution", freq=TRUE, border=NA, breaks=25 )
text(47, 40, paste("Mean age:", round(mean(age_Europe),0), "years"))
abline(v=mean(age_Europe), lty=2)
```

## Year in Training
```{r, echo=TRUE}
YoT <- table(Bulgaria_data$q_0003)
names(YoT)<- c(1:8, "> 8", "TF")
par(mfrow=c(1,1), mar=c(3,3,2,2))
barplot(YoT, main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number", cex.names=1)
```
>TF for training finished

## Are you receiving personal psychotherapy or have you received it in the past?
```{r, echo=TRUE}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
Bulgaria_data[, 7] <- as.numeric(Bulgaria_data[, 7])
attributes(Bulgaria_data)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
Bulgaria_data[, 7] <- factor(Bulgaria_data[, 7], levels=c(1,2),labels=c("Yes","No"))
names(Bulgaria_data)[7] <- "q_0004"
#table(Bulgaria_data$q_0004)
par(mar=c(3,3,2,2))
prop.table(table(Bulgaria_data$q_0004))
pie(table(Bulgaria_data$q_0004), main = "Receiving personal psychotherapy (present or past)")
```

```{r, echo=TRUE}
## I am undertaking training in Psychotherapy within my training programme in Psychiatry
## NO DATA ????
#tab <- table(Bulgaria_data$q_0005_S05A1)
#length(tab)
#pie(table(Bulgaria_data$q_0005_S05A1), main="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r, echo=TRUE}
table(Bulgaria_data$q_0005_S05A2)
prop.table(table(Bulgaria_data$q_0005_S05A2))
pie(table(Bulgaria_data$q_0005_S05A2), main="Training in psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r, echo=TRUE}
#table(Bulgaria_data$q_0005_S05A3)
pie(table(Bulgaria_data$q_0005_S05A3),  main="I am not undertaking any training in Psychotherapy")
```

> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r, echo=TRUE}
#table(Bulgaria_data$q_0005_S05A4)
prop.table(table(Bulgaria_data$q_0005_S05A4))
pie(table(Bulgaria_data$q_0005_S05A4), main="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality
```{r, echo=TRUE}
table(is.na(Bulgaria_data$q_0006))
prop.table(table(is.na(Bulgaria_data$q_0006)))
pie(table(is.na(Bulgaria_data$q_0006)),main="I am training in some modality of psychotherapy")
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r, echo=TRUE}
table(Bulgaria_data$q_0007)
prop.table(table(Bulgaria_data$q_0007))
pie(table(Bulgaria_data$q_0007), main="Psychotherapy important for the professional identity", col=terrain.colors(3))
```

## Do you want to practise Psychotherapy ?
```{r, echo=TRUE}
#table(Bulgaria_data$q_0008)
prop.table(table(Bulgaria_data$q_0008))
pie(table(Bulgaria_data$q_0008), main="Plan to practise Psychotherapy after training")
```

## Are you interested in this psychotherapy?
```{r, echo=TRUE}
q9df <- Bulgaria_data[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","Not Any","Other"),main="Interested in this therapy", las=1, col=rainbow(6),)
```

##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"
```{r, echo=TRUE, eval=FALSE}

barplot(table(Bulgaria_data$q_0011_SQ001), col="green", main="Theoretical lectures or seminars in psychotherapy", border=NA)
abline(v=1.3, lwd=3)
text(0.6,215, "UEMS <", adj = c(0, -.1), font=2)
```
> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r, echo=TRUE, eval=FALSE}
#barplot(PWS, col="blue", main="Conducting Psychotherapy without supervision", border=NA)
```

```{r, echo=TRUE, eval=FALSE}

barplot(table(Bulgaria_data$q_0011_SQ003), col="yellow", main="Conducting Psychotherapy under supervision")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Bulgaria_data$q_0011_SQ004), col="orange", main="Personal Psychotherapy")
```

```{r, echo=TRUE}
TL <- table(Bulgaria_data$q_0011_SQ001)
PNS <- table(Bulgaria_data$q_0011_SQ002)
PWS <- table(Bulgaria_data$q_0011_SQ003)
PP <- table(Bulgaria_data$q_0011_SQ004)

mandatory <- cbind(prop.table(TL),prop.table(PNS), prop.table(PWS), prop.table(PP))
par(mar=c(3,3,5,9), xpd=TRUE)
barplot(mandatory, col=terrain.colors(3), names=c("Theorical lectures", "Psychotherapy 
without supervision", "Psychotherapy 
with supervision", "Personnal 
psychotherapy"), cex.name=1, main="The following experience in psychotherapy 
is a mandatory part of my training in Psychiatry", cex.main=1.5)
legend("topright", inset=c(-0.27,0), legend = c("Yes", "No", "Uncertain"), fill=(terrain.colors(3)), cex=0.9, bty="n")
```

```{r, echo=TRUE}
qualified <- prop.table(table(Bulgaria_data$q_0012))
par(mar=c(4,5,5,3))
barplot(qualified, col=terrain.colors(3) , main="Are you qualified 
        to practice psychotherapy after your training ?", las=1, ylab="Frequency", cex.names=1.4, cex.lab=1.4, cex.main=1.4)
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
```{r, echo=TRUE}
#table(Bulgaria_data$q_0013)
```

## How many hours of supervision
```{r, echo=TRUE}
par(mar=c(5,5,3,3), xpd=FALSE)
hist(Bulgaria_data$q_0014_SQ001[which(is.na(Bulgaria_data$q_0014_SQ001)==FALSE)], col="cornflowerblue", xlim=c(0,10), main ="Repartition of the hours of supervision in Europe", ylab="Frequency", xlab= "Hours by month", lwd=3, las=1, cex.lab=1.3, cex.main=1.3, breaks=10, freq=FALSE)
text(3.5, 0.30, paste(" Mean :",round(mean(Bulgaria_data$q_0014_SQ001[which(is.na(Bulgaria_data$q_0014_SQ001)==FALSE)]),2), "h"), font=2, cex=1.5, col="cornflowerblue")
text(3.3, 0.20, paste(" Median :", (median(Bulgaria_data$q_0014_SQ001[which(is.na(Bulgaria_data$q_0014_SQ001)==FALSE)])), "h"), font=2, cex=1.5, col="cornflowerblue")
abline(v=mean(Bulgaria_data$q_0014_SQ001[which(is.na(Bulgaria_data$q_0014_SQ001)==FALSE)]), col="cornflowerblue", lwd=3)
abline(v=1.7, lty=3, lwd=3)
text(3.5,0.40, "UEMS > 1.7h", font=2, cex=1.5)
#lines(density(Bulgaria_data$q_0014_SQ002[which(is.na(Bulgaria_data$q_0014_SQ002)==FALSE)]), col=rainbow(5)[2])
#lines(density(Bulgaria_data$q_0014_SQ003[which(is.na(Bulgaria_data$q_0014_SQ003)==FALSE)]), col=rainbow(5)[3])
#lines(density(Bulgaria_data$q_0014_SQ004[which(is.na(Bulgaria_data$q_0014_SQ004)==FALSE)]), col=rainbow(5)[4])
#lines(density(Bulgaria_data$q_0014_SQ005[which(is.na(Bulgaria_data$q_0014_SQ005)==FALSE)]), col=rainbow(5)[5])
#legend("topright", legend=c("Hours of Psychotherapy supervision per month", "Small group supervision (3 - 5 people)", "Large group supervision (more than 5 people)", "Generic Balint group", "Other form of supervision"), fill = rainbow(4), cex=0.7)
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r, echo=TRUE, eval=FALSE}
hist(Bulgaria_data$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(2.5,300, "> UEMS", font=2)
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Bulgaria_data$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Bulgaria_data$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Bulgaria_data$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r, echo=TRUE, eval=FALSE}
hist(Bulgaria_data$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

table(Bulgaria_data$q_0015)

##Who pays?
```{r, echo=TRUE, eval=FALSE}
barplot(table(Bulgaria_data$q_0016_SQ002), col="light blue",
        xlab="Who pays for this component of Psychotherapy experience?",
        names=c("I pay", "State pays", "I don't have", "Free"),
        main="Supervision - individual")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Bulgaria_data$q_0016_SQ003), col="light blue",
        main="Supervision - group",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Bulgaria_data$q_0016_SQ004), col="light blue",
        main="Balint groups",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Bulgaria_data$q_0016_SQ005), col="light blue",
        main="Sessions with patient(s)",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Bulgaria_data$q_0016_SQ006), col="light blue",
        main="Self-experience",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays")
```

```{r, echo=TRUE}
par(mar=c(6,2.5,3,9), xpd=TRUE)
payTL <- table(Bulgaria_data$q_0016_SQ001)
paySI <- table(Bulgaria_data$q_0016_SQ002)
paySG <- table(Bulgaria_data$q_0016_SQ003)
payBG <- table(Bulgaria_data$q_0016_SQ004)
paySP <- table(Bulgaria_data$q_0016_SQ005)
paySE <- table(Bulgaria_data$q_0016_SQ006)
pay <- cbind(prop.table(payTL), prop.table(paySI), prop.table(paySG), prop.table(payBG), prop.table(paySP), prop.table(paySE))
barplot(pay, col=terrain.colors(4),
        main="Who pays?",
        names=c("Theorectical 
lectures", "Supervision 
indiv.", "Supervision 
group", "Balint
groups ", "Sessions
with patient(s)", "Self
experience"), cex.name=0.8, las=2)
legend("topright", inset=c(-0.38,0), legend = c("I pay", "The state pays", "I don't have", "Free"), fill=(terrain.colors(4)), cex=0.9, bty="n")
```

## Would you train for free?
```{r, echo=TRUE}
prop.table(table(Bulgaria_data$q_0017))
par(mar=c(3,2,2,2))
pie(table(Bulgaria_data$q_0017),
    main="Motivated to train in Psychotherapy for free?")
text(-0.2,-0.95, "UEMS recommendations states that psychotherapy training 
of trainees should be funded publicly and free for trainees.")
```

## How much would you invest in psychotherapy training ?
```{r, echo=TRUE}
par(mar=c(6,2.5,3,2), xpd=FALSE)
hist(Bulgaria_data$q_0018[which(Bulgaria_data$q_0018<100)], col="light green",
     main="% of annual salary for psychotherapy training",
     xlab="Percentage of your annual salary do you intend to spend on funding your psychotherapy training In the next 12 months?", cex.lab=1.1, cex.main=1.7)
abline(v=mean(Bulgaria_data$q_0018[which(Bulgaria_data$q_0018<100)]), lwd=2, lty=2)
text(20, 200, paste("Mean :",round( mean(Bulgaria_data$q_0018[which(Bulgaria_data$q_0018<100)])), " %"), font=2, cex=1.3)
text(20, 150, paste("Median :" , median(Bulgaria_data$q_0018[which(Bulgaria_data$q_0018<100)]), " %"), font=2, cex=1.3)
```

## Satisfaction group
```{r, echo=TRUE}
# make auxiliary table to hold our likert Bulgaria_data
sat1<-Bulgaria_data[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(Bulgaria_data$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- Bulgaria_data[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## UEMS recommendations awareness
```{r, echo=TRUE}
# and same with the
uems2 <- Bulgaria_data[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

# Czech Republic results
```{r,include = FALSE}
dim(Czech_Republic_data)
str(Czech_Republic_data)
summary(Czech_Republic_data)
```

## Number of participants
```{r, echo = FALSE}
# table(Czech_Republic_data[which(complete.cases(Czech_Republic_data$q_0000)==TRUE),]$q_0000)
countryanswers <- sort(table(Czech_Republic_data$q_0000), decreasing = FALSE)
answering_countries <- countryanswers[which (countryanswers > 0)]
#delete France false data
answering_countries <- answering_countries[-3]

par(mar=c(2.5,9.5,2,2))
barplot(answering_countries, cex.names=0.9, las=1, main="Number of answers by country", col="cornflowerblue", horiz=TRUE, border=NA)
text(45,6, paste(length(answering_countries), "countries
                Total of answers :", sum(answering_countries),
                 "
                              Mean answers by country: " , round(mean(answering_countries)),"
               
                      Top 4: Romania, France, 
                      Slovenia, Czech Republic"), cex=1.2)
abline(v=mean(answering_countries), lty=2)
text(19, 0.7,"Mean", font=2)
```

## Gender
```{r, echo=TRUE, fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
gender <-table(Czech_Republic_data$q_0001)
#prop.table(gender)
pie(gender, main="Gender of participants in Europe reponses")
```

##Age
```{r, echo=TRUE,  fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
#error max = 1969 !!!
age_Europe <- Czech_Republic_data$q_0002[which(Czech_Republic_data$q_0002<1969)]
hist(age_Europe, col="cornflowerblue",
     xlab="Age", ylab="Number", main="Age distribution", freq=TRUE, border=NA, breaks=25 )
text(47, 40, paste("Mean age:", round(mean(age_Europe),0), "years"))
abline(v=mean(age_Europe), lty=2)
```

## Year in Training
```{r, echo=TRUE}
YoT <- table(Czech_Republic_data$q_0003)
names(YoT)<- c(1:8, "> 8", "TF")
par(mfrow=c(1,1), mar=c(3,3,2,2))
barplot(YoT, main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number", cex.names=1)
```
>TF for training finished

## Are you receiving personal psychotherapy or have you received it in the past?
```{r, echo=TRUE}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
Czech_Republic_data[, 7] <- as.numeric(Czech_Republic_data[, 7])
attributes(Czech_Republic_data)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
Czech_Republic_data[, 7] <- factor(Czech_Republic_data[, 7], levels=c(1,2),labels=c("Yes","No"))
names(Czech_Republic_data)[7] <- "q_0004"
#table(Czech_Republic_data$q_0004)
par(mar=c(3,3,2,2))
prop.table(table(Czech_Republic_data$q_0004))
pie(table(Czech_Republic_data$q_0004), main = "Receiving personal psychotherapy (present or past)")
```

```{r, echo=TRUE}
## I am undertaking training in Psychotherapy within my training programme in Psychiatry
## NO DATA ????
#tab <- table(Czech_Republic_data$q_0005_S05A1)
#length(tab)
#pie(table(Czech_Republic_data$q_0005_S05A1), main="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r, echo=TRUE}
table(Czech_Republic_data$q_0005_S05A2)
prop.table(table(Czech_Republic_data$q_0005_S05A2))
pie(table(Czech_Republic_data$q_0005_S05A2), main="Training in psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r, echo=TRUE}
#table(Czech_Republic_data$q_0005_S05A3)
pie(table(Czech_Republic_data$q_0005_S05A3),  main="I am not undertaking any training in Psychotherapy")
```

> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r, echo=TRUE}
#table(Czech_Republic_data$q_0005_S05A4)
prop.table(table(Czech_Republic_data$q_0005_S05A4))
pie(table(Czech_Republic_data$q_0005_S05A4), main="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality
```{r, echo=TRUE}
table(is.na(Czech_Republic_data$q_0006))
prop.table(table(is.na(Czech_Republic_data$q_0006)))
pie(table(is.na(Czech_Republic_data$q_0006)),main="I am training in some modality of psychotherapy")
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r, echo=TRUE}
table(Czech_Republic_data$q_0007)
prop.table(table(Czech_Republic_data$q_0007))
pie(table(Czech_Republic_data$q_0007), main="Psychotherapy important for the professional identity", col=terrain.colors(3))
```

## Do you want to practise Psychotherapy ?
```{r, echo=TRUE}
#table(Czech_Republic_data$q_0008)
prop.table(table(Czech_Republic_data$q_0008))
pie(table(Czech_Republic_data$q_0008), main="Plan to practise Psychotherapy after training")
```

## Are you interested in this psychotherapy?
```{r, echo=TRUE}
q9df <- Czech_Republic_data[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","Not Any","Other"),main="Interested in this therapy", las=1, col=rainbow(6),)
```

##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"
```{r, echo=TRUE, eval=FALSE}

barplot(table(Czech_Republic_data$q_0011_SQ001), col="green", main="Theoretical lectures or seminars in psychotherapy", border=NA)
abline(v=1.3, lwd=3)
text(0.6,215, "UEMS <", adj = c(0, -.1), font=2)
```
> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r, echo=TRUE, eval=FALSE}
#barplot(PWS, col="blue", main="Conducting Psychotherapy without supervision", border=NA)
```

```{r, echo=TRUE, eval=FALSE}

barplot(table(Czech_Republic_data$q_0011_SQ003), col="yellow", main="Conducting Psychotherapy under supervision")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Czech_Republic_data$q_0011_SQ004), col="orange", main="Personal Psychotherapy")
```

```{r, echo=TRUE}
TL <- table(Czech_Republic_data$q_0011_SQ001)
PNS <- table(Czech_Republic_data$q_0011_SQ002)
PWS <- table(Czech_Republic_data$q_0011_SQ003)
PP <- table(Czech_Republic_data$q_0011_SQ004)

mandatory <- cbind(prop.table(TL),prop.table(PNS), prop.table(PWS), prop.table(PP))
par(mar=c(3,3,5,9), xpd=TRUE)
barplot(mandatory, col=terrain.colors(3), names=c("Theorical lectures", "Psychotherapy 
without supervision", "Psychotherapy 
with supervision", "Personnal 
psychotherapy"), cex.name=1, main="The following experience in psychotherapy 
is a mandatory part of my training in Psychiatry", cex.main=1.5)
legend("topright", inset=c(-0.27,0), legend = c("Yes", "No", "Uncertain"), fill=(terrain.colors(3)), cex=0.9, bty="n")
```

```{r, echo=TRUE}
qualified <- prop.table(table(Czech_Republic_data$q_0012))
par(mar=c(4,5,5,3))
barplot(qualified, col=terrain.colors(3) , main="Are you qualified 
        to practice psychotherapy after your training ?", las=1, ylab="Frequency", cex.names=1.4, cex.lab=1.4, cex.main=1.4)
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
```{r, echo=TRUE}
#table(Czech_Republic_data$q_0013)
```

## How many hours of supervision
```{r, echo=TRUE}
par(mar=c(5,5,3,3), xpd=FALSE)
hist(Czech_Republic_data$q_0014_SQ001[which(is.na(Czech_Republic_data$q_0014_SQ001)==FALSE)], col="cornflowerblue", xlim=c(0,10), main ="Repartition of the hours of supervision in Europe", ylab="Frequency", xlab= "Hours by month", lwd=3, las=1, cex.lab=1.3, cex.main=1.3, breaks=10, freq=FALSE)
text(3.5, 0.30, paste(" Mean :",round(mean(Czech_Republic_data$q_0014_SQ001[which(is.na(Czech_Republic_data$q_0014_SQ001)==FALSE)]),2), "h"), font=2, cex=1.5, col="cornflowerblue")
text(3.3, 0.20, paste(" Median :", (median(Czech_Republic_data$q_0014_SQ001[which(is.na(Czech_Republic_data$q_0014_SQ001)==FALSE)])), "h"), font=2, cex=1.5, col="cornflowerblue")
abline(v=mean(Czech_Republic_data$q_0014_SQ001[which(is.na(Czech_Republic_data$q_0014_SQ001)==FALSE)]), col="cornflowerblue", lwd=3)
abline(v=1.7, lty=3, lwd=3)
text(3.5,0.40, "UEMS > 1.7h", font=2, cex=1.5)
#lines(density(Czech_Republic_data$q_0014_SQ002[which(is.na(Czech_Republic_data$q_0014_SQ002)==FALSE)]), col=rainbow(5)[2])
#lines(density(Czech_Republic_data$q_0014_SQ003[which(is.na(Czech_Republic_data$q_0014_SQ003)==FALSE)]), col=rainbow(5)[3])
#lines(density(Czech_Republic_data$q_0014_SQ004[which(is.na(Czech_Republic_data$q_0014_SQ004)==FALSE)]), col=rainbow(5)[4])
#lines(density(Czech_Republic_data$q_0014_SQ005[which(is.na(Czech_Republic_data$q_0014_SQ005)==FALSE)]), col=rainbow(5)[5])
#legend("topright", legend=c("Hours of Psychotherapy supervision per month", "Small group supervision (3 - 5 people)", "Large group supervision (more than 5 people)", "Generic Balint group", "Other form of supervision"), fill = rainbow(4), cex=0.7)
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r, echo=TRUE, eval=FALSE}
hist(Czech_Republic_data$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(2.5,300, "> UEMS", font=2)
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Czech_Republic_data$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Czech_Republic_data$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Czech_Republic_data$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r, echo=TRUE, eval=FALSE}
hist(Czech_Republic_data$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

table(Czech_Republic_data$q_0015)

##Who pays?
```{r, echo=TRUE, eval=FALSE}
barplot(table(Czech_Republic_data$q_0016_SQ002), col="light blue",
        xlab="Who pays for this component of Psychotherapy experience?",
        names=c("I pay", "State pays", "I don't have", "Free"),
        main="Supervision - individual")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Czech_Republic_data$q_0016_SQ003), col="light blue",
        main="Supervision - group",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Czech_Republic_data$q_0016_SQ004), col="light blue",
        main="Balint groups",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Czech_Republic_data$q_0016_SQ005), col="light blue",
        main="Sessions with patient(s)",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Czech_Republic_data$q_0016_SQ006), col="light blue",
        main="Self-experience",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays")
```

```{r, echo=TRUE}
par(mar=c(6,2.5,3,9), xpd=TRUE)
payTL <- table(Czech_Republic_data$q_0016_SQ001)
paySI <- table(Czech_Republic_data$q_0016_SQ002)
paySG <- table(Czech_Republic_data$q_0016_SQ003)
payBG <- table(Czech_Republic_data$q_0016_SQ004)
paySP <- table(Czech_Republic_data$q_0016_SQ005)
paySE <- table(Czech_Republic_data$q_0016_SQ006)
pay <- cbind(prop.table(payTL), prop.table(paySI), prop.table(paySG), prop.table(payBG), prop.table(paySP), prop.table(paySE))
barplot(pay, col=terrain.colors(4),
        main="Who pays?",
        names=c("Theorectical 
lectures", "Supervision 
indiv.", "Supervision 
group", "Balint
groups ", "Sessions
with patient(s)", "Self
experience"), cex.name=0.8, las=2)
legend("topright", inset=c(-0.38,0), legend = c("I pay", "The state pays", "I don't have", "Free"), fill=(terrain.colors(4)), cex=0.9, bty="n")
```

## Would you train for free?
```{r, echo=TRUE}
prop.table(table(Czech_Republic_data$q_0017))
par(mar=c(3,2,2,2))
pie(table(Czech_Republic_data$q_0017),
    main="Motivated to train in Psychotherapy for free?")
text(-0.2,-0.95, "UEMS recommendations states that psychotherapy training 
of trainees should be funded publicly and free for trainees.")
```

## How much would you invest in psychotherapy training ?
```{r, echo=TRUE}
par(mar=c(6,2.5,3,2), xpd=FALSE)
hist(Czech_Republic_data$q_0018[which(Czech_Republic_data$q_0018<100)], col="light green",
     main="% of annual salary for psychotherapy training",
     xlab="Percentage of your annual salary do you intend to spend on funding your psychotherapy training In the next 12 months?", cex.lab=1.1, cex.main=1.7)
abline(v=mean(Czech_Republic_data$q_0018[which(Czech_Republic_data$q_0018<100)]), lwd=2, lty=2)
text(20, 200, paste("Mean :",round( mean(Czech_Republic_data$q_0018[which(Czech_Republic_data$q_0018<100)])), " %"), font=2, cex=1.3)
text(20, 150, paste("Median :" , median(Czech_Republic_data$q_0018[which(Czech_Republic_data$q_0018<100)]), " %"), font=2, cex=1.3)
```

## Satisfaction group
```{r, echo=TRUE}
# make auxiliary table to hold our likert Czech_Republic_data
sat1<-Czech_Republic_data[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(Czech_Republic_data$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- Czech_Republic_data[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## UEMS recommendations awareness
```{r, echo=TRUE}
# and same with the
uems2 <- Czech_Republic_data[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

# Estonia results
```{r,include = FALSE}
dim(Estonia_data)
str(Estonia_data)
summary(Estonia_data)
```

## Number of participants
```{r, echo = FALSE}
# table(Estonia_data[which(complete.cases(Estonia_data$q_0000)==TRUE),]$q_0000)
countryanswers <- sort(table(Estonia_data$q_0000), decreasing = FALSE)
answering_countries <- countryanswers[which (countryanswers > 0)]
#delete France false data
answering_countries <- answering_countries[-3]

par(mar=c(2.5,9.5,2,2))
barplot(answering_countries, cex.names=0.9, las=1, main="Number of answers by country", col="cornflowerblue", horiz=TRUE, border=NA)
text(45,6, paste(length(answering_countries), "countries
                Total of answers :", sum(answering_countries),
                 "
                              Mean answers by country: " , round(mean(answering_countries)),"
               
                      Top 4: Romania, France, 
                      Slovenia, Czech Republic"), cex=1.2)
abline(v=mean(answering_countries), lty=2)
text(19, 0.7,"Mean", font=2)
```

## Gender
```{r, echo=TRUE, fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
gender <-table(Estonia_data$q_0001)
#prop.table(gender)
pie(gender, main="Gender of participants in Europe reponses")
```

##Age
```{r, echo=TRUE,  fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
#error max = 1969 !!!
age_Europe <- Estonia_data$q_0002[which(Estonia_data$q_0002<1969)]
hist(age_Europe, col="cornflowerblue",
     xlab="Age", ylab="Number", main="Age distribution", freq=TRUE, border=NA, breaks=25 )
text(47, 40, paste("Mean age:", round(mean(age_Europe),0), "years"))
abline(v=mean(age_Europe), lty=2)
```

## Year in Training
```{r, echo=TRUE}
YoT <- table(Estonia_data$q_0003)
names(YoT)<- c(1:8, "> 8", "TF")
par(mfrow=c(1,1), mar=c(3,3,2,2))
barplot(YoT, main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number", cex.names=1)
```
>TF for training finished

## Are you receiving personal psychotherapy or have you received it in the past?
```{r, echo=TRUE}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
Estonia_data[, 7] <- as.numeric(Estonia_data[, 7])
attributes(Estonia_data)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
Estonia_data[, 7] <- factor(Estonia_data[, 7], levels=c(1,2),labels=c("Yes","No"))
names(Estonia_data)[7] <- "q_0004"
#table(Estonia_data$q_0004)
par(mar=c(3,3,2,2))
prop.table(table(Estonia_data$q_0004))
pie(table(Estonia_data$q_0004), main = "Receiving personal psychotherapy (present or past)")
```

```{r, echo=TRUE}
## I am undertaking training in Psychotherapy within my training programme in Psychiatry
## NO DATA ????
#tab <- table(Estonia_data$q_0005_S05A1)
#length(tab)
#pie(table(Estonia_data$q_0005_S05A1), main="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r, echo=TRUE}
table(Estonia_data$q_0005_S05A2)
prop.table(table(Estonia_data$q_0005_S05A2))
pie(table(Estonia_data$q_0005_S05A2), main="Training in psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r, echo=TRUE}
#table(Estonia_data$q_0005_S05A3)
pie(table(Estonia_data$q_0005_S05A3),  main="I am not undertaking any training in Psychotherapy")
```

> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r, echo=TRUE}
#table(Estonia_data$q_0005_S05A4)
prop.table(table(Estonia_data$q_0005_S05A4))
pie(table(Estonia_data$q_0005_S05A4), main="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality
```{r, echo=TRUE}
table(is.na(Estonia_data$q_0006))
prop.table(table(is.na(Estonia_data$q_0006)))
pie(table(is.na(Estonia_data$q_0006)),main="I am training in some modality of psychotherapy")
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r, echo=TRUE}
table(Estonia_data$q_0007)
prop.table(table(Estonia_data$q_0007))
pie(table(Estonia_data$q_0007), main="Psychotherapy important for the professional identity", col=terrain.colors(3))
```

## Do you want to practise Psychotherapy ?
```{r, echo=TRUE}
#table(Estonia_data$q_0008)
prop.table(table(Estonia_data$q_0008))
pie(table(Estonia_data$q_0008), main="Plan to practise Psychotherapy after training")
```

## Are you interested in this psychotherapy?
```{r, echo=TRUE}
q9df <- Estonia_data[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","Not Any","Other"),main="Interested in this therapy", las=1, col=rainbow(6),)
```

##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"
```{r, echo=TRUE, eval=FALSE}

barplot(table(Estonia_data$q_0011_SQ001), col="green", main="Theoretical lectures or seminars in psychotherapy", border=NA)
abline(v=1.3, lwd=3)
text(0.6,215, "UEMS <", adj = c(0, -.1), font=2)
```
> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r, echo=TRUE, eval=FALSE}
#barplot(PWS, col="blue", main="Conducting Psychotherapy without supervision", border=NA)
```

```{r, echo=TRUE, eval=FALSE}

barplot(table(Estonia_data$q_0011_SQ003), col="yellow", main="Conducting Psychotherapy under supervision")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Estonia_data$q_0011_SQ004), col="orange", main="Personal Psychotherapy")
```

```{r, echo=TRUE}
TL <- table(Estonia_data$q_0011_SQ001)
PNS <- table(Estonia_data$q_0011_SQ002)
PWS <- table(Estonia_data$q_0011_SQ003)
PP <- table(Estonia_data$q_0011_SQ004)

mandatory <- cbind(prop.table(TL),prop.table(PNS), prop.table(PWS), prop.table(PP))
par(mar=c(3,3,5,9), xpd=TRUE)
barplot(mandatory, col=terrain.colors(3), names=c("Theorical lectures", "Psychotherapy 
without supervision", "Psychotherapy 
with supervision", "Personnal 
psychotherapy"), cex.name=1, main="The following experience in psychotherapy 
is a mandatory part of my training in Psychiatry", cex.main=1.5)
legend("topright", inset=c(-0.27,0), legend = c("Yes", "No", "Uncertain"), fill=(terrain.colors(3)), cex=0.9, bty="n")
```

```{r, echo=TRUE}
qualified <- prop.table(table(Estonia_data$q_0012))
par(mar=c(4,5,5,3))
barplot(qualified, col=terrain.colors(3) , main="Are you qualified 
        to practice psychotherapy after your training ?", las=1, ylab="Frequency", cex.names=1.4, cex.lab=1.4, cex.main=1.4)
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
```{r, echo=TRUE}
#table(Estonia_data$q_0013)
```

## How many hours of supervision
```{r, echo=TRUE}
par(mar=c(5,5,3,3), xpd=FALSE)
hist(Estonia_data$q_0014_SQ001[which(is.na(Estonia_data$q_0014_SQ001)==FALSE)], col="cornflowerblue", xlim=c(0,10), main ="Repartition of the hours of supervision in Europe", ylab="Frequency", xlab= "Hours by month", lwd=3, las=1, cex.lab=1.3, cex.main=1.3, breaks=10, freq=FALSE)
text(3.5, 0.30, paste(" Mean :",round(mean(Estonia_data$q_0014_SQ001[which(is.na(Estonia_data$q_0014_SQ001)==FALSE)]),2), "h"), font=2, cex=1.5, col="cornflowerblue")
text(3.3, 0.20, paste(" Median :", (median(Estonia_data$q_0014_SQ001[which(is.na(Estonia_data$q_0014_SQ001)==FALSE)])), "h"), font=2, cex=1.5, col="cornflowerblue")
abline(v=mean(Estonia_data$q_0014_SQ001[which(is.na(Estonia_data$q_0014_SQ001)==FALSE)]), col="cornflowerblue", lwd=3)
abline(v=1.7, lty=3, lwd=3)
text(3.5,0.40, "UEMS > 1.7h", font=2, cex=1.5)
#lines(density(Estonia_data$q_0014_SQ002[which(is.na(Estonia_data$q_0014_SQ002)==FALSE)]), col=rainbow(5)[2])
#lines(density(Estonia_data$q_0014_SQ003[which(is.na(Estonia_data$q_0014_SQ003)==FALSE)]), col=rainbow(5)[3])
#lines(density(Estonia_data$q_0014_SQ004[which(is.na(Estonia_data$q_0014_SQ004)==FALSE)]), col=rainbow(5)[4])
#lines(density(Estonia_data$q_0014_SQ005[which(is.na(Estonia_data$q_0014_SQ005)==FALSE)]), col=rainbow(5)[5])
#legend("topright", legend=c("Hours of Psychotherapy supervision per month", "Small group supervision (3 - 5 people)", "Large group supervision (more than 5 people)", "Generic Balint group", "Other form of supervision"), fill = rainbow(4), cex=0.7)
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r, echo=TRUE, eval=FALSE}
hist(Estonia_data$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(2.5,300, "> UEMS", font=2)
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Estonia_data$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Estonia_data$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Estonia_data$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r, echo=TRUE, eval=FALSE}
hist(Estonia_data$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

table(Estonia_data$q_0015)

##Who pays?
```{r, echo=TRUE, eval=FALSE}
barplot(table(Estonia_data$q_0016_SQ002), col="light blue",
        xlab="Who pays for this component of Psychotherapy experience?",
        names=c("I pay", "State pays", "I don't have", "Free"),
        main="Supervision - individual")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Estonia_data$q_0016_SQ003), col="light blue",
        main="Supervision - group",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Estonia_data$q_0016_SQ004), col="light blue",
        main="Balint groups",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Estonia_data$q_0016_SQ005), col="light blue",
        main="Sessions with patient(s)",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Estonia_data$q_0016_SQ006), col="light blue",
        main="Self-experience",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays")
```

```{r, echo=TRUE}
par(mar=c(6,2.5,3,9), xpd=TRUE)
payTL <- table(Estonia_data$q_0016_SQ001)
paySI <- table(Estonia_data$q_0016_SQ002)
paySG <- table(Estonia_data$q_0016_SQ003)
payBG <- table(Estonia_data$q_0016_SQ004)
paySP <- table(Estonia_data$q_0016_SQ005)
paySE <- table(Estonia_data$q_0016_SQ006)
pay <- cbind(prop.table(payTL), prop.table(paySI), prop.table(paySG), prop.table(payBG), prop.table(paySP), prop.table(paySE))
barplot(pay, col=terrain.colors(4),
        main="Who pays?",
        names=c("Theorectical 
lectures", "Supervision 
indiv.", "Supervision 
group", "Balint
groups ", "Sessions
with patient(s)", "Self
experience"), cex.name=0.8, las=2)
legend("topright", inset=c(-0.38,0), legend = c("I pay", "The state pays", "I don't have", "Free"), fill=(terrain.colors(4)), cex=0.9, bty="n")
```

## Would you train for free?
```{r, echo=TRUE}
prop.table(table(Estonia_data$q_0017))
par(mar=c(3,2,2,2))
pie(table(Estonia_data$q_0017),
    main="Motivated to train in Psychotherapy for free?")
text(-0.2,-0.95, "UEMS recommendations states that psychotherapy training 
of trainees should be funded publicly and free for trainees.")
```

## How much would you invest in psychotherapy training ?
```{r, echo=TRUE}
par(mar=c(6,2.5,3,2), xpd=FALSE)
hist(Estonia_data$q_0018[which(Estonia_data$q_0018<100)], col="light green",
     main="% of annual salary for psychotherapy training",
     xlab="Percentage of your annual salary do you intend to spend on funding your psychotherapy training In the next 12 months?", cex.lab=1.1, cex.main=1.7)
abline(v=mean(Estonia_data$q_0018[which(Estonia_data$q_0018<100)]), lwd=2, lty=2)
text(20, 200, paste("Mean :",round( mean(Estonia_data$q_0018[which(Estonia_data$q_0018<100)])), " %"), font=2, cex=1.3)
text(20, 150, paste("Median :" , median(Estonia_data$q_0018[which(Estonia_data$q_0018<100)]), " %"), font=2, cex=1.3)
```

## Satisfaction group
```{r, echo=TRUE}
# make auxiliary table to hold our likert Estonia_data
sat1<-Estonia_data[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(Estonia_data$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- Estonia_data[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## UEMS recommendations awareness
```{r, echo=TRUE}
# and same with the
uems2 <- Estonia_data[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

# Finland results
```{r,include = FALSE}
dim(Finland_data)
str(Finland_data)
summary(Finland_data)
```

## Number of participants
```{r, echo = FALSE}
# table(Finland_data[which(complete.cases(Finland_data$q_0000)==TRUE),]$q_0000)
countryanswers <- sort(table(Finland_data$q_0000), decreasing = FALSE)
answering_countries <- countryanswers[which (countryanswers > 0)]
#delete France false data
answering_countries <- answering_countries[-3]

par(mar=c(2.5,9.5,2,2))
barplot(answering_countries, cex.names=0.9, las=1, main="Number of answers by country", col="cornflowerblue", horiz=TRUE, border=NA)
text(45,6, paste(length(answering_countries), "countries
                Total of answers :", sum(answering_countries),
                 "
                              Mean answers by country: " , round(mean(answering_countries)),"
               
                      Top 4: Romania, France, 
                      Slovenia, Czech Republic"), cex=1.2)
abline(v=mean(answering_countries), lty=2)
text(19, 0.7,"Mean", font=2)
```

## Gender
```{r, echo=TRUE, fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
gender <-table(Finland_data$q_0001)
#prop.table(gender)
pie(gender, main="Gender of participants in Europe reponses")
```

##Age
```{r, echo=TRUE,  fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
#error max = 1969 !!!
age_Europe <- Finland_data$q_0002[which(Finland_data$q_0002<1969)]
hist(age_Europe, col="cornflowerblue",
     xlab="Age", ylab="Number", main="Age distribution", freq=TRUE, border=NA, breaks=25 )
text(47, 40, paste("Mean age:", round(mean(age_Europe),0), "years"))
abline(v=mean(age_Europe), lty=2)
```

## Year in Training
```{r, echo=TRUE}
YoT <- table(Finland_data$q_0003)
names(YoT)<- c(1:8, "> 8", "TF")
par(mfrow=c(1,1), mar=c(3,3,2,2))
barplot(YoT, main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number", cex.names=1)
```
>TF for training finished

## Are you receiving personal psychotherapy or have you received it in the past?
```{r, echo=TRUE}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
Finland_data[, 7] <- as.numeric(Finland_data[, 7])
attributes(Finland_data)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
Finland_data[, 7] <- factor(Finland_data[, 7], levels=c(1,2),labels=c("Yes","No"))
names(Finland_data)[7] <- "q_0004"
#table(Finland_data$q_0004)
par(mar=c(3,3,2,2))
prop.table(table(Finland_data$q_0004))
pie(table(Finland_data$q_0004), main = "Receiving personal psychotherapy (present or past)")
```

```{r, echo=TRUE}
## I am undertaking training in Psychotherapy within my training programme in Psychiatry
## NO DATA ????
#tab <- table(Finland_data$q_0005_S05A1)
#length(tab)
#pie(table(Finland_data$q_0005_S05A1), main="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r, echo=TRUE}
table(Finland_data$q_0005_S05A2)
prop.table(table(Finland_data$q_0005_S05A2))
pie(table(Finland_data$q_0005_S05A2), main="Training in psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r, echo=TRUE}
#table(Finland_data$q_0005_S05A3)
pie(table(Finland_data$q_0005_S05A3),  main="I am not undertaking any training in Psychotherapy")
```

> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r, echo=TRUE}
#table(Finland_data$q_0005_S05A4)
prop.table(table(Finland_data$q_0005_S05A4))
pie(table(Finland_data$q_0005_S05A4), main="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality
```{r, echo=TRUE}
table(is.na(Finland_data$q_0006))
prop.table(table(is.na(Finland_data$q_0006)))
pie(table(is.na(Finland_data$q_0006)),main="I am training in some modality of psychotherapy")
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r, echo=TRUE}
table(Finland_data$q_0007)
prop.table(table(Finland_data$q_0007))
pie(table(Finland_data$q_0007), main="Psychotherapy important for the professional identity", col=terrain.colors(3))
```

## Do you want to practise Psychotherapy ?
```{r, echo=TRUE}
#table(Finland_data$q_0008)
prop.table(table(Finland_data$q_0008))
pie(table(Finland_data$q_0008), main="Plan to practise Psychotherapy after training")
```

## Are you interested in this psychotherapy?
```{r, echo=TRUE}
q9df <- Finland_data[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","Not Any","Other"),main="Interested in this therapy", las=1, col=rainbow(6),)
```

##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"
```{r, echo=TRUE, eval=FALSE}

barplot(table(Finland_data$q_0011_SQ001), col="green", main="Theoretical lectures or seminars in psychotherapy", border=NA)
abline(v=1.3, lwd=3)
text(0.6,215, "UEMS <", adj = c(0, -.1), font=2)
```
> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r, echo=TRUE, eval=FALSE}
#barplot(PWS, col="blue", main="Conducting Psychotherapy without supervision", border=NA)
```

```{r, echo=TRUE, eval=FALSE}

barplot(table(Finland_data$q_0011_SQ003), col="yellow", main="Conducting Psychotherapy under supervision")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Finland_data$q_0011_SQ004), col="orange", main="Personal Psychotherapy")
```

```{r, echo=TRUE}
TL <- table(Finland_data$q_0011_SQ001)
PNS <- table(Finland_data$q_0011_SQ002)
PWS <- table(Finland_data$q_0011_SQ003)
PP <- table(Finland_data$q_0011_SQ004)

mandatory <- cbind(prop.table(TL),prop.table(PNS), prop.table(PWS), prop.table(PP))
par(mar=c(3,3,5,9), xpd=TRUE)
barplot(mandatory, col=terrain.colors(3), names=c("Theorical lectures", "Psychotherapy 
without supervision", "Psychotherapy 
with supervision", "Personnal 
psychotherapy"), cex.name=1, main="The following experience in psychotherapy 
is a mandatory part of my training in Psychiatry", cex.main=1.5)
legend("topright", inset=c(-0.27,0), legend = c("Yes", "No", "Uncertain"), fill=(terrain.colors(3)), cex=0.9, bty="n")
```

```{r, echo=TRUE}
qualified <- prop.table(table(Finland_data$q_0012))
par(mar=c(4,5,5,3))
barplot(qualified, col=terrain.colors(3) , main="Are you qualified 
        to practice psychotherapy after your training ?", las=1, ylab="Frequency", cex.names=1.4, cex.lab=1.4, cex.main=1.4)
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
```{r, echo=TRUE}
#table(Finland_data$q_0013)
```

## How many hours of supervision
```{r, echo=TRUE}
par(mar=c(5,5,3,3), xpd=FALSE)
hist(Finland_data$q_0014_SQ001[which(is.na(Finland_data$q_0014_SQ001)==FALSE)], col="cornflowerblue", xlim=c(0,10), main ="Repartition of the hours of supervision in Europe", ylab="Frequency", xlab= "Hours by month", lwd=3, las=1, cex.lab=1.3, cex.main=1.3, breaks=10, freq=FALSE)
text(3.5, 0.30, paste(" Mean :",round(mean(Finland_data$q_0014_SQ001[which(is.na(Finland_data$q_0014_SQ001)==FALSE)]),2), "h"), font=2, cex=1.5, col="cornflowerblue")
text(3.3, 0.20, paste(" Median :", (median(Finland_data$q_0014_SQ001[which(is.na(Finland_data$q_0014_SQ001)==FALSE)])), "h"), font=2, cex=1.5, col="cornflowerblue")
abline(v=mean(Finland_data$q_0014_SQ001[which(is.na(Finland_data$q_0014_SQ001)==FALSE)]), col="cornflowerblue", lwd=3)
abline(v=1.7, lty=3, lwd=3)
text(3.5,0.40, "UEMS > 1.7h", font=2, cex=1.5)
#lines(density(Finland_data$q_0014_SQ002[which(is.na(Finland_data$q_0014_SQ002)==FALSE)]), col=rainbow(5)[2])
#lines(density(Finland_data$q_0014_SQ003[which(is.na(Finland_data$q_0014_SQ003)==FALSE)]), col=rainbow(5)[3])
#lines(density(Finland_data$q_0014_SQ004[which(is.na(Finland_data$q_0014_SQ004)==FALSE)]), col=rainbow(5)[4])
#lines(density(Finland_data$q_0014_SQ005[which(is.na(Finland_data$q_0014_SQ005)==FALSE)]), col=rainbow(5)[5])
#legend("topright", legend=c("Hours of Psychotherapy supervision per month", "Small group supervision (3 - 5 people)", "Large group supervision (more than 5 people)", "Generic Balint group", "Other form of supervision"), fill = rainbow(4), cex=0.7)
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r, echo=TRUE, eval=FALSE}
hist(Finland_data$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(2.5,300, "> UEMS", font=2)
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Finland_data$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Finland_data$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Finland_data$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r, echo=TRUE, eval=FALSE}
hist(Finland_data$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

table(Finland_data$q_0015)

##Who pays?
```{r, echo=TRUE, eval=FALSE}
barplot(table(Finland_data$q_0016_SQ002), col="light blue",
        xlab="Who pays for this component of Psychotherapy experience?",
        names=c("I pay", "State pays", "I don't have", "Free"),
        main="Supervision - individual")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Finland_data$q_0016_SQ003), col="light blue",
        main="Supervision - group",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Finland_data$q_0016_SQ004), col="light blue",
        main="Balint groups",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Finland_data$q_0016_SQ005), col="light blue",
        main="Sessions with patient(s)",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Finland_data$q_0016_SQ006), col="light blue",
        main="Self-experience",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays")
```

```{r, echo=TRUE}
par(mar=c(6,2.5,3,9), xpd=TRUE)
payTL <- table(Finland_data$q_0016_SQ001)
paySI <- table(Finland_data$q_0016_SQ002)
paySG <- table(Finland_data$q_0016_SQ003)
payBG <- table(Finland_data$q_0016_SQ004)
paySP <- table(Finland_data$q_0016_SQ005)
paySE <- table(Finland_data$q_0016_SQ006)
pay <- cbind(prop.table(payTL), prop.table(paySI), prop.table(paySG), prop.table(payBG), prop.table(paySP), prop.table(paySE))
barplot(pay, col=terrain.colors(4),
        main="Who pays?",
        names=c("Theorectical 
lectures", "Supervision 
indiv.", "Supervision 
group", "Balint
groups ", "Sessions
with patient(s)", "Self
experience"), cex.name=0.8, las=2)
legend("topright", inset=c(-0.38,0), legend = c("I pay", "The state pays", "I don't have", "Free"), fill=(terrain.colors(4)), cex=0.9, bty="n")
```

## Would you train for free?
```{r, echo=TRUE}
prop.table(table(Finland_data$q_0017))
par(mar=c(3,2,2,2))
pie(table(Finland_data$q_0017),
    main="Motivated to train in Psychotherapy for free?")
text(-0.2,-0.95, "UEMS recommendations states that psychotherapy training 
of trainees should be funded publicly and free for trainees.")
```

## How much would you invest in psychotherapy training ?
```{r, echo=TRUE}
par(mar=c(6,2.5,3,2), xpd=FALSE)
hist(Finland_data$q_0018[which(Finland_data$q_0018<100)], col="light green",
     main="% of annual salary for psychotherapy training",
     xlab="Percentage of your annual salary do you intend to spend on funding your psychotherapy training In the next 12 months?", cex.lab=1.1, cex.main=1.7)
abline(v=mean(Finland_data$q_0018[which(Finland_data$q_0018<100)]), lwd=2, lty=2)
text(20, 200, paste("Mean :",round( mean(Finland_data$q_0018[which(Finland_data$q_0018<100)])), " %"), font=2, cex=1.3)
text(20, 150, paste("Median :" , median(Finland_data$q_0018[which(Finland_data$q_0018<100)]), " %"), font=2, cex=1.3)
```

## Satisfaction group
```{r, echo=TRUE}
# make auxiliary table to hold our likert Finland_data
sat1<-Finland_data[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(Finland_data$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- Finland_data[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## UEMS recommendations awareness
```{r, echo=TRUE}
# and same with the
uems2 <- Finland_data[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

# France results
```{r,include = FALSE}
dim(France_data)
str(France_data)
summary(France_data)
```

## Number of participants
```{r, echo = FALSE}
# table(France_data[which(complete.cases(France_data$q_0000)==TRUE),]$q_0000)
countryanswers <- sort(table(France_data$q_0000), decreasing = FALSE)
answering_countries <- countryanswers[which (countryanswers > 0)]
#delete France false data
answering_countries <- answering_countries[-3]

par(mar=c(2.5,9.5,2,2))
barplot(answering_countries, cex.names=0.9, las=1, main="Number of answers by country", col="cornflowerblue", horiz=TRUE, border=NA)
text(45,6, paste(length(answering_countries), "countries
                Total of answers :", sum(answering_countries),
                 "
                              Mean answers by country: " , round(mean(answering_countries)),"
               
                      Top 4: Romania, France, 
                      Slovenia, Czech Republic"), cex=1.2)
abline(v=mean(answering_countries), lty=2)
text(19, 0.7,"Mean", font=2)

answering_countries
```

## Gender
```{r, echo=TRUE, fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
gender <-table(France_data$q_0001)
#prop.table(gender)
pie(gender, main="Gender of participants in Europe reponses")
```

##Age
```{r, echo=TRUE,  fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
#error max = 1969 !!!
age_Europe <- France_data$q_0002[which(France_data$q_0002<1969)]
hist(age_Europe, col="cornflowerblue",
     xlab="Age", ylab="Number", main="Age distribution", freq=TRUE, border=NA, breaks=25 )
text(47, 40, paste("Mean age:", round(mean(age_Europe),0), "years"))
abline(v=mean(age_Europe), lty=2)
```

## Year in Training
```{r, echo=TRUE}
YoT <- table(France_data$q_0003)
names(YoT)<- c(1:8, "> 8", "TF")
par(mfrow=c(1,1), mar=c(3,3,2,2))
barplot(YoT, main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number", cex.names=1)
```
>TF for training finished

## Are you receiving personal psychotherapy or have you received it in the past?
```{r, echo=TRUE}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
France_data[, 7] <- as.numeric(France_data[, 7])
attributes(France_data)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
France_data[, 7] <- factor(France_data[, 7], levels=c(1,2),labels=c("Yes","No"))
names(France_data)[7] <- "q_0004"
#table(France_data$q_0004)
par(mar=c(3,3,2,2))
prop.table(table(France_data$q_0004))
pie(table(France_data$q_0004), main = "Receiving personal psychotherapy (present or past)")
```

```{r, echo=TRUE}
## I am undertaking training in Psychotherapy within my training programme in Psychiatry
## NO DATA ????
#tab <- table(France_data$q_0005_S05A1)
#length(tab)
#pie(table(France_data$q_0005_S05A1), main="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r, echo=TRUE}
table(France_data$q_0005_S05A2)
prop.table(table(France_data$q_0005_S05A2))
pie(table(France_data$q_0005_S05A2), main="Training in psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r, echo=TRUE}
#table(France_data$q_0005_S05A3)
pie(table(France_data$q_0005_S05A3),  main="I am not undertaking any training in Psychotherapy")
```

> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r, echo=TRUE}
#table(France_data$q_0005_S05A4)
prop.table(table(France_data$q_0005_S05A4))
pie(table(France_data$q_0005_S05A4), main="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality
```{r, echo=TRUE}
table(is.na(France_data$q_0006))
prop.table(table(is.na(France_data$q_0006)))
pie(table(is.na(France_data$q_0006)),main="I am training in some modality of psychotherapy")
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r, echo=TRUE}
table(France_data$q_0007)
prop.table(table(France_data$q_0007))
pie(table(France_data$q_0007), main="Psychotherapy important for the professional identity", col=terrain.colors(3))
```

## Do you want to practise Psychotherapy ?
```{r, echo=TRUE}
#table(France_data$q_0008)
prop.table(table(France_data$q_0008))
pie(table(France_data$q_0008), main="Plan to practise Psychotherapy after training")
```

## Are you interested in this psychotherapy?
```{r, echo=TRUE}
q9df <- France_data[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","Not Any","Other"),main="Interested in this therapy", las=1, col=rainbow(6),)
```

##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"
```{r, echo=TRUE, eval=FALSE}

barplot(table(France_data$q_0011_SQ001), col="green", main="Theoretical lectures or seminars in psychotherapy", border=NA)
abline(v=1.3, lwd=3)
text(0.6,215, "UEMS <", adj = c(0, -.1), font=2)
```
> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r, echo=TRUE, eval=FALSE}
#barplot(PWS, col="blue", main="Conducting Psychotherapy without supervision", border=NA)
```

```{r, echo=TRUE, eval=FALSE}

barplot(table(France_data$q_0011_SQ003), col="yellow", main="Conducting Psychotherapy under supervision")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(France_data$q_0011_SQ004), col="orange", main="Personal Psychotherapy")
```

```{r, echo=TRUE}
TL <- table(France_data$q_0011_SQ001)
PNS <- table(France_data$q_0011_SQ002)
PWS <- table(France_data$q_0011_SQ003)
PP <- table(France_data$q_0011_SQ004)

mandatory <- cbind(prop.table(TL),prop.table(PNS), prop.table(PWS), prop.table(PP))
par(mar=c(3,3,5,9), xpd=TRUE)
barplot(mandatory, col=terrain.colors(3), names=c("Theorical lectures", "Psychotherapy 
without supervision", "Psychotherapy 
with supervision", "Personnal 
psychotherapy"), cex.name=1, main="The following experience in psychotherapy 
is a mandatory part of my training in Psychiatry", cex.main=1.5)
legend("topright", inset=c(-0.27,0), legend = c("Yes", "No", "Uncertain"), fill=(terrain.colors(3)), cex=0.9, bty="n")
```

```{r, echo=TRUE}
qualified <- prop.table(table(France_data$q_0012))
par(mar=c(4,5,5,3))
barplot(qualified, col=terrain.colors(3) , main="Are you qualified 
        to practice psychotherapy after your training ?", las=1, ylab="Frequency", cex.names=1.4, cex.lab=1.4, cex.main=1.4)
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
```{r, echo=TRUE}
#table(France_data$q_0013)
```

## How many hours of supervision
```{r, echo=TRUE}
par(mar=c(5,5,3,3), xpd=FALSE)
hist(France_data$q_0014_SQ001[which(is.na(France_data$q_0014_SQ001)==FALSE)], col="cornflowerblue", xlim=c(0,10), main ="Repartition of the hours of supervision in Europe", ylab="Frequency", xlab= "Hours by month", lwd=3, las=1, cex.lab=1.3, cex.main=1.3, breaks=10, freq=FALSE)
text(3.5, 0.30, paste(" Mean :",round(mean(France_data$q_0014_SQ001[which(is.na(France_data$q_0014_SQ001)==FALSE)]),2), "h"), font=2, cex=1.5, col="cornflowerblue")
text(3.3, 0.20, paste(" Median :", (median(France_data$q_0014_SQ001[which(is.na(France_data$q_0014_SQ001)==FALSE)])), "h"), font=2, cex=1.5, col="cornflowerblue")
abline(v=mean(France_data$q_0014_SQ001[which(is.na(France_data$q_0014_SQ001)==FALSE)]), col="cornflowerblue", lwd=3)
abline(v=1.7, lty=3, lwd=3)
text(3.5,0.40, "UEMS > 1.7h", font=2, cex=1.5)
#lines(density(France_data$q_0014_SQ002[which(is.na(France_data$q_0014_SQ002)==FALSE)]), col=rainbow(5)[2])
#lines(density(France_data$q_0014_SQ003[which(is.na(France_data$q_0014_SQ003)==FALSE)]), col=rainbow(5)[3])
#lines(density(France_data$q_0014_SQ004[which(is.na(France_data$q_0014_SQ004)==FALSE)]), col=rainbow(5)[4])
#lines(density(France_data$q_0014_SQ005[which(is.na(France_data$q_0014_SQ005)==FALSE)]), col=rainbow(5)[5])
#legend("topright", legend=c("Hours of Psychotherapy supervision per month", "Small group supervision (3 - 5 people)", "Large group supervision (more than 5 people)", "Generic Balint group", "Other form of supervision"), fill = rainbow(4), cex=0.7)
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r, echo=TRUE, eval=FALSE}
hist(France_data$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(2.5,300, "> UEMS", font=2)
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(France_data$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(France_data$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(France_data$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r, echo=TRUE, eval=FALSE}
hist(France_data$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

table(France_data$q_0015)

##Who pays?
```{r, echo=TRUE, eval=FALSE}
barplot(table(France_data$q_0016_SQ002), col="light blue",
        xlab="Who pays for this component of Psychotherapy experience?",
        names=c("I pay", "State pays", "I don't have", "Free"),
        main="Supervision - individual")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(France_data$q_0016_SQ003), col="light blue",
        main="Supervision - group",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(France_data$q_0016_SQ004), col="light blue",
        main="Balint groups",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(France_data$q_0016_SQ005), col="light blue",
        main="Sessions with patient(s)",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(France_data$q_0016_SQ006), col="light blue",
        main="Self-experience",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays")
```

```{r, echo=TRUE}
par(mar=c(6,2.5,3,9), xpd=TRUE)
payTL <- table(France_data$q_0016_SQ001)
paySI <- table(France_data$q_0016_SQ002)
paySG <- table(France_data$q_0016_SQ003)
payBG <- table(France_data$q_0016_SQ004)
paySP <- table(France_data$q_0016_SQ005)
paySE <- table(France_data$q_0016_SQ006)
pay <- cbind(prop.table(payTL), prop.table(paySI), prop.table(paySG), prop.table(payBG), prop.table(paySP), prop.table(paySE))
barplot(pay, col=terrain.colors(4),
        main="Who pays?",
        names=c("Theorectical 
lectures", "Supervision 
indiv.", "Supervision 
group", "Balint
groups ", "Sessions
with patient(s)", "Self
experience"), cex.name=0.8, las=2)
legend("topright", inset=c(-0.38,0), legend = c("I pay", "The state pays", "I don't have", "Free"), fill=(terrain.colors(4)), cex=0.9, bty="n")
```

## Would you train for free?
```{r, echo=TRUE}
prop.table(table(France_data$q_0017))
par(mar=c(3,2,2,2))
pie(table(France_data$q_0017),
    main="Motivated to train in Psychotherapy for free?")
text(-0.2,-0.95, "UEMS recommendations states that psychotherapy training 
of trainees should be funded publicly and free for trainees.")
```

## How much would you invest in psychotherapy training ?
```{r, echo=TRUE}
par(mar=c(6,2.5,3,2), xpd=FALSE)
hist(France_data$q_0018[which(France_data$q_0018<100)], col="light green",
     main="% of annual salary for psychotherapy training",
     xlab="Percentage of your annual salary do you intend to spend on funding your psychotherapy training In the next 12 months?", cex.lab=1.1, cex.main=1.7)
abline(v=mean(France_data$q_0018[which(France_data$q_0018<100)]), lwd=2, lty=2)
text(20, 200, paste("Mean :",round( mean(France_data$q_0018[which(France_data$q_0018<100)])), " %"), font=2, cex=1.3)
text(20, 150, paste("Median :" , median(France_data$q_0018[which(France_data$q_0018<100)]), " %"), font=2, cex=1.3)
```

## Satisfaction group
```{r, echo=TRUE}
# make auxiliary table to hold our likert France_data
sat1<-France_data[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(France_data$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- France_data[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## UEMS recommendations awareness
```{r, echo=TRUE}
# and same with the
uems2 <- France_data[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

# Germany results
```{r,include = FALSE}
dim(Germany_data)
str(Germany_data)
summary(Germany_data)
```

## Number of participants
```{r, echo = FALSE}
# table(Germany_data[which(complete.cases(Germany_data$q_0000)==TRUE),]$q_0000)
countryanswers <- sort(table(Germany_data$q_0000), decreasing = FALSE)
answering_countries <- countryanswers[which (countryanswers > 0)]
#delete France false data
answering_countries <- answering_countries[-3]

par(mar=c(2.5,9.5,2,2))
barplot(answering_countries, cex.names=0.9, las=1, main="Number of answers by country", col="cornflowerblue", horiz=TRUE, border=NA)
text(45,6, paste(length(answering_countries), "countries
                Total of answers :", sum(answering_countries),
                 "
                              Mean answers by country: " , round(mean(answering_countries)),"
               
                      Top 4: Romania, France, 
                      Slovenia, Czech Republic"), cex=1.2)
abline(v=mean(answering_countries), lty=2)
text(19, 0.7,"Mean", font=2)
```

## Gender
```{r, echo=TRUE, fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
gender <-table(Germany_data$q_0001)
#prop.table(gender)
pie(gender, main="Gender of participants in Europe reponses")
```

##Age
```{r, echo=TRUE,  fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
#error max = 1969 !!!
age_Europe <- Germany_data$q_0002[which(Germany_data$q_0002<1969)]
hist(age_Europe, col="cornflowerblue",
     xlab="Age", ylab="Number", main="Age distribution", freq=TRUE, border=NA, breaks=25 )
text(47, 40, paste("Mean age:", round(mean(age_Europe),0), "years"))
abline(v=mean(age_Europe), lty=2)
```

## Year in Training
```{r, echo=TRUE}
YoT <- table(Germany_data$q_0003)
names(YoT)<- c(1:8, "> 8", "TF")
par(mfrow=c(1,1), mar=c(3,3,2,2))
barplot(YoT, main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number", cex.names=1)
```
>TF for training finished

## Are you receiving personal psychotherapy or have you received it in the past?
```{r, echo=TRUE}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
Germany_data[, 7] <- as.numeric(Germany_data[, 7])
attributes(Germany_data)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
Germany_data[, 7] <- factor(Germany_data[, 7], levels=c(1,2),labels=c("Yes","No"))
names(Germany_data)[7] <- "q_0004"
#table(Germany_data$q_0004)
par(mar=c(3,3,2,2))
prop.table(table(Germany_data$q_0004))
pie(table(Germany_data$q_0004), main = "Receiving personal psychotherapy (present or past)")
```

```{r, echo=TRUE}
## I am undertaking training in Psychotherapy within my training programme in Psychiatry
## NO DATA ????
#tab <- table(Germany_data$q_0005_S05A1)
#length(tab)
#pie(table(Germany_data$q_0005_S05A1), main="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r, echo=TRUE}
table(Germany_data$q_0005_S05A2)
prop.table(table(Germany_data$q_0005_S05A2))
pie(table(Germany_data$q_0005_S05A2), main="Training in psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r, echo=TRUE}
#table(Germany_data$q_0005_S05A3)
pie(table(Germany_data$q_0005_S05A3),  main="I am not undertaking any training in Psychotherapy")
```

> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r, echo=TRUE}
#table(Germany_data$q_0005_S05A4)
prop.table(table(Germany_data$q_0005_S05A4))
pie(table(Germany_data$q_0005_S05A4), main="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality
```{r, echo=TRUE}
table(is.na(Germany_data$q_0006))
prop.table(table(is.na(Germany_data$q_0006)))
pie(table(is.na(Germany_data$q_0006)),main="I am training in some modality of psychotherapy")
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r, echo=TRUE}
table(Germany_data$q_0007)
prop.table(table(Germany_data$q_0007))
pie(table(Germany_data$q_0007), main="Psychotherapy important for the professional identity", col=terrain.colors(3))
```

## Do you want to practise Psychotherapy ?
```{r, echo=TRUE}
#table(Germany_data$q_0008)
prop.table(table(Germany_data$q_0008))
pie(table(Germany_data$q_0008), main="Plan to practise Psychotherapy after training")
```

## Are you interested in this psychotherapy?
```{r, echo=TRUE}
q9df <- Germany_data[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","Not Any","Other"),main="Interested in this therapy", las=1, col=rainbow(6),)
```

##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"
```{r, echo=TRUE, eval=FALSE}

barplot(table(Germany_data$q_0011_SQ001), col="green", main="Theoretical lectures or seminars in psychotherapy", border=NA)
abline(v=1.3, lwd=3)
text(0.6,215, "UEMS <", adj = c(0, -.1), font=2)
```
> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r, echo=TRUE, eval=FALSE}
#barplot(PWS, col="blue", main="Conducting Psychotherapy without supervision", border=NA)
```

```{r, echo=TRUE, eval=FALSE}

barplot(table(Germany_data$q_0011_SQ003), col="yellow", main="Conducting Psychotherapy under supervision")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Germany_data$q_0011_SQ004), col="orange", main="Personal Psychotherapy")
```

```{r, echo=TRUE}
TL <- table(Germany_data$q_0011_SQ001)
PNS <- table(Germany_data$q_0011_SQ002)
PWS <- table(Germany_data$q_0011_SQ003)
PP <- table(Germany_data$q_0011_SQ004)

mandatory <- cbind(prop.table(TL),prop.table(PNS), prop.table(PWS), prop.table(PP))
par(mar=c(3,3,5,9), xpd=TRUE)
barplot(mandatory, col=terrain.colors(3), names=c("Theorical lectures", "Psychotherapy 
without supervision", "Psychotherapy 
with supervision", "Personnal 
psychotherapy"), cex.name=1, main="The following experience in psychotherapy 
is a mandatory part of my training in Psychiatry", cex.main=1.5)
legend("topright", inset=c(-0.27,0), legend = c("Yes", "No", "Uncertain"), fill=(terrain.colors(3)), cex=0.9, bty="n")
```

```{r, echo=TRUE}
qualified <- prop.table(table(Germany_data$q_0012))
par(mar=c(4,5,5,3))
barplot(qualified, col=terrain.colors(3) , main="Are you qualified 
        to practice psychotherapy after your training ?", las=1, ylab="Frequency", cex.names=1.4, cex.lab=1.4, cex.main=1.4)
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
```{r, echo=TRUE}
#table(Germany_data$q_0013)
```

## How many hours of supervision
```{r, echo=TRUE}
par(mar=c(5,5,3,3), xpd=FALSE)
hist(Germany_data$q_0014_SQ001[which(is.na(Germany_data$q_0014_SQ001)==FALSE)], col="cornflowerblue", xlim=c(0,10), main ="Repartition of the hours of supervision in Europe", ylab="Frequency", xlab= "Hours by month", lwd=3, las=1, cex.lab=1.3, cex.main=1.3, breaks=10, freq=FALSE)
text(3.5, 0.30, paste(" Mean :",round(mean(Germany_data$q_0014_SQ001[which(is.na(Germany_data$q_0014_SQ001)==FALSE)]),2), "h"), font=2, cex=1.5, col="cornflowerblue")
text(3.3, 0.20, paste(" Median :", (median(Germany_data$q_0014_SQ001[which(is.na(Germany_data$q_0014_SQ001)==FALSE)])), "h"), font=2, cex=1.5, col="cornflowerblue")
abline(v=mean(Germany_data$q_0014_SQ001[which(is.na(Germany_data$q_0014_SQ001)==FALSE)]), col="cornflowerblue", lwd=3)
abline(v=1.7, lty=3, lwd=3)
text(3.5,0.40, "UEMS > 1.7h", font=2, cex=1.5)
#lines(density(Germany_data$q_0014_SQ002[which(is.na(Germany_data$q_0014_SQ002)==FALSE)]), col=rainbow(5)[2])
#lines(density(Germany_data$q_0014_SQ003[which(is.na(Germany_data$q_0014_SQ003)==FALSE)]), col=rainbow(5)[3])
#lines(density(Germany_data$q_0014_SQ004[which(is.na(Germany_data$q_0014_SQ004)==FALSE)]), col=rainbow(5)[4])
#lines(density(Germany_data$q_0014_SQ005[which(is.na(Germany_data$q_0014_SQ005)==FALSE)]), col=rainbow(5)[5])
#legend("topright", legend=c("Hours of Psychotherapy supervision per month", "Small group supervision (3 - 5 people)", "Large group supervision (more than 5 people)", "Generic Balint group", "Other form of supervision"), fill = rainbow(4), cex=0.7)
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r, echo=TRUE, eval=FALSE}
hist(Germany_data$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(2.5,300, "> UEMS", font=2)
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Germany_data$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Germany_data$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Germany_data$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r, echo=TRUE, eval=FALSE}
hist(Germany_data$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

table(Germany_data$q_0015)

##Who pays?
```{r, echo=TRUE, eval=FALSE}
barplot(table(Germany_data$q_0016_SQ002), col="light blue",
        xlab="Who pays for this component of Psychotherapy experience?",
        names=c("I pay", "State pays", "I don't have", "Free"),
        main="Supervision - individual")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Germany_data$q_0016_SQ003), col="light blue",
        main="Supervision - group",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Germany_data$q_0016_SQ004), col="light blue",
        main="Balint groups",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Germany_data$q_0016_SQ005), col="light blue",
        main="Sessions with patient(s)",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Germany_data$q_0016_SQ006), col="light blue",
        main="Self-experience",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays")
```

```{r, echo=TRUE}
par(mar=c(6,2.5,3,9), xpd=TRUE)
payTL <- table(Germany_data$q_0016_SQ001)
paySI <- table(Germany_data$q_0016_SQ002)
paySG <- table(Germany_data$q_0016_SQ003)
payBG <- table(Germany_data$q_0016_SQ004)
paySP <- table(Germany_data$q_0016_SQ005)
paySE <- table(Germany_data$q_0016_SQ006)
pay <- cbind(prop.table(payTL), prop.table(paySI), prop.table(paySG), prop.table(payBG), prop.table(paySP), prop.table(paySE))
barplot(pay, col=terrain.colors(4),
        main="Who pays?",
        names=c("Theorectical 
lectures", "Supervision 
indiv.", "Supervision 
group", "Balint
groups ", "Sessions
with patient(s)", "Self
experience"), cex.name=0.8, las=2)
legend("topright", inset=c(-0.38,0), legend = c("I pay", "The state pays", "I don't have", "Free"), fill=(terrain.colors(4)), cex=0.9, bty="n")
```

## Would you train for free?
```{r, echo=TRUE}
prop.table(table(Germany_data$q_0017))
par(mar=c(3,2,2,2))
pie(table(Germany_data$q_0017),
    main="Motivated to train in Psychotherapy for free?")
text(-0.2,-0.95, "UEMS recommendations states that psychotherapy training 
of trainees should be funded publicly and free for trainees.")
```

## How much would you invest in psychotherapy training ?
```{r, echo=TRUE}
par(mar=c(6,2.5,3,2), xpd=FALSE)
hist(Germany_data$q_0018[which(Germany_data$q_0018<100)], col="light green",
     main="% of annual salary for psychotherapy training",
     xlab="Percentage of your annual salary do you intend to spend on funding your psychotherapy training In the next 12 months?", cex.lab=1.1, cex.main=1.7)
abline(v=mean(Germany_data$q_0018[which(Germany_data$q_0018<100)]), lwd=2, lty=2)
text(20, 200, paste("Mean :",round( mean(Germany_data$q_0018[which(Germany_data$q_0018<100)])), " %"), font=2, cex=1.3)
text(20, 150, paste("Median :" , median(Germany_data$q_0018[which(Germany_data$q_0018<100)]), " %"), font=2, cex=1.3)
```

## Satisfaction group
```{r, echo=TRUE}
# make auxiliary table to hold our likert Germany_data
sat1<-Germany_data[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(Germany_data$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- Germany_data[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## UEMS recommendations awareness
```{r, echo=TRUE}
# and same with the
uems2 <- Germany_data[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

# Gerany results
```{r,include = FALSE}
dim(Greece_data)
str(Greece_data)
summary(Greece_data)
```

## Number of participants
```{r, echo = FALSE}
# table(Greece_data[which(complete.cases(Greece_data$q_0000)==TRUE),]$q_0000)
countryanswers <- sort(table(Greece_data$q_0000), decreasing = FALSE)
answering_countries <- countryanswers[which (countryanswers > 0)]
#delete France false data
answering_countries <- answering_countries[-3]

par(mar=c(2.5,9.5,2,2))
barplot(answering_countries, cex.names=0.9, las=1, main="Number of answers by country", col="cornflowerblue", horiz=TRUE, border=NA)
text(45,6, paste(length(answering_countries), "countries
                Total of answers :", sum(answering_countries),
                 "
                              Mean answers by country: " , round(mean(answering_countries)),"
               
                      Top 4: Romania, France, 
                      Slovenia, Czech Republic"), cex=1.2)
abline(v=mean(answering_countries), lty=2)
text(19, 0.7,"Mean", font=2)
```

## Gender
```{r, echo=TRUE, fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
gender <-table(Greece_data$q_0001)
#prop.table(gender)
pie(gender, main="Gender of participants in Europe reponses")
```

##Age
```{r, echo=TRUE,  fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
#error max = 1969 !!!
age_Europe <- Greece_data$q_0002[which(Greece_data$q_0002<1969)]
hist(age_Europe, col="cornflowerblue",
     xlab="Age", ylab="Number", main="Age distribution", freq=TRUE, border=NA, breaks=25 )
text(47, 40, paste("Mean age:", round(mean(age_Europe),0), "years"))
abline(v=mean(age_Europe), lty=2)
```

## Year in Training
```{r, echo=TRUE}
YoT <- table(Greece_data$q_0003)
names(YoT)<- c(1:8, "> 8", "TF")
par(mfrow=c(1,1), mar=c(3,3,2,2))
barplot(YoT, main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number", cex.names=1)
```
>TF for training finished

## Are you receiving personal psychotherapy or have you received it in the past?
```{r, echo=TRUE}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
Greece_data[, 7] <- as.numeric(Greece_data[, 7])
attributes(Greece_data)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
Greece_data[, 7] <- factor(Greece_data[, 7], levels=c(1,2),labels=c("Yes","No"))
names(Greece_data)[7] <- "q_0004"
#table(Greece_data$q_0004)
par(mar=c(3,3,2,2))
prop.table(table(Greece_data$q_0004))
pie(table(Greece_data$q_0004), main = "Receiving personal psychotherapy (present or past)")
```

```{r, echo=TRUE}
## I am undertaking training in Psychotherapy within my training programme in Psychiatry
## NO DATA ????
#tab <- table(Greece_data$q_0005_S05A1)
#length(tab)
#pie(table(Greece_data$q_0005_S05A1), main="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r, echo=TRUE}
table(Greece_data$q_0005_S05A2)
prop.table(table(Greece_data$q_0005_S05A2))
pie(table(Greece_data$q_0005_S05A2), main="Training in psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r, echo=TRUE}
#table(Greece_data$q_0005_S05A3)
pie(table(Greece_data$q_0005_S05A3),  main="I am not undertaking any training in Psychotherapy")
```

> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r, echo=TRUE}
#table(Greece_data$q_0005_S05A4)
prop.table(table(Greece_data$q_0005_S05A4))
pie(table(Greece_data$q_0005_S05A4), main="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality
```{r, echo=TRUE}
table(is.na(Greece_data$q_0006))
prop.table(table(is.na(Greece_data$q_0006)))
pie(table(is.na(Greece_data$q_0006)),main="I am training in some modality of psychotherapy")
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r, echo=TRUE}
table(Greece_data$q_0007)
prop.table(table(Greece_data$q_0007))
pie(table(Greece_data$q_0007), main="Psychotherapy important for the professional identity", col=terrain.colors(3))
```

## Do you want to practise Psychotherapy ?
```{r, echo=TRUE}
#table(Greece_data$q_0008)
prop.table(table(Greece_data$q_0008))
pie(table(Greece_data$q_0008), main="Plan to practise Psychotherapy after training")
```

## Are you interested in this psychotherapy?
```{r, echo=TRUE}
q9df <- Greece_data[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","Not Any","Other"),main="Interested in this therapy", las=1, col=rainbow(6),)
```

##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"
```{r, echo=TRUE, eval=FALSE}

barplot(table(Greece_data$q_0011_SQ001), col="green", main="Theoretical lectures or seminars in psychotherapy", border=NA)
abline(v=1.3, lwd=3)
text(0.6,215, "UEMS <", adj = c(0, -.1), font=2)
```
> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r, echo=TRUE, eval=FALSE}
#barplot(PWS, col="blue", main="Conducting Psychotherapy without supervision", border=NA)
```

```{r, echo=TRUE, eval=FALSE}

barplot(table(Greece_data$q_0011_SQ003), col="yellow", main="Conducting Psychotherapy under supervision")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Greece_data$q_0011_SQ004), col="orange", main="Personal Psychotherapy")
```

```{r, echo=TRUE}
TL <- table(Greece_data$q_0011_SQ001)
PNS <- table(Greece_data$q_0011_SQ002)
PWS <- table(Greece_data$q_0011_SQ003)
PP <- table(Greece_data$q_0011_SQ004)

mandatory <- cbind(prop.table(TL),prop.table(PNS), prop.table(PWS), prop.table(PP))
par(mar=c(3,3,5,9), xpd=TRUE)
barplot(mandatory, col=terrain.colors(3), names=c("Theorical lectures", "Psychotherapy 
without supervision", "Psychotherapy 
with supervision", "Personnal 
psychotherapy"), cex.name=1, main="The following experience in psychotherapy 
is a mandatory part of my training in Psychiatry", cex.main=1.5)
legend("topright", inset=c(-0.27,0), legend = c("Yes", "No", "Uncertain"), fill=(terrain.colors(3)), cex=0.9, bty="n")
```

```{r, echo=TRUE}
qualified <- prop.table(table(Greece_data$q_0012))
par(mar=c(4,5,5,3))
barplot(qualified, col=terrain.colors(3) , main="Are you qualified 
        to practice psychotherapy after your training ?", las=1, ylab="Frequency", cex.names=1.4, cex.lab=1.4, cex.main=1.4)
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
```{r, echo=TRUE}
#table(Greece_data$q_0013)
```

## How many hours of supervision
```{r, echo=TRUE}
par(mar=c(5,5,3,3), xpd=FALSE)
hist(Greece_data$q_0014_SQ001[which(is.na(Greece_data$q_0014_SQ001)==FALSE)], col="cornflowerblue", xlim=c(0,10), main ="Repartition of the hours of supervision in Europe", ylab="Frequency", xlab= "Hours by month", lwd=3, las=1, cex.lab=1.3, cex.main=1.3, breaks=10, freq=FALSE)
text(3.5, 0.30, paste(" Mean :",round(mean(Greece_data$q_0014_SQ001[which(is.na(Greece_data$q_0014_SQ001)==FALSE)]),2), "h"), font=2, cex=1.5, col="cornflowerblue")
text(3.3, 0.20, paste(" Median :", (median(Greece_data$q_0014_SQ001[which(is.na(Greece_data$q_0014_SQ001)==FALSE)])), "h"), font=2, cex=1.5, col="cornflowerblue")
abline(v=mean(Greece_data$q_0014_SQ001[which(is.na(Greece_data$q_0014_SQ001)==FALSE)]), col="cornflowerblue", lwd=3)
abline(v=1.7, lty=3, lwd=3)
text(3.5,0.40, "UEMS > 1.7h", font=2, cex=1.5)
#lines(density(Greece_data$q_0014_SQ002[which(is.na(Greece_data$q_0014_SQ002)==FALSE)]), col=rainbow(5)[2])
#lines(density(Greece_data$q_0014_SQ003[which(is.na(Greece_data$q_0014_SQ003)==FALSE)]), col=rainbow(5)[3])
#lines(density(Greece_data$q_0014_SQ004[which(is.na(Greece_data$q_0014_SQ004)==FALSE)]), col=rainbow(5)[4])
#lines(density(Greece_data$q_0014_SQ005[which(is.na(Greece_data$q_0014_SQ005)==FALSE)]), col=rainbow(5)[5])
#legend("topright", legend=c("Hours of Psychotherapy supervision per month", "Small group supervision (3 - 5 people)", "Large group supervision (more than 5 people)", "Generic Balint group", "Other form of supervision"), fill = rainbow(4), cex=0.7)
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r, echo=TRUE, eval=FALSE}
hist(Greece_data$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(2.5,300, "> UEMS", font=2)
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Greece_data$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Greece_data$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Greece_data$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r, echo=TRUE, eval=FALSE}
hist(Greece_data$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

table(Greece_data$q_0015)

##Who pays?
```{r, echo=TRUE, eval=FALSE}
barplot(table(Greece_data$q_0016_SQ002), col="light blue",
        xlab="Who pays for this component of Psychotherapy experience?",
        names=c("I pay", "State pays", "I don't have", "Free"),
        main="Supervision - individual")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Greece_data$q_0016_SQ003), col="light blue",
        main="Supervision - group",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Greece_data$q_0016_SQ004), col="light blue",
        main="Balint groups",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Greece_data$q_0016_SQ005), col="light blue",
        main="Sessions with patient(s)",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Greece_data$q_0016_SQ006), col="light blue",
        main="Self-experience",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays")
```

```{r, echo=TRUE}
par(mar=c(6,2.5,3,9), xpd=TRUE)
payTL <- table(Greece_data$q_0016_SQ001)
paySI <- table(Greece_data$q_0016_SQ002)
paySG <- table(Greece_data$q_0016_SQ003)
payBG <- table(Greece_data$q_0016_SQ004)
paySP <- table(Greece_data$q_0016_SQ005)
paySE <- table(Greece_data$q_0016_SQ006)
pay <- cbind(prop.table(payTL), prop.table(paySI), prop.table(paySG), prop.table(payBG), prop.table(paySP), prop.table(paySE))
barplot(pay, col=terrain.colors(4),
        main="Who pays?",
        names=c("Theorectical 
lectures", "Supervision 
indiv.", "Supervision 
group", "Balint
groups ", "Sessions
with patient(s)", "Self
experience"), cex.name=0.8, las=2)
legend("topright", inset=c(-0.38,0), legend = c("I pay", "The state pays", "I don't have", "Free"), fill=(terrain.colors(4)), cex=0.9, bty="n")
```

## Would you train for free?
```{r, echo=TRUE}
prop.table(table(Greece_data$q_0017))
par(mar=c(3,2,2,2))
pie(table(Greece_data$q_0017),
    main="Motivated to train in Psychotherapy for free?")
text(-0.2,-0.95, "UEMS recommendations states that psychotherapy training 
of trainees should be funded publicly and free for trainees.")
```

## How much would you invest in psychotherapy training ?
```{r, echo=TRUE}
par(mar=c(6,2.5,3,2), xpd=FALSE)
hist(Greece_data$q_0018[which(Greece_data$q_0018<100)], col="light green",
     main="% of annual salary for psychotherapy training",
     xlab="Percentage of your annual salary do you intend to spend on funding your psychotherapy training In the next 12 months?", cex.lab=1.1, cex.main=1.7)
abline(v=mean(Greece_data$q_0018[which(Greece_data$q_0018<100)]), lwd=2, lty=2)
text(20, 200, paste("Mean :",round( mean(Greece_data$q_0018[which(Greece_data$q_0018<100)])), " %"), font=2, cex=1.3)
text(20, 150, paste("Median :" , median(Greece_data$q_0018[which(Greece_data$q_0018<100)]), " %"), font=2, cex=1.3)
```

## Satisfaction group
```{r, echo=TRUE}
# make auxiliary table to hold our likert Greece_data
sat1<-Greece_data[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(Greece_data$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- Greece_data[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## UEMS recommendations awareness
```{r, echo=TRUE}
# and same with the
uems2 <- Greece_data[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

# Israel results
```{r,include = FALSE}
dim(Israel_data)
str(Israel_data)
summary(Israel_data)
```

## Number of participants
```{r, echo = FALSE}
# table(Israel_data[which(complete.cases(Israel_data$q_0000)==TRUE),]$q_0000)
countryanswers <- sort(table(Israel_data$q_0000), decreasing = FALSE)
answering_countries <- countryanswers[which (countryanswers > 0)]
#delete France false data
answering_countries <- answering_countries[-3]

par(mar=c(2.5,9.5,2,2))
barplot(answering_countries, cex.names=0.9, las=1, main="Number of answers by country", col="cornflowerblue", horiz=TRUE, border=NA)
text(45,6, paste(length(answering_countries), "countries
                Total of answers :", sum(answering_countries),
                 "
                              Mean answers by country: " , round(mean(answering_countries)),"
               
                      Top 4: Romania, France, 
                      Slovenia, Czech Republic"), cex=1.2)
abline(v=mean(answering_countries), lty=2)
text(19, 0.7,"Mean", font=2)
```

## Gender
```{r, echo=TRUE, fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
gender <-table(Israel_data$q_0001)
#prop.table(gender)
pie(gender, main="Gender of participants in Europe reponses")
```

##Age
```{r, echo=TRUE,  fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
#error max = 1969 !!!
age_Europe <- Israel_data$q_0002[which(Israel_data$q_0002<1969)]
hist(age_Europe, col="cornflowerblue",
     xlab="Age", ylab="Number", main="Age distribution", freq=TRUE, border=NA, breaks=25 )
text(47, 40, paste("Mean age:", round(mean(age_Europe),0), "years"))
abline(v=mean(age_Europe), lty=2)
```

## Year in Training
```{r, echo=TRUE}
YoT <- table(Israel_data$q_0003)
names(YoT)<- c(1:8, "> 8", "TF")
par(mfrow=c(1,1), mar=c(3,3,2,2))
barplot(YoT, main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number", cex.names=1)
```
>TF for training finished

## Are you receiving personal psychotherapy or have you received it in the past?
```{r, echo=TRUE}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
Israel_data[, 7] <- as.numeric(Israel_data[, 7])
attributes(Israel_data)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
Israel_data[, 7] <- factor(Israel_data[, 7], levels=c(1,2),labels=c("Yes","No"))
names(Israel_data)[7] <- "q_0004"
#table(Israel_data$q_0004)
par(mar=c(3,3,2,2))
prop.table(table(Israel_data$q_0004))
pie(table(Israel_data$q_0004), main = "Receiving personal psychotherapy (present or past)")
```

```{r, echo=TRUE}
## I am undertaking training in Psychotherapy within my training programme in Psychiatry
## NO DATA ????
#tab <- table(Israel_data$q_0005_S05A1)
#length(tab)
#pie(table(Israel_data$q_0005_S05A1), main="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r, echo=TRUE}
table(Israel_data$q_0005_S05A2)
prop.table(table(Israel_data$q_0005_S05A2))
pie(table(Israel_data$q_0005_S05A2), main="Training in psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r, echo=TRUE}
#table(Israel_data$q_0005_S05A3)
pie(table(Israel_data$q_0005_S05A3),  main="I am not undertaking any training in Psychotherapy")
```

> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r, echo=TRUE}
#table(Israel_data$q_0005_S05A4)
prop.table(table(Israel_data$q_0005_S05A4))
pie(table(Israel_data$q_0005_S05A4), main="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality
```{r, echo=TRUE}
table(is.na(Israel_data$q_0006))
prop.table(table(is.na(Israel_data$q_0006)))
pie(table(is.na(Israel_data$q_0006)),main="I am training in some modality of psychotherapy")
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r, echo=TRUE}
table(Israel_data$q_0007)
prop.table(table(Israel_data$q_0007))
pie(table(Israel_data$q_0007), main="Psychotherapy important for the professional identity", col=terrain.colors(3))
```

## Do you want to practise Psychotherapy ?
```{r, echo=TRUE}
#table(Israel_data$q_0008)
prop.table(table(Israel_data$q_0008))
pie(table(Israel_data$q_0008), main="Plan to practise Psychotherapy after training")
```

## Are you interested in this psychotherapy?
```{r, echo=TRUE}
q9df <- Israel_data[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","Not Any","Other"),main="Interested in this therapy", las=1, col=rainbow(6),)
```

##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"
```{r, echo=TRUE, eval=FALSE}

barplot(table(Israel_data$q_0011_SQ001), col="green", main="Theoretical lectures or seminars in psychotherapy", border=NA)
abline(v=1.3, lwd=3)
text(0.6,215, "UEMS <", adj = c(0, -.1), font=2)
```
> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r, echo=TRUE, eval=FALSE}
#barplot(PWS, col="blue", main="Conducting Psychotherapy without supervision", border=NA)
```

```{r, echo=TRUE, eval=FALSE}

barplot(table(Israel_data$q_0011_SQ003), col="yellow", main="Conducting Psychotherapy under supervision")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Israel_data$q_0011_SQ004), col="orange", main="Personal Psychotherapy")
```

```{r, echo=TRUE}
TL <- table(Israel_data$q_0011_SQ001)
PNS <- table(Israel_data$q_0011_SQ002)
PWS <- table(Israel_data$q_0011_SQ003)
PP <- table(Israel_data$q_0011_SQ004)

mandatory <- cbind(prop.table(TL),prop.table(PNS), prop.table(PWS), prop.table(PP))
par(mar=c(3,3,5,9), xpd=TRUE)
barplot(mandatory, col=terrain.colors(3), names=c("Theorical lectures", "Psychotherapy 
without supervision", "Psychotherapy 
with supervision", "Personnal 
psychotherapy"), cex.name=1, main="The following experience in psychotherapy 
is a mandatory part of my training in Psychiatry", cex.main=1.5)
legend("topright", inset=c(-0.27,0), legend = c("Yes", "No", "Uncertain"), fill=(terrain.colors(3)), cex=0.9, bty="n")
```

```{r, echo=TRUE}
qualified <- prop.table(table(Israel_data$q_0012))
par(mar=c(4,5,5,3))
barplot(qualified, col=terrain.colors(3) , main="Are you qualified 
        to practice psychotherapy after your training ?", las=1, ylab="Frequency", cex.names=1.4, cex.lab=1.4, cex.main=1.4)
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
```{r, echo=TRUE}
#table(Israel_data$q_0013)
```

## How many hours of supervision
```{r, echo=TRUE}
par(mar=c(5,5,3,3), xpd=FALSE)
hist(Israel_data$q_0014_SQ001[which(is.na(Israel_data$q_0014_SQ001)==FALSE)], col="cornflowerblue", xlim=c(0,10), main ="Repartition of the hours of supervision in Europe", ylab="Frequency", xlab= "Hours by month", lwd=3, las=1, cex.lab=1.3, cex.main=1.3, breaks=10, freq=FALSE)
text(3.5, 0.30, paste(" Mean :",round(mean(Israel_data$q_0014_SQ001[which(is.na(Israel_data$q_0014_SQ001)==FALSE)]),2), "h"), font=2, cex=1.5, col="cornflowerblue")
text(3.3, 0.20, paste(" Median :", (median(Israel_data$q_0014_SQ001[which(is.na(Israel_data$q_0014_SQ001)==FALSE)])), "h"), font=2, cex=1.5, col="cornflowerblue")
abline(v=mean(Israel_data$q_0014_SQ001[which(is.na(Israel_data$q_0014_SQ001)==FALSE)]), col="cornflowerblue", lwd=3)
abline(v=1.7, lty=3, lwd=3)
text(3.5,0.40, "UEMS > 1.7h", font=2, cex=1.5)
#lines(density(Israel_data$q_0014_SQ002[which(is.na(Israel_data$q_0014_SQ002)==FALSE)]), col=rainbow(5)[2])
#lines(density(Israel_data$q_0014_SQ003[which(is.na(Israel_data$q_0014_SQ003)==FALSE)]), col=rainbow(5)[3])
#lines(density(Israel_data$q_0014_SQ004[which(is.na(Israel_data$q_0014_SQ004)==FALSE)]), col=rainbow(5)[4])
#lines(density(Israel_data$q_0014_SQ005[which(is.na(Israel_data$q_0014_SQ005)==FALSE)]), col=rainbow(5)[5])
#legend("topright", legend=c("Hours of Psychotherapy supervision per month", "Small group supervision (3 - 5 people)", "Large group supervision (more than 5 people)", "Generic Balint group", "Other form of supervision"), fill = rainbow(4), cex=0.7)
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r, echo=TRUE, eval=FALSE}
hist(Israel_data$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(2.5,300, "> UEMS", font=2)
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Israel_data$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Israel_data$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Israel_data$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r, echo=TRUE, eval=FALSE}
hist(Israel_data$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

table(Israel_data$q_0015)

##Who pays?
```{r, echo=TRUE, eval=FALSE}
barplot(table(Israel_data$q_0016_SQ002), col="light blue",
        xlab="Who pays for this component of Psychotherapy experience?",
        names=c("I pay", "State pays", "I don't have", "Free"),
        main="Supervision - individual")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Israel_data$q_0016_SQ003), col="light blue",
        main="Supervision - group",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Israel_data$q_0016_SQ004), col="light blue",
        main="Balint groups",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Israel_data$q_0016_SQ005), col="light blue",
        main="Sessions with patient(s)",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Israel_data$q_0016_SQ006), col="light blue",
        main="Self-experience",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays")
```

```{r, echo=TRUE}
par(mar=c(6,2.5,3,9), xpd=TRUE)
payTL <- table(Israel_data$q_0016_SQ001)
paySI <- table(Israel_data$q_0016_SQ002)
paySG <- table(Israel_data$q_0016_SQ003)
payBG <- table(Israel_data$q_0016_SQ004)
paySP <- table(Israel_data$q_0016_SQ005)
paySE <- table(Israel_data$q_0016_SQ006)
pay <- cbind(prop.table(payTL), prop.table(paySI), prop.table(paySG), prop.table(payBG), prop.table(paySP), prop.table(paySE))
barplot(pay, col=terrain.colors(4),
        main="Who pays?",
        names=c("Theorectical 
lectures", "Supervision 
indiv.", "Supervision 
group", "Balint
groups ", "Sessions
with patient(s)", "Self
experience"), cex.name=0.8, las=2)
legend("topright", inset=c(-0.38,0), legend = c("I pay", "The state pays", "I don't have", "Free"), fill=(terrain.colors(4)), cex=0.9, bty="n")
```

## Would you train for free?
```{r, echo=TRUE}
prop.table(table(Israel_data$q_0017))
par(mar=c(3,2,2,2))
pie(table(Israel_data$q_0017),
    main="Motivated to train in Psychotherapy for free?")
text(-0.2,-0.95, "UEMS recommendations states that psychotherapy training 
of trainees should be funded publicly and free for trainees.")
```

## How much would you invest in psychotherapy training ?
```{r, echo=TRUE}
par(mar=c(6,2.5,3,2), xpd=FALSE)
hist(Israel_data$q_0018[which(Israel_data$q_0018<100)], col="light green",
     main="% of annual salary for psychotherapy training",
     xlab="Percentage of your annual salary do you intend to spend on funding your psychotherapy training In the next 12 months?", cex.lab=1.1, cex.main=1.7)
abline(v=mean(Israel_data$q_0018[which(Israel_data$q_0018<100)]), lwd=2, lty=2)
text(20, 200, paste("Mean :",round( mean(Israel_data$q_0018[which(Israel_data$q_0018<100)])), " %"), font=2, cex=1.3)
text(20, 150, paste("Median :" , median(Israel_data$q_0018[which(Israel_data$q_0018<100)]), " %"), font=2, cex=1.3)
```

## Satisfaction group
```{r, echo=TRUE}
# make auxiliary table to hold our likert Israel_data
sat1<-Israel_data[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(Israel_data$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- Israel_data[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## UEMS recommendations awareness
```{r, echo=TRUE}
# and same with the
uems2 <- Israel_data[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

# Italy results
```{r,include = FALSE}
dim(Italy_data)
str(Italy_data)
summary(Italy_data)
```

## Number of participants
```{r, echo = FALSE}
# table(Italy_data[which(complete.cases(Italy_data$q_0000)==TRUE),]$q_0000)
countryanswers <- sort(table(Italy_data$q_0000), decreasing = FALSE)
answering_countries <- countryanswers[which (countryanswers > 0)]
#delete France false data
answering_countries <- answering_countries[-3]

par(mar=c(2.5,9.5,2,2))
barplot(answering_countries, cex.names=0.9, las=1, main="Number of answers by country", col="cornflowerblue", horiz=TRUE, border=NA)
text(45,6, paste(length(answering_countries), "countries
                Total of answers :", sum(answering_countries),
                 "
                              Mean answers by country: " , round(mean(answering_countries)),"
               
                      Top 4: Romania, France, 
                      Slovenia, Czech Republic"), cex=1.2)
abline(v=mean(answering_countries), lty=2)
text(19, 0.7,"Mean", font=2)
```

## Gender
```{r, echo=TRUE, fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
gender <-table(Italy_data$q_0001)
#prop.table(gender)
pie(gender, main="Gender of participants in Europe reponses")
```

##Age
```{r, echo=TRUE,  fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
#error max = 1969 !!!
age_Europe <- Italy_data$q_0002[which(Italy_data$q_0002<1969)]
hist(age_Europe, col="cornflowerblue",
     xlab="Age", ylab="Number", main="Age distribution", freq=TRUE, border=NA, breaks=25 )
text(47, 40, paste("Mean age:", round(mean(age_Europe),0), "years"))
abline(v=mean(age_Europe), lty=2)
```

## Year in Training
```{r, echo=TRUE}
YoT <- table(Italy_data$q_0003)
names(YoT)<- c(1:8, "> 8", "TF")
par(mfrow=c(1,1), mar=c(3,3,2,2))
barplot(YoT, main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number", cex.names=1)
```
>TF for training finished

## Are you receiving personal psychotherapy or have you received it in the past?
```{r, echo=TRUE}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
Italy_data[, 7] <- as.numeric(Italy_data[, 7])
attributes(Italy_data)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
Italy_data[, 7] <- factor(Italy_data[, 7], levels=c(1,2),labels=c("Yes","No"))
names(Italy_data)[7] <- "q_0004"
#table(Italy_data$q_0004)
par(mar=c(3,3,2,2))
prop.table(table(Italy_data$q_0004))
pie(table(Italy_data$q_0004), main = "Receiving personal psychotherapy (present or past)")
```

```{r, echo=TRUE}
## I am undertaking training in Psychotherapy within my training programme in Psychiatry
## NO DATA ????
#tab <- table(Italy_data$q_0005_S05A1)
#length(tab)
#pie(table(Italy_data$q_0005_S05A1), main="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r, echo=TRUE}
table(Italy_data$q_0005_S05A2)
prop.table(table(Italy_data$q_0005_S05A2))
pie(table(Italy_data$q_0005_S05A2), main="Training in psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r, echo=TRUE}
#table(Italy_data$q_0005_S05A3)
pie(table(Italy_data$q_0005_S05A3),  main="I am not undertaking any training in Psychotherapy")
```

> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r, echo=TRUE}
#table(Italy_data$q_0005_S05A4)
prop.table(table(Italy_data$q_0005_S05A4))
pie(table(Italy_data$q_0005_S05A4), main="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality
```{r, echo=TRUE}
table(is.na(Italy_data$q_0006))
prop.table(table(is.na(Italy_data$q_0006)))
pie(table(is.na(Italy_data$q_0006)),main="I am training in some modality of psychotherapy")
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r, echo=TRUE}
table(Italy_data$q_0007)
prop.table(table(Italy_data$q_0007))
pie(table(Italy_data$q_0007), main="Psychotherapy important for the professional identity", col=terrain.colors(3))
```

## Do you want to practise Psychotherapy ?
```{r, echo=TRUE}
#table(Italy_data$q_0008)
prop.table(table(Italy_data$q_0008))
pie(table(Italy_data$q_0008), main="Plan to practise Psychotherapy after training")
```

## Are you interested in this psychotherapy?
```{r, echo=TRUE}
q9df <- Italy_data[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","Not Any","Other"),main="Interested in this therapy", las=1, col=rainbow(6),)
```

##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"
```{r, echo=TRUE, eval=FALSE}

barplot(table(Italy_data$q_0011_SQ001), col="green", main="Theoretical lectures or seminars in psychotherapy", border=NA)
abline(v=1.3, lwd=3)
text(0.6,215, "UEMS <", adj = c(0, -.1), font=2)
```
> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r, echo=TRUE, eval=FALSE}
#barplot(PWS, col="blue", main="Conducting Psychotherapy without supervision", border=NA)
```

```{r, echo=TRUE, eval=FALSE}

barplot(table(Italy_data$q_0011_SQ003), col="yellow", main="Conducting Psychotherapy under supervision")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Italy_data$q_0011_SQ004), col="orange", main="Personal Psychotherapy")
```

```{r, echo=TRUE}
TL <- table(Italy_data$q_0011_SQ001)
PNS <- table(Italy_data$q_0011_SQ002)
PWS <- table(Italy_data$q_0011_SQ003)
PP <- table(Italy_data$q_0011_SQ004)

mandatory <- cbind(prop.table(TL),prop.table(PNS), prop.table(PWS), prop.table(PP))
par(mar=c(3,3,5,9), xpd=TRUE)
barplot(mandatory, col=terrain.colors(3), names=c("Theorical lectures", "Psychotherapy 
without supervision", "Psychotherapy 
with supervision", "Personnal 
psychotherapy"), cex.name=1, main="The following experience in psychotherapy 
is a mandatory part of my training in Psychiatry", cex.main=1.5)
legend("topright", inset=c(-0.27,0), legend = c("Yes", "No", "Uncertain"), fill=(terrain.colors(3)), cex=0.9, bty="n")
```

```{r, echo=TRUE}
qualified <- prop.table(table(Italy_data$q_0012))
par(mar=c(4,5,5,3))
barplot(qualified, col=terrain.colors(3) , main="Are you qualified 
        to practice psychotherapy after your training ?", las=1, ylab="Frequency", cex.names=1.4, cex.lab=1.4, cex.main=1.4)
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
```{r, echo=TRUE}
#table(Italy_data$q_0013)
```

## How many hours of supervision
```{r, echo=TRUE}
par(mar=c(5,5,3,3), xpd=FALSE)
hist(Italy_data$q_0014_SQ001[which(is.na(Italy_data$q_0014_SQ001)==FALSE)], col="cornflowerblue", xlim=c(0,10), main ="Repartition of the hours of supervision in Europe", ylab="Frequency", xlab= "Hours by month", lwd=3, las=1, cex.lab=1.3, cex.main=1.3, breaks=10, freq=FALSE)
text(3.5, 0.30, paste(" Mean :",round(mean(Italy_data$q_0014_SQ001[which(is.na(Italy_data$q_0014_SQ001)==FALSE)]),2), "h"), font=2, cex=1.5, col="cornflowerblue")
text(3.3, 0.20, paste(" Median :", (median(Italy_data$q_0014_SQ001[which(is.na(Italy_data$q_0014_SQ001)==FALSE)])), "h"), font=2, cex=1.5, col="cornflowerblue")
abline(v=mean(Italy_data$q_0014_SQ001[which(is.na(Italy_data$q_0014_SQ001)==FALSE)]), col="cornflowerblue", lwd=3)
abline(v=1.7, lty=3, lwd=3)
text(3.5,0.40, "UEMS > 1.7h", font=2, cex=1.5)
#lines(density(Italy_data$q_0014_SQ002[which(is.na(Italy_data$q_0014_SQ002)==FALSE)]), col=rainbow(5)[2])
#lines(density(Italy_data$q_0014_SQ003[which(is.na(Italy_data$q_0014_SQ003)==FALSE)]), col=rainbow(5)[3])
#lines(density(Italy_data$q_0014_SQ004[which(is.na(Italy_data$q_0014_SQ004)==FALSE)]), col=rainbow(5)[4])
#lines(density(Italy_data$q_0014_SQ005[which(is.na(Italy_data$q_0014_SQ005)==FALSE)]), col=rainbow(5)[5])
#legend("topright", legend=c("Hours of Psychotherapy supervision per month", "Small group supervision (3 - 5 people)", "Large group supervision (more than 5 people)", "Generic Balint group", "Other form of supervision"), fill = rainbow(4), cex=0.7)
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r, echo=TRUE, eval=FALSE}
hist(Italy_data$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(2.5,300, "> UEMS", font=2)
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Italy_data$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Italy_data$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Italy_data$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r, echo=TRUE, eval=FALSE}
hist(Italy_data$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

table(Italy_data$q_0015)

##Who pays?
```{r, echo=TRUE, eval=FALSE}
barplot(table(Italy_data$q_0016_SQ002), col="light blue",
        xlab="Who pays for this component of Psychotherapy experience?",
        names=c("I pay", "State pays", "I don't have", "Free"),
        main="Supervision - individual")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Italy_data$q_0016_SQ003), col="light blue",
        main="Supervision - group",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Italy_data$q_0016_SQ004), col="light blue",
        main="Balint groups",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Italy_data$q_0016_SQ005), col="light blue",
        main="Sessions with patient(s)",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Italy_data$q_0016_SQ006), col="light blue",
        main="Self-experience",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays")
```

```{r, echo=TRUE}
par(mar=c(6,2.5,3,9), xpd=TRUE)
payTL <- table(Italy_data$q_0016_SQ001)
paySI <- table(Italy_data$q_0016_SQ002)
paySG <- table(Italy_data$q_0016_SQ003)
payBG <- table(Italy_data$q_0016_SQ004)
paySP <- table(Italy_data$q_0016_SQ005)
paySE <- table(Italy_data$q_0016_SQ006)
pay <- cbind(prop.table(payTL), prop.table(paySI), prop.table(paySG), prop.table(payBG), prop.table(paySP), prop.table(paySE))
barplot(pay, col=terrain.colors(4),
        main="Who pays?",
        names=c("Theorectical 
lectures", "Supervision 
indiv.", "Supervision 
group", "Balint
groups ", "Sessions
with patient(s)", "Self
experience"), cex.name=0.8, las=2)
legend("topright", inset=c(-0.38,0), legend = c("I pay", "The state pays", "I don't have", "Free"), fill=(terrain.colors(4)), cex=0.9, bty="n")
```

## Would you train for free?
```{r, echo=TRUE}
prop.table(table(Italy_data$q_0017))
par(mar=c(3,2,2,2))
pie(table(Italy_data$q_0017),
    main="Motivated to train in Psychotherapy for free?")
text(-0.2,-0.95, "UEMS recommendations states that psychotherapy training 
of trainees should be funded publicly and free for trainees.")
```

## How much would you invest in psychotherapy training ?
```{r, echo=TRUE}
par(mar=c(6,2.5,3,2), xpd=FALSE)
hist(Italy_data$q_0018[which(Italy_data$q_0018<100)], col="light green",
     main="% of annual salary for psychotherapy training",
     xlab="Percentage of your annual salary do you intend to spend on funding your psychotherapy training In the next 12 months?", cex.lab=1.1, cex.main=1.7)
abline(v=mean(Italy_data$q_0018[which(Italy_data$q_0018<100)]), lwd=2, lty=2)
text(20, 200, paste("Mean :",round( mean(Italy_data$q_0018[which(Italy_data$q_0018<100)])), " %"), font=2, cex=1.3)
text(20, 150, paste("Median :" , median(Italy_data$q_0018[which(Italy_data$q_0018<100)]), " %"), font=2, cex=1.3)
```

## Satisfaction group
```{r, echo=TRUE}
# make auxiliary table to hold our likert Italy_data
sat1<-Italy_data[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(Italy_data$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- Italy_data[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## UEMS recommendations awareness
```{r, echo=TRUE}
# and same with the
uems2 <- Italy_data[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

# Latvia results
```{r,include = FALSE}
dim(Latvia_data)
str(Latvia_data)
summary(Latvia_data)
```

## Number of participants
```{r, echo = FALSE}
# table(Latvia_data[which(complete.cases(Latvia_data$q_0000)==TRUE),]$q_0000)
countryanswers <- sort(table(Latvia_data$q_0000), decreasing = FALSE)
answering_countries <- countryanswers[which (countryanswers > 0)]
#delete France false data
answering_countries <- answering_countries[-3]

par(mar=c(2.5,9.5,2,2))
barplot(answering_countries, cex.names=0.9, las=1, main="Number of answers by country", col="cornflowerblue", horiz=TRUE, border=NA)
text(45,6, paste(length(answering_countries), "countries
                Total of answers :", sum(answering_countries),
                 "
                              Mean answers by country: " , round(mean(answering_countries)),"
               
                      Top 4: Romania, France, 
                      Slovenia, Czech Republic"), cex=1.2)
abline(v=mean(answering_countries), lty=2)
text(19, 0.7,"Mean", font=2)
```

## Gender
```{r, echo=TRUE, fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
gender <-table(Latvia_data$q_0001)
#prop.table(gender)
pie(gender, main="Gender of participants in Europe reponses")
```

##Age
```{r, echo=TRUE,  fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
#error max = 1969 !!!
age_Europe <- Latvia_data$q_0002[which(Latvia_data$q_0002<1969)]
hist(age_Europe, col="cornflowerblue",
     xlab="Age", ylab="Number", main="Age distribution", freq=TRUE, border=NA, breaks=25 )
text(47, 40, paste("Mean age:", round(mean(age_Europe),0), "years"))
abline(v=mean(age_Europe), lty=2)
```

## Year in Training
```{r, echo=TRUE}
YoT <- table(Latvia_data$q_0003)
names(YoT)<- c(1:8, "> 8", "TF")
par(mfrow=c(1,1), mar=c(3,3,2,2))
barplot(YoT, main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number", cex.names=1)
```
>TF for training finished

## Are you receiving personal psychotherapy or have you received it in the past?
```{r, echo=TRUE}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
Latvia_data[, 7] <- as.numeric(Latvia_data[, 7])
attributes(Latvia_data)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
Latvia_data[, 7] <- factor(Latvia_data[, 7], levels=c(1,2),labels=c("Yes","No"))
names(Latvia_data)[7] <- "q_0004"
#table(Latvia_data$q_0004)
par(mar=c(3,3,2,2))
prop.table(table(Latvia_data$q_0004))
pie(table(Latvia_data$q_0004), main = "Receiving personal psychotherapy (present or past)")
```

```{r, echo=TRUE}
## I am undertaking training in Psychotherapy within my training programme in Psychiatry
## NO DATA ????
#tab <- table(Latvia_data$q_0005_S05A1)
#length(tab)
#pie(table(Latvia_data$q_0005_S05A1), main="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r, echo=TRUE}
table(Latvia_data$q_0005_S05A2)
prop.table(table(Latvia_data$q_0005_S05A2))
pie(table(Latvia_data$q_0005_S05A2), main="Training in psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r, echo=TRUE}
#table(Latvia_data$q_0005_S05A3)
pie(table(Latvia_data$q_0005_S05A3),  main="I am not undertaking any training in Psychotherapy")
```

> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r, echo=TRUE}
#table(Latvia_data$q_0005_S05A4)
prop.table(table(Latvia_data$q_0005_S05A4))
pie(table(Latvia_data$q_0005_S05A4), main="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality
```{r, echo=TRUE}
table(is.na(Latvia_data$q_0006))
prop.table(table(is.na(Latvia_data$q_0006)))
pie(table(is.na(Latvia_data$q_0006)),main="I am training in some modality of psychotherapy")
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r, echo=TRUE}
table(Latvia_data$q_0007)
prop.table(table(Latvia_data$q_0007))
pie(table(Latvia_data$q_0007), main="Psychotherapy important for the professional identity", col=terrain.colors(3))
```

## Do you want to practise Psychotherapy ?
```{r, echo=TRUE}
#table(Latvia_data$q_0008)
prop.table(table(Latvia_data$q_0008))
pie(table(Latvia_data$q_0008), main="Plan to practise Psychotherapy after training")
```

## Are you interested in this psychotherapy?
```{r, echo=TRUE}
q9df <- Latvia_data[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","Not Any","Other"),main="Interested in this therapy", las=1, col=rainbow(6),)
```

##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"
```{r, echo=TRUE, eval=FALSE}

barplot(table(Latvia_data$q_0011_SQ001), col="green", main="Theoretical lectures or seminars in psychotherapy", border=NA)
abline(v=1.3, lwd=3)
text(0.6,215, "UEMS <", adj = c(0, -.1), font=2)
```
> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r, echo=TRUE, eval=FALSE}
#barplot(PWS, col="blue", main="Conducting Psychotherapy without supervision", border=NA)
```

```{r, echo=TRUE, eval=FALSE}

barplot(table(Latvia_data$q_0011_SQ003), col="yellow", main="Conducting Psychotherapy under supervision")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Latvia_data$q_0011_SQ004), col="orange", main="Personal Psychotherapy")
```

```{r, echo=TRUE}
TL <- table(Latvia_data$q_0011_SQ001)
PNS <- table(Latvia_data$q_0011_SQ002)
PWS <- table(Latvia_data$q_0011_SQ003)
PP <- table(Latvia_data$q_0011_SQ004)

mandatory <- cbind(prop.table(TL),prop.table(PNS), prop.table(PWS), prop.table(PP))
par(mar=c(3,3,5,9), xpd=TRUE)
barplot(mandatory, col=terrain.colors(3), names=c("Theorical lectures", "Psychotherapy 
without supervision", "Psychotherapy 
with supervision", "Personnal 
psychotherapy"), cex.name=1, main="The following experience in psychotherapy 
is a mandatory part of my training in Psychiatry", cex.main=1.5)
legend("topright", inset=c(-0.27,0), legend = c("Yes", "No", "Uncertain"), fill=(terrain.colors(3)), cex=0.9, bty="n")
```

```{r, echo=TRUE}
qualified <- prop.table(table(Latvia_data$q_0012))
par(mar=c(4,5,5,3))
barplot(qualified, col=terrain.colors(3) , main="Are you qualified 
        to practice psychotherapy after your training ?", las=1, ylab="Frequency", cex.names=1.4, cex.lab=1.4, cex.main=1.4)
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
```{r, echo=TRUE}
#table(Latvia_data$q_0013)
```

## How many hours of supervision
```{r, echo=TRUE}
par(mar=c(5,5,3,3), xpd=FALSE)
hist(Latvia_data$q_0014_SQ001[which(is.na(Latvia_data$q_0014_SQ001)==FALSE)], col="cornflowerblue", xlim=c(0,10), main ="Repartition of the hours of supervision in Europe", ylab="Frequency", xlab= "Hours by month", lwd=3, las=1, cex.lab=1.3, cex.main=1.3, breaks=10, freq=FALSE)
text(3.5, 0.30, paste(" Mean :",round(mean(Latvia_data$q_0014_SQ001[which(is.na(Latvia_data$q_0014_SQ001)==FALSE)]),2), "h"), font=2, cex=1.5, col="cornflowerblue")
text(3.3, 0.20, paste(" Median :", (median(Latvia_data$q_0014_SQ001[which(is.na(Latvia_data$q_0014_SQ001)==FALSE)])), "h"), font=2, cex=1.5, col="cornflowerblue")
abline(v=mean(Latvia_data$q_0014_SQ001[which(is.na(Latvia_data$q_0014_SQ001)==FALSE)]), col="cornflowerblue", lwd=3)
abline(v=1.7, lty=3, lwd=3)
text(3.5,0.40, "UEMS > 1.7h", font=2, cex=1.5)
#lines(density(Latvia_data$q_0014_SQ002[which(is.na(Latvia_data$q_0014_SQ002)==FALSE)]), col=rainbow(5)[2])
#lines(density(Latvia_data$q_0014_SQ003[which(is.na(Latvia_data$q_0014_SQ003)==FALSE)]), col=rainbow(5)[3])
#lines(density(Latvia_data$q_0014_SQ004[which(is.na(Latvia_data$q_0014_SQ004)==FALSE)]), col=rainbow(5)[4])
#lines(density(Latvia_data$q_0014_SQ005[which(is.na(Latvia_data$q_0014_SQ005)==FALSE)]), col=rainbow(5)[5])
#legend("topright", legend=c("Hours of Psychotherapy supervision per month", "Small group supervision (3 - 5 people)", "Large group supervision (more than 5 people)", "Generic Balint group", "Other form of supervision"), fill = rainbow(4), cex=0.7)
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r, echo=TRUE, eval=FALSE}
hist(Latvia_data$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(2.5,300, "> UEMS", font=2)
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Latvia_data$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Latvia_data$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Latvia_data$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r, echo=TRUE, eval=FALSE}
hist(Latvia_data$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

table(Latvia_data$q_0015)

##Who pays?
```{r, echo=TRUE, eval=FALSE}
barplot(table(Latvia_data$q_0016_SQ002), col="light blue",
        xlab="Who pays for this component of Psychotherapy experience?",
        names=c("I pay", "State pays", "I don't have", "Free"),
        main="Supervision - individual")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Latvia_data$q_0016_SQ003), col="light blue",
        main="Supervision - group",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Latvia_data$q_0016_SQ004), col="light blue",
        main="Balint groups",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Latvia_data$q_0016_SQ005), col="light blue",
        main="Sessions with patient(s)",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Latvia_data$q_0016_SQ006), col="light blue",
        main="Self-experience",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays")
```

```{r, echo=TRUE}
par(mar=c(6,2.5,3,9), xpd=TRUE)
payTL <- table(Latvia_data$q_0016_SQ001)
paySI <- table(Latvia_data$q_0016_SQ002)
paySG <- table(Latvia_data$q_0016_SQ003)
payBG <- table(Latvia_data$q_0016_SQ004)
paySP <- table(Latvia_data$q_0016_SQ005)
paySE <- table(Latvia_data$q_0016_SQ006)
pay <- cbind(prop.table(payTL), prop.table(paySI), prop.table(paySG), prop.table(payBG), prop.table(paySP), prop.table(paySE))
barplot(pay, col=terrain.colors(4),
        main="Who pays?",
        names=c("Theorectical 
lectures", "Supervision 
indiv.", "Supervision 
group", "Balint
groups ", "Sessions
with patient(s)", "Self
experience"), cex.name=0.8, las=2)
legend("topright", inset=c(-0.38,0), legend = c("I pay", "The state pays", "I don't have", "Free"), fill=(terrain.colors(4)), cex=0.9, bty="n")
```

## Would you train for free?
```{r, echo=TRUE}
prop.table(table(Latvia_data$q_0017))
par(mar=c(3,2,2,2))
pie(table(Latvia_data$q_0017),
    main="Motivated to train in Psychotherapy for free?")
text(-0.2,-0.95, "UEMS recommendations states that psychotherapy training 
of trainees should be funded publicly and free for trainees.")
```

## How much would you invest in psychotherapy training ?
```{r, echo=TRUE}
par(mar=c(6,2.5,3,2), xpd=FALSE)
hist(Latvia_data$q_0018[which(Latvia_data$q_0018<100)], col="light green",
     main="% of annual salary for psychotherapy training",
     xlab="Percentage of your annual salary do you intend to spend on funding your psychotherapy training In the next 12 months?", cex.lab=1.1, cex.main=1.7)
abline(v=mean(Latvia_data$q_0018[which(Latvia_data$q_0018<100)]), lwd=2, lty=2)
text(20, 200, paste("Mean :",round( mean(Latvia_data$q_0018[which(Latvia_data$q_0018<100)])), " %"), font=2, cex=1.3)
text(20, 150, paste("Median :" , median(Latvia_data$q_0018[which(Latvia_data$q_0018<100)]), " %"), font=2, cex=1.3)
```

## Satisfaction group
```{r, echo=TRUE}
# make auxiliary table to hold our likert Latvia_data
sat1<-Latvia_data[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(Latvia_data$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- Latvia_data[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## UEMS recommendations awareness
```{r, echo=TRUE}
# and same with the
uems2 <- Latvia_data[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

# Lithuania results
```{r,include = FALSE}
dim(Lithuania_data)
str(Lithuania_data)
summary(Lithuania_data)
```

## Number of participants
```{r, echo = FALSE}
# table(Lithuania_data[which(complete.cases(Lithuania_data$q_0000)==TRUE),]$q_0000)
countryanswers <- sort(table(Lithuania_data$q_0000), decreasing = FALSE)
answering_countries <- countryanswers[which (countryanswers > 0)]
#delete France false data
answering_countries <- answering_countries[-3]

par(mar=c(2.5,9.5,2,2))
barplot(answering_countries, cex.names=0.9, las=1, main="Number of answers by country", col="cornflowerblue", horiz=TRUE, border=NA)
text(45,6, paste(length(answering_countries), "countries
                Total of answers :", sum(answering_countries),
                 "
                              Mean answers by country: " , round(mean(answering_countries)),"
               
                      Top 4: Romania, France, 
                      Slovenia, Czech Republic"), cex=1.2)
abline(v=mean(answering_countries), lty=2)
text(19, 0.7,"Mean", font=2)
```

## Gender
```{r, echo=TRUE, fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
gender <-table(Lithuania_data$q_0001)
#prop.table(gender)
pie(gender, main="Gender of participants in Europe reponses")
```

##Age
```{r, echo=TRUE,  fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
#error max = 1969 !!!
age_Europe <- Lithuania_data$q_0002[which(Lithuania_data$q_0002<1969)]
hist(age_Europe, col="cornflowerblue",
     xlab="Age", ylab="Number", main="Age distribution", freq=TRUE, border=NA, breaks=25 )
text(47, 40, paste("Mean age:", round(mean(age_Europe),0), "years"))
abline(v=mean(age_Europe), lty=2)
```

## Year in Training
```{r, echo=TRUE}
YoT <- table(Lithuania_data$q_0003)
names(YoT)<- c(1:8, "> 8", "TF")
par(mfrow=c(1,1), mar=c(3,3,2,2))
barplot(YoT, main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number", cex.names=1)
```
>TF for training finished

## Are you receiving personal psychotherapy or have you received it in the past?
```{r, echo=TRUE}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
Lithuania_data[, 7] <- as.numeric(Lithuania_data[, 7])
attributes(Lithuania_data)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
Lithuania_data[, 7] <- factor(Lithuania_data[, 7], levels=c(1,2),labels=c("Yes","No"))
names(Lithuania_data)[7] <- "q_0004"
#table(Lithuania_data$q_0004)
par(mar=c(3,3,2,2))
prop.table(table(Lithuania_data$q_0004))
pie(table(Lithuania_data$q_0004), main = "Receiving personal psychotherapy (present or past)")
```

```{r, echo=TRUE}
## I am undertaking training in Psychotherapy within my training programme in Psychiatry
## NO DATA ????
#tab <- table(Lithuania_data$q_0005_S05A1)
#length(tab)
#pie(table(Lithuania_data$q_0005_S05A1), main="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r, echo=TRUE}
table(Lithuania_data$q_0005_S05A2)
prop.table(table(Lithuania_data$q_0005_S05A2))
pie(table(Lithuania_data$q_0005_S05A2), main="Training in psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r, echo=TRUE}
#table(Lithuania_data$q_0005_S05A3)
pie(table(Lithuania_data$q_0005_S05A3),  main="I am not undertaking any training in Psychotherapy")
```

> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r, echo=TRUE}
#table(Lithuania_data$q_0005_S05A4)
prop.table(table(Lithuania_data$q_0005_S05A4))
pie(table(Lithuania_data$q_0005_S05A4), main="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality
```{r, echo=TRUE}
table(is.na(Lithuania_data$q_0006))
prop.table(table(is.na(Lithuania_data$q_0006)))
pie(table(is.na(Lithuania_data$q_0006)),main="I am training in some modality of psychotherapy")
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r, echo=TRUE}
table(Lithuania_data$q_0007)
prop.table(table(Lithuania_data$q_0007))
pie(table(Lithuania_data$q_0007), main="Psychotherapy important for the professional identity", col=terrain.colors(3))
```

## Do you want to practise Psychotherapy ?
```{r, echo=TRUE}
#table(Lithuania_data$q_0008)
prop.table(table(Lithuania_data$q_0008))
pie(table(Lithuania_data$q_0008), main="Plan to practise Psychotherapy after training")
```

## Are you interested in this psychotherapy?
```{r, echo=TRUE}
q9df <- Lithuania_data[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","Not Any","Other"),main="Interested in this therapy", las=1, col=rainbow(6),)
```

##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"
```{r, echo=TRUE, eval=FALSE}

barplot(table(Lithuania_data$q_0011_SQ001), col="green", main="Theoretical lectures or seminars in psychotherapy", border=NA)
abline(v=1.3, lwd=3)
text(0.6,215, "UEMS <", adj = c(0, -.1), font=2)
```
> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r, echo=TRUE, eval=FALSE}
#barplot(PWS, col="blue", main="Conducting Psychotherapy without supervision", border=NA)
```

```{r, echo=TRUE, eval=FALSE}

barplot(table(Lithuania_data$q_0011_SQ003), col="yellow", main="Conducting Psychotherapy under supervision")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Lithuania_data$q_0011_SQ004), col="orange", main="Personal Psychotherapy")
```

```{r, echo=TRUE}
TL <- table(Lithuania_data$q_0011_SQ001)
PNS <- table(Lithuania_data$q_0011_SQ002)
PWS <- table(Lithuania_data$q_0011_SQ003)
PP <- table(Lithuania_data$q_0011_SQ004)

mandatory <- cbind(prop.table(TL),prop.table(PNS), prop.table(PWS), prop.table(PP))
par(mar=c(3,3,5,9), xpd=TRUE)
barplot(mandatory, col=terrain.colors(3), names=c("Theorical lectures", "Psychotherapy 
without supervision", "Psychotherapy 
with supervision", "Personnal 
psychotherapy"), cex.name=1, main="The following experience in psychotherapy 
is a mandatory part of my training in Psychiatry", cex.main=1.5)
legend("topright", inset=c(-0.27,0), legend = c("Yes", "No", "Uncertain"), fill=(terrain.colors(3)), cex=0.9, bty="n")
```

```{r, echo=TRUE}
qualified <- prop.table(table(Lithuania_data$q_0012))
par(mar=c(4,5,5,3))
barplot(qualified, col=terrain.colors(3) , main="Are you qualified 
        to practice psychotherapy after your training ?", las=1, ylab="Frequency", cex.names=1.4, cex.lab=1.4, cex.main=1.4)
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
```{r, echo=TRUE}
#table(Lithuania_data$q_0013)
```

## How many hours of supervision
```{r, echo=TRUE}
par(mar=c(5,5,3,3), xpd=FALSE)
hist(Lithuania_data$q_0014_SQ001[which(is.na(Lithuania_data$q_0014_SQ001)==FALSE)], col="cornflowerblue", xlim=c(0,10), main ="Repartition of the hours of supervision in Europe", ylab="Frequency", xlab= "Hours by month", lwd=3, las=1, cex.lab=1.3, cex.main=1.3, breaks=10, freq=FALSE)
text(3.5, 0.30, paste(" Mean :",round(mean(Lithuania_data$q_0014_SQ001[which(is.na(Lithuania_data$q_0014_SQ001)==FALSE)]),2), "h"), font=2, cex=1.5, col="cornflowerblue")
text(3.3, 0.20, paste(" Median :", (median(Lithuania_data$q_0014_SQ001[which(is.na(Lithuania_data$q_0014_SQ001)==FALSE)])), "h"), font=2, cex=1.5, col="cornflowerblue")
abline(v=mean(Lithuania_data$q_0014_SQ001[which(is.na(Lithuania_data$q_0014_SQ001)==FALSE)]), col="cornflowerblue", lwd=3)
abline(v=1.7, lty=3, lwd=3)
text(3.5,0.40, "UEMS > 1.7h", font=2, cex=1.5)
#lines(density(Lithuania_data$q_0014_SQ002[which(is.na(Lithuania_data$q_0014_SQ002)==FALSE)]), col=rainbow(5)[2])
#lines(density(Lithuania_data$q_0014_SQ003[which(is.na(Lithuania_data$q_0014_SQ003)==FALSE)]), col=rainbow(5)[3])
#lines(density(Lithuania_data$q_0014_SQ004[which(is.na(Lithuania_data$q_0014_SQ004)==FALSE)]), col=rainbow(5)[4])
#lines(density(Lithuania_data$q_0014_SQ005[which(is.na(Lithuania_data$q_0014_SQ005)==FALSE)]), col=rainbow(5)[5])
#legend("topright", legend=c("Hours of Psychotherapy supervision per month", "Small group supervision (3 - 5 people)", "Large group supervision (more than 5 people)", "Generic Balint group", "Other form of supervision"), fill = rainbow(4), cex=0.7)
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r, echo=TRUE, eval=FALSE}
hist(Lithuania_data$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(2.5,300, "> UEMS", font=2)
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Lithuania_data$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Lithuania_data$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Lithuania_data$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r, echo=TRUE, eval=FALSE}
hist(Lithuania_data$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

table(Lithuania_data$q_0015)

##Who pays?
```{r, echo=TRUE, eval=FALSE}
barplot(table(Lithuania_data$q_0016_SQ002), col="light blue",
        xlab="Who pays for this component of Psychotherapy experience?",
        names=c("I pay", "State pays", "I don't have", "Free"),
        main="Supervision - individual")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Lithuania_data$q_0016_SQ003), col="light blue",
        main="Supervision - group",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Lithuania_data$q_0016_SQ004), col="light blue",
        main="Balint groups",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Lithuania_data$q_0016_SQ005), col="light blue",
        main="Sessions with patient(s)",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Lithuania_data$q_0016_SQ006), col="light blue",
        main="Self-experience",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays")
```

```{r, echo=TRUE}
par(mar=c(6,2.5,3,9), xpd=TRUE)
payTL <- table(Lithuania_data$q_0016_SQ001)
paySI <- table(Lithuania_data$q_0016_SQ002)
paySG <- table(Lithuania_data$q_0016_SQ003)
payBG <- table(Lithuania_data$q_0016_SQ004)
paySP <- table(Lithuania_data$q_0016_SQ005)
paySE <- table(Lithuania_data$q_0016_SQ006)
pay <- cbind(prop.table(payTL), prop.table(paySI), prop.table(paySG), prop.table(payBG), prop.table(paySP), prop.table(paySE))
barplot(pay, col=terrain.colors(4),
        main="Who pays?",
        names=c("Theorectical 
lectures", "Supervision 
indiv.", "Supervision 
group", "Balint
groups ", "Sessions
with patient(s)", "Self
experience"), cex.name=0.8, las=2)
legend("topright", inset=c(-0.38,0), legend = c("I pay", "The state pays", "I don't have", "Free"), fill=(terrain.colors(4)), cex=0.9, bty="n")
```

## Would you train for free?
```{r, echo=TRUE}
prop.table(table(Lithuania_data$q_0017))
par(mar=c(3,2,2,2))
pie(table(Lithuania_data$q_0017),
    main="Motivated to train in Psychotherapy for free?")
text(-0.2,-0.95, "UEMS recommendations states that psychotherapy training 
of trainees should be funded publicly and free for trainees.")
```

## How much would you invest in psychotherapy training ?
```{r, echo=TRUE}
par(mar=c(6,2.5,3,2), xpd=FALSE)
hist(Lithuania_data$q_0018[which(Lithuania_data$q_0018<100)], col="light green",
     main="% of annual salary for psychotherapy training",
     xlab="Percentage of your annual salary do you intend to spend on funding your psychotherapy training In the next 12 months?", cex.lab=1.1, cex.main=1.7)
abline(v=mean(Lithuania_data$q_0018[which(Lithuania_data$q_0018<100)]), lwd=2, lty=2)
text(20, 200, paste("Mean :",round( mean(Lithuania_data$q_0018[which(Lithuania_data$q_0018<100)])), " %"), font=2, cex=1.3)
text(20, 150, paste("Median :" , median(Lithuania_data$q_0018[which(Lithuania_data$q_0018<100)]), " %"), font=2, cex=1.3)
```

## Satisfaction group
```{r, echo=TRUE}
# make auxiliary table to hold our likert Lithuania_data
sat1<-Lithuania_data[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(Lithuania_data$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- Lithuania_data[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## UEMS recommendations awareness
```{r, echo=TRUE}
# and same with the
uems2 <- Lithuania_data[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

# Malta results
```{r,include = FALSE}
dim(Malta_data)
str(Malta_data)
summary(Malta_data)
```

## Number of participants
```{r, echo = FALSE}
# table(Malta_data[which(complete.cases(Malta_data$q_0000)==TRUE),]$q_0000)
countryanswers <- sort(table(Malta_data$q_0000), decreasing = FALSE)
answering_countries <- countryanswers[which (countryanswers > 0)]
#delete France false data
answering_countries <- answering_countries[-3]

par(mar=c(2.5,9.5,2,2))
barplot(answering_countries, cex.names=0.9, las=1, main="Number of answers by country", col="cornflowerblue", horiz=TRUE, border=NA)
text(45,6, paste(length(answering_countries), "countries
                Total of answers :", sum(answering_countries),
                 "
                              Mean answers by country: " , round(mean(answering_countries)),"
               
                      Top 4: Romania, France, 
                      Slovenia, Czech Republic"), cex=1.2)
abline(v=mean(answering_countries), lty=2)
text(19, 0.7,"Mean", font=2)
```

## Gender
```{r, echo=TRUE, fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
gender <-table(Malta_data$q_0001)
#prop.table(gender)
pie(gender, main="Gender of participants in Europe reponses")
```

##Age
```{r, echo=TRUE,  fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
#error max = 1969 !!!
age_Europe <- Malta_data$q_0002[which(Malta_data$q_0002<1969)]
hist(age_Europe, col="cornflowerblue",
     xlab="Age", ylab="Number", main="Age distribution", freq=TRUE, border=NA, breaks=25 )
text(47, 40, paste("Mean age:", round(mean(age_Europe),0), "years"))
abline(v=mean(age_Europe), lty=2)
```

## Year in Training
```{r, echo=TRUE}
YoT <- table(Malta_data$q_0003)
names(YoT)<- c(1:8, "> 8", "TF")
par(mfrow=c(1,1), mar=c(3,3,2,2))
barplot(YoT, main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number", cex.names=1)
```
>TF for training finished

## Are you receiving personal psychotherapy or have you received it in the past?
```{r, echo=TRUE}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
Malta_data[, 7] <- as.numeric(Malta_data[, 7])
attributes(Malta_data)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
Malta_data[, 7] <- factor(Malta_data[, 7], levels=c(1,2),labels=c("Yes","No"))
names(Malta_data)[7] <- "q_0004"
#table(Malta_data$q_0004)
par(mar=c(3,3,2,2))
prop.table(table(Malta_data$q_0004))
pie(table(Malta_data$q_0004), main = "Receiving personal psychotherapy (present or past)")
```

```{r, echo=TRUE}
## I am undertaking training in Psychotherapy within my training programme in Psychiatry
## NO DATA ????
#tab <- table(Malta_data$q_0005_S05A1)
#length(tab)
#pie(table(Malta_data$q_0005_S05A1), main="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r, echo=TRUE}
table(Malta_data$q_0005_S05A2)
prop.table(table(Malta_data$q_0005_S05A2))
pie(table(Malta_data$q_0005_S05A2), main="Training in psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r, echo=TRUE}
#table(Malta_data$q_0005_S05A3)
pie(table(Malta_data$q_0005_S05A3),  main="I am not undertaking any training in Psychotherapy")
```

> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r, echo=TRUE}
#table(Malta_data$q_0005_S05A4)
prop.table(table(Malta_data$q_0005_S05A4))
pie(table(Malta_data$q_0005_S05A4), main="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality
```{r, echo=TRUE}
table(is.na(Malta_data$q_0006))
prop.table(table(is.na(Malta_data$q_0006)))
pie(table(is.na(Malta_data$q_0006)),main="I am training in some modality of psychotherapy")
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r, echo=TRUE}
table(Malta_data$q_0007)
prop.table(table(Malta_data$q_0007))
pie(table(Malta_data$q_0007), main="Psychotherapy important for the professional identity", col=terrain.colors(3))
```

## Do you want to practise Psychotherapy ?
```{r, echo=TRUE}
#table(Malta_data$q_0008)
prop.table(table(Malta_data$q_0008))
pie(table(Malta_data$q_0008), main="Plan to practise Psychotherapy after training")
```

## Are you interested in this psychotherapy?
```{r, echo=TRUE}
q9df <- Malta_data[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","Not Any","Other"),main="Interested in this therapy", las=1, col=rainbow(6),)
```

##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"
```{r, echo=TRUE, eval=FALSE}

barplot(table(Malta_data$q_0011_SQ001), col="green", main="Theoretical lectures or seminars in psychotherapy", border=NA)
abline(v=1.3, lwd=3)
text(0.6,215, "UEMS <", adj = c(0, -.1), font=2)
```
> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r, echo=TRUE, eval=FALSE}
#barplot(PWS, col="blue", main="Conducting Psychotherapy without supervision", border=NA)
```

```{r, echo=TRUE, eval=FALSE}

barplot(table(Malta_data$q_0011_SQ003), col="yellow", main="Conducting Psychotherapy under supervision")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Malta_data$q_0011_SQ004), col="orange", main="Personal Psychotherapy")
```

```{r, echo=TRUE}
TL <- table(Malta_data$q_0011_SQ001)
PNS <- table(Malta_data$q_0011_SQ002)
PWS <- table(Malta_data$q_0011_SQ003)
PP <- table(Malta_data$q_0011_SQ004)

mandatory <- cbind(prop.table(TL),prop.table(PNS), prop.table(PWS), prop.table(PP))
par(mar=c(3,3,5,9), xpd=TRUE)
barplot(mandatory, col=terrain.colors(3), names=c("Theorical lectures", "Psychotherapy 
without supervision", "Psychotherapy 
with supervision", "Personnal 
psychotherapy"), cex.name=1, main="The following experience in psychotherapy 
is a mandatory part of my training in Psychiatry", cex.main=1.5)
legend("topright", inset=c(-0.27,0), legend = c("Yes", "No", "Uncertain"), fill=(terrain.colors(3)), cex=0.9, bty="n")
```

```{r, echo=TRUE}
qualified <- prop.table(table(Malta_data$q_0012))
par(mar=c(4,5,5,3))
barplot(qualified, col=terrain.colors(3) , main="Are you qualified 
        to practice psychotherapy after your training ?", las=1, ylab="Frequency", cex.names=1.4, cex.lab=1.4, cex.main=1.4)
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
```{r, echo=TRUE}
#table(Malta_data$q_0013)
```

## How many hours of supervision
```{r, echo=TRUE}
par(mar=c(5,5,3,3), xpd=FALSE)
hist(Malta_data$q_0014_SQ001[which(is.na(Malta_data$q_0014_SQ001)==FALSE)], col="cornflowerblue", xlim=c(0,10), main ="Repartition of the hours of supervision in Europe", ylab="Frequency", xlab= "Hours by month", lwd=3, las=1, cex.lab=1.3, cex.main=1.3, breaks=10, freq=FALSE)
text(3.5, 0.30, paste(" Mean :",round(mean(Malta_data$q_0014_SQ001[which(is.na(Malta_data$q_0014_SQ001)==FALSE)]),2), "h"), font=2, cex=1.5, col="cornflowerblue")
text(3.3, 0.20, paste(" Median :", (median(Malta_data$q_0014_SQ001[which(is.na(Malta_data$q_0014_SQ001)==FALSE)])), "h"), font=2, cex=1.5, col="cornflowerblue")
abline(v=mean(Malta_data$q_0014_SQ001[which(is.na(Malta_data$q_0014_SQ001)==FALSE)]), col="cornflowerblue", lwd=3)
abline(v=1.7, lty=3, lwd=3)
text(3.5,0.40, "UEMS > 1.7h", font=2, cex=1.5)
#lines(density(Malta_data$q_0014_SQ002[which(is.na(Malta_data$q_0014_SQ002)==FALSE)]), col=rainbow(5)[2])
#lines(density(Malta_data$q_0014_SQ003[which(is.na(Malta_data$q_0014_SQ003)==FALSE)]), col=rainbow(5)[3])
#lines(density(Malta_data$q_0014_SQ004[which(is.na(Malta_data$q_0014_SQ004)==FALSE)]), col=rainbow(5)[4])
#lines(density(Malta_data$q_0014_SQ005[which(is.na(Malta_data$q_0014_SQ005)==FALSE)]), col=rainbow(5)[5])
#legend("topright", legend=c("Hours of Psychotherapy supervision per month", "Small group supervision (3 - 5 people)", "Large group supervision (more than 5 people)", "Generic Balint group", "Other form of supervision"), fill = rainbow(4), cex=0.7)
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r, echo=TRUE, eval=FALSE}
hist(Malta_data$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(2.5,300, "> UEMS", font=2)
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Malta_data$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Malta_data$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Malta_data$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r, echo=TRUE, eval=FALSE}
hist(Malta_data$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

table(Malta_data$q_0015)

##Who pays?
```{r, echo=TRUE, eval=FALSE}
barplot(table(Malta_data$q_0016_SQ002), col="light blue",
        xlab="Who pays for this component of Psychotherapy experience?",
        names=c("I pay", "State pays", "I don't have", "Free"),
        main="Supervision - individual")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Malta_data$q_0016_SQ003), col="light blue",
        main="Supervision - group",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Malta_data$q_0016_SQ004), col="light blue",
        main="Balint groups",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Malta_data$q_0016_SQ005), col="light blue",
        main="Sessions with patient(s)",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Malta_data$q_0016_SQ006), col="light blue",
        main="Self-experience",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays")
```

```{r, echo=TRUE}
par(mar=c(6,2.5,3,9), xpd=TRUE)
payTL <- table(Malta_data$q_0016_SQ001)
paySI <- table(Malta_data$q_0016_SQ002)
paySG <- table(Malta_data$q_0016_SQ003)
payBG <- table(Malta_data$q_0016_SQ004)
paySP <- table(Malta_data$q_0016_SQ005)
paySE <- table(Malta_data$q_0016_SQ006)
pay <- cbind(prop.table(payTL), prop.table(paySI), prop.table(paySG), prop.table(payBG), prop.table(paySP), prop.table(paySE))
barplot(pay, col=terrain.colors(4),
        main="Who pays?",
        names=c("Theorectical 
lectures", "Supervision 
indiv.", "Supervision 
group", "Balint
groups ", "Sessions
with patient(s)", "Self
experience"), cex.name=0.8, las=2)
legend("topright", inset=c(-0.38,0), legend = c("I pay", "The state pays", "I don't have", "Free"), fill=(terrain.colors(4)), cex=0.9, bty="n")
```

## Would you train for free?
```{r, echo=TRUE}
prop.table(table(Malta_data$q_0017))
par(mar=c(3,2,2,2))
pie(table(Malta_data$q_0017),
    main="Motivated to train in Psychotherapy for free?")
text(-0.2,-0.95, "UEMS recommendations states that psychotherapy training 
of trainees should be funded publicly and free for trainees.")
```

## How much would you invest in psychotherapy training ?
```{r, echo=TRUE}
par(mar=c(6,2.5,3,2), xpd=FALSE)
hist(Malta_data$q_0018[which(Malta_data$q_0018<100)], col="light green",
     main="% of annual salary for psychotherapy training",
     xlab="Percentage of your annual salary do you intend to spend on funding your psychotherapy training In the next 12 months?", cex.lab=1.1, cex.main=1.7)
abline(v=mean(Malta_data$q_0018[which(Malta_data$q_0018<100)]), lwd=2, lty=2)
text(20, 200, paste("Mean :",round( mean(Malta_data$q_0018[which(Malta_data$q_0018<100)])), " %"), font=2, cex=1.3)
text(20, 150, paste("Median :" , median(Malta_data$q_0018[which(Malta_data$q_0018<100)]), " %"), font=2, cex=1.3)
```

## Satisfaction group
```{r, echo=TRUE}
# make auxiliary table to hold our likert Malta_data
sat1<-Malta_data[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(Malta_data$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- Malta_data[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## UEMS recommendations awareness
```{r, echo=TRUE}
# and same with the
uems2 <- Malta_data[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

# Malta results
```{r,include = FALSE}
dim(Romania_data)
str(Romania_data)
summary(Romania_data)
```

## Number of participants
```{r, echo = FALSE}
# table(Romania_data[which(complete.cases(Romania_data$q_0000)==TRUE),]$q_0000)
countryanswers <- sort(table(Romania_data$q_0000), decreasing = FALSE)
answering_countries <- countryanswers[which (countryanswers > 0)]
#delete France false data
answering_countries <- answering_countries[-3]

par(mar=c(2.5,9.5,2,2))
barplot(answering_countries, cex.names=0.9, las=1, main="Number of answers by country", col="cornflowerblue", horiz=TRUE, border=NA)
text(45,6, paste(length(answering_countries), "countries
                Total of answers :", sum(answering_countries),
                 "
                              Mean answers by country: " , round(mean(answering_countries)),"
               
                      Top 4: Romania, France, 
                      Slovenia, Czech Republic"), cex=1.2)
abline(v=mean(answering_countries), lty=2)
text(19, 0.7,"Mean", font=2)
```

## Gender
```{r, echo=TRUE, fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
gender <-table(Romania_data$q_0001)
#prop.table(gender)
pie(gender, main="Gender of participants in Europe reponses")
```

##Age
```{r, echo=TRUE,  fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
#error max = 1969 !!!
age_Europe <- Romania_data$q_0002[which(Romania_data$q_0002<1969)]
hist(age_Europe, col="cornflowerblue",
     xlab="Age", ylab="Number", main="Age distribution", freq=TRUE, border=NA, breaks=25 )
text(47, 40, paste("Mean age:", round(mean(age_Europe),0), "years"))
abline(v=mean(age_Europe), lty=2)
```

## Year in Training
```{r, echo=TRUE}
YoT <- table(Romania_data$q_0003)
names(YoT)<- c(1:8, "> 8", "TF")
par(mfrow=c(1,1), mar=c(3,3,2,2))
barplot(YoT, main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number", cex.names=1)
```
>TF for training finished

## Are you receiving personal psychotherapy or have you received it in the past?
```{r, echo=TRUE}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
Romania_data[, 7] <- as.numeric(Romania_data[, 7])
attributes(Romania_data)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
Romania_data[, 7] <- factor(Romania_data[, 7], levels=c(1,2),labels=c("Yes","No"))
names(Romania_data)[7] <- "q_0004"
#table(Romania_data$q_0004)
par(mar=c(3,3,2,2))
prop.table(table(Romania_data$q_0004))
pie(table(Romania_data$q_0004), main = "Receiving personal psychotherapy (present or past)")
```

```{r, echo=TRUE}
## I am undertaking training in Psychotherapy within my training programme in Psychiatry
## NO DATA ????
#tab <- table(Romania_data$q_0005_S05A1)
#length(tab)
#pie(table(Romania_data$q_0005_S05A1), main="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r, echo=TRUE}
table(Romania_data$q_0005_S05A2)
prop.table(table(Romania_data$q_0005_S05A2))
pie(table(Romania_data$q_0005_S05A2), main="Training in psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r, echo=TRUE}
#table(Romania_data$q_0005_S05A3)
pie(table(Romania_data$q_0005_S05A3),  main="I am not undertaking any training in Psychotherapy")
```

> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r, echo=TRUE}
#table(Romania_data$q_0005_S05A4)
prop.table(table(Romania_data$q_0005_S05A4))
pie(table(Romania_data$q_0005_S05A4), main="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality
```{r, echo=TRUE}
table(is.na(Romania_data$q_0006))
prop.table(table(is.na(Romania_data$q_0006)))
pie(table(is.na(Romania_data$q_0006)),main="I am training in some modality of psychotherapy")
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r, echo=TRUE}
table(Romania_data$q_0007)
prop.table(table(Romania_data$q_0007))
pie(table(Romania_data$q_0007), main="Psychotherapy important for the professional identity", col=terrain.colors(3))
```

## Do you want to practise Psychotherapy ?
```{r, echo=TRUE}
#table(Romania_data$q_0008)
prop.table(table(Romania_data$q_0008))
pie(table(Romania_data$q_0008), main="Plan to practise Psychotherapy after training")
```

## Are you interested in this psychotherapy?
```{r, echo=TRUE}
q9df <- Romania_data[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","Not Any","Other"),main="Interested in this therapy", las=1, col=rainbow(6),)
```

##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"
```{r, echo=TRUE, eval=FALSE}

barplot(table(Romania_data$q_0011_SQ001), col="green", main="Theoretical lectures or seminars in psychotherapy", border=NA)
abline(v=1.3, lwd=3)
text(0.6,215, "UEMS <", adj = c(0, -.1), font=2)
```
> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r, echo=TRUE, eval=FALSE}
#barplot(PWS, col="blue", main="Conducting Psychotherapy without supervision", border=NA)
```

```{r, echo=TRUE, eval=FALSE}

barplot(table(Romania_data$q_0011_SQ003), col="yellow", main="Conducting Psychotherapy under supervision")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Romania_data$q_0011_SQ004), col="orange", main="Personal Psychotherapy")
```

```{r, echo=TRUE}
TL <- table(Romania_data$q_0011_SQ001)
PNS <- table(Romania_data$q_0011_SQ002)
PWS <- table(Romania_data$q_0011_SQ003)
PP <- table(Romania_data$q_0011_SQ004)

mandatory <- cbind(prop.table(TL),prop.table(PNS), prop.table(PWS), prop.table(PP))
par(mar=c(3,3,5,9), xpd=TRUE)
barplot(mandatory, col=terrain.colors(3), names=c("Theorical lectures", "Psychotherapy 
without supervision", "Psychotherapy 
with supervision", "Personnal 
psychotherapy"), cex.name=1, main="The following experience in psychotherapy 
is a mandatory part of my training in Psychiatry", cex.main=1.5)
legend("topright", inset=c(-0.27,0), legend = c("Yes", "No", "Uncertain"), fill=(terrain.colors(3)), cex=0.9, bty="n")
```

```{r, echo=TRUE}
qualified <- prop.table(table(Romania_data$q_0012))
par(mar=c(4,5,5,3))
barplot(qualified, col=terrain.colors(3) , main="Are you qualified 
        to practice psychotherapy after your training ?", las=1, ylab="Frequency", cex.names=1.4, cex.lab=1.4, cex.main=1.4)
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
```{r, echo=TRUE}
#table(Romania_data$q_0013)
```

## How many hours of supervision
```{r, echo=TRUE}
par(mar=c(5,5,3,3), xpd=FALSE)
hist(Romania_data$q_0014_SQ001[which(is.na(Romania_data$q_0014_SQ001)==FALSE)], col="cornflowerblue", xlim=c(0,10), main ="Repartition of the hours of supervision in Europe", ylab="Frequency", xlab= "Hours by month", lwd=3, las=1, cex.lab=1.3, cex.main=1.3, breaks=10, freq=FALSE)
text(3.5, 0.30, paste(" Mean :",round(mean(Romania_data$q_0014_SQ001[which(is.na(Romania_data$q_0014_SQ001)==FALSE)]),2), "h"), font=2, cex=1.5, col="cornflowerblue")
text(3.3, 0.20, paste(" Median :", (median(Romania_data$q_0014_SQ001[which(is.na(Romania_data$q_0014_SQ001)==FALSE)])), "h"), font=2, cex=1.5, col="cornflowerblue")
abline(v=mean(Romania_data$q_0014_SQ001[which(is.na(Romania_data$q_0014_SQ001)==FALSE)]), col="cornflowerblue", lwd=3)
abline(v=1.7, lty=3, lwd=3)
text(3.5,0.40, "UEMS > 1.7h", font=2, cex=1.5)
#lines(density(Romania_data$q_0014_SQ002[which(is.na(Romania_data$q_0014_SQ002)==FALSE)]), col=rainbow(5)[2])
#lines(density(Romania_data$q_0014_SQ003[which(is.na(Romania_data$q_0014_SQ003)==FALSE)]), col=rainbow(5)[3])
#lines(density(Romania_data$q_0014_SQ004[which(is.na(Romania_data$q_0014_SQ004)==FALSE)]), col=rainbow(5)[4])
#lines(density(Romania_data$q_0014_SQ005[which(is.na(Romania_data$q_0014_SQ005)==FALSE)]), col=rainbow(5)[5])
#legend("topright", legend=c("Hours of Psychotherapy supervision per month", "Small group supervision (3 - 5 people)", "Large group supervision (more than 5 people)", "Generic Balint group", "Other form of supervision"), fill = rainbow(4), cex=0.7)
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r, echo=TRUE, eval=FALSE}
hist(Romania_data$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(2.5,300, "> UEMS", font=2)
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Romania_data$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Romania_data$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Romania_data$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r, echo=TRUE, eval=FALSE}
hist(Romania_data$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

table(Romania_data$q_0015)

##Who pays?
```{r, echo=TRUE, eval=FALSE}
barplot(table(Romania_data$q_0016_SQ002), col="light blue",
        xlab="Who pays for this component of Psychotherapy experience?",
        names=c("I pay", "State pays", "I don't have", "Free"),
        main="Supervision - individual")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Romania_data$q_0016_SQ003), col="light blue",
        main="Supervision - group",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Romania_data$q_0016_SQ004), col="light blue",
        main="Balint groups",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Romania_data$q_0016_SQ005), col="light blue",
        main="Sessions with patient(s)",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Romania_data$q_0016_SQ006), col="light blue",
        main="Self-experience",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays")
```

```{r, echo=TRUE}
par(mar=c(6,2.5,3,9), xpd=TRUE)
payTL <- table(Romania_data$q_0016_SQ001)
paySI <- table(Romania_data$q_0016_SQ002)
paySG <- table(Romania_data$q_0016_SQ003)
payBG <- table(Romania_data$q_0016_SQ004)
paySP <- table(Romania_data$q_0016_SQ005)
paySE <- table(Romania_data$q_0016_SQ006)
pay <- cbind(prop.table(payTL), prop.table(paySI), prop.table(paySG), prop.table(payBG), prop.table(paySP), prop.table(paySE))
barplot(pay, col=terrain.colors(4),
        main="Who pays?",
        names=c("Theorectical 
lectures", "Supervision 
indiv.", "Supervision 
group", "Balint
groups ", "Sessions
with patient(s)", "Self
experience"), cex.name=0.8, las=2)
legend("topright", inset=c(-0.38,0), legend = c("I pay", "The state pays", "I don't have", "Free"), fill=(terrain.colors(4)), cex=0.9, bty="n")
```

## Would you train for free?
```{r, echo=TRUE}
prop.table(table(Romania_data$q_0017))
par(mar=c(3,2,2,2))
pie(table(Romania_data$q_0017),
    main="Motivated to train in Psychotherapy for free?")
text(-0.2,-0.95, "UEMS recommendations states that psychotherapy training 
of trainees should be funded publicly and free for trainees.")
```

## How much would you invest in psychotherapy training ?
```{r, echo=TRUE}
par(mar=c(6,2.5,3,2), xpd=FALSE)
hist(Romania_data$q_0018[which(Romania_data$q_0018<100)], col="light green",
     main="% of annual salary for psychotherapy training",
     xlab="Percentage of your annual salary do you intend to spend on funding your psychotherapy training In the next 12 months?", cex.lab=1.1, cex.main=1.7)
abline(v=mean(Romania_data$q_0018[which(Romania_data$q_0018<100)]), lwd=2, lty=2)
text(20, 200, paste("Mean :",round( mean(Romania_data$q_0018[which(Romania_data$q_0018<100)])), " %"), font=2, cex=1.3)
text(20, 150, paste("Median :" , median(Romania_data$q_0018[which(Romania_data$q_0018<100)]), " %"), font=2, cex=1.3)
```

## Satisfaction group
```{r, echo=TRUE}
# make auxiliary table to hold our likert Romania_data
sat1<-Romania_data[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(Romania_data$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- Romania_data[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## UEMS recommendations awareness
```{r, echo=TRUE}
# and same with the
uems2 <- Romania_data[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

# Slovenia results
```{r,include = FALSE}
dim(Slovenia_data)
str(Slovenia_data)
summary(Slovenia_data)
```

## Number of participants
```{r, echo = FALSE}
# table(Slovenia_data[which(complete.cases(Slovenia_data$q_0000)==TRUE),]$q_0000)
countryanswers <- sort(table(Slovenia_data$q_0000), decreasing = FALSE)
answering_countries <- countryanswers[which (countryanswers > 0)]
#delete France false data
answering_countries <- answering_countries[-3]

par(mar=c(2.5,9.5,2,2))
barplot(answering_countries, cex.names=0.9, las=1, main="Number of answers by country", col="cornflowerblue", horiz=TRUE, border=NA)
text(45,6, paste(length(answering_countries), "countries
                Total of answers :", sum(answering_countries),
                 "
                              Mean answers by country: " , round(mean(answering_countries)),"
               
                      Top 4: Romania, France, 
                      Slovenia, Czech Republic"), cex=1.2)
abline(v=mean(answering_countries), lty=2)
text(19, 0.7,"Mean", font=2)
```

## Gender
```{r, echo=TRUE, fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
gender <-table(Slovenia_data$q_0001)
#prop.table(gender)
pie(gender, main="Gender of participants in Europe reponses")
```

##Age
```{r, echo=TRUE,  fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
#error max = 1969 !!!
age_Europe <- Slovenia_data$q_0002[which(Slovenia_data$q_0002<1969)]
hist(age_Europe, col="cornflowerblue",
     xlab="Age", ylab="Number", main="Age distribution", freq=TRUE, border=NA, breaks=25 )
text(47, 40, paste("Mean age:", round(mean(age_Europe),0), "years"))
abline(v=mean(age_Europe), lty=2)
```

## Year in Training
```{r, echo=TRUE}
YoT <- table(Slovenia_data$q_0003)
names(YoT)<- c(1:8, "> 8", "TF")
par(mfrow=c(1,1), mar=c(3,3,2,2))
barplot(YoT, main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number", cex.names=1)
```
>TF for training finished

## Are you receiving personal psychotherapy or have you received it in the past?
```{r, echo=TRUE}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
Slovenia_data[, 7] <- as.numeric(Slovenia_data[, 7])
attributes(Slovenia_data)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
Slovenia_data[, 7] <- factor(Slovenia_data[, 7], levels=c(1,2),labels=c("Yes","No"))
names(Slovenia_data)[7] <- "q_0004"
#table(Slovenia_data$q_0004)
par(mar=c(3,3,2,2))
prop.table(table(Slovenia_data$q_0004))
pie(table(Slovenia_data$q_0004), main = "Receiving personal psychotherapy (present or past)")
```

```{r, echo=TRUE}
## I am undertaking training in Psychotherapy within my training programme in Psychiatry
## NO DATA ????
#tab <- table(Slovenia_data$q_0005_S05A1)
#length(tab)
#pie(table(Slovenia_data$q_0005_S05A1), main="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r, echo=TRUE}
table(Slovenia_data$q_0005_S05A2)
prop.table(table(Slovenia_data$q_0005_S05A2))
pie(table(Slovenia_data$q_0005_S05A2), main="Training in psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r, echo=TRUE}
#table(Slovenia_data$q_0005_S05A3)
pie(table(Slovenia_data$q_0005_S05A3),  main="I am not undertaking any training in Psychotherapy")
```

> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r, echo=TRUE}
#table(Slovenia_data$q_0005_S05A4)
prop.table(table(Slovenia_data$q_0005_S05A4))
pie(table(Slovenia_data$q_0005_S05A4), main="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality
```{r, echo=TRUE}
table(is.na(Slovenia_data$q_0006))
prop.table(table(is.na(Slovenia_data$q_0006)))
pie(table(is.na(Slovenia_data$q_0006)),main="I am training in some modality of psychotherapy")
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r, echo=TRUE}
table(Slovenia_data$q_0007)
prop.table(table(Slovenia_data$q_0007))
pie(table(Slovenia_data$q_0007), main="Psychotherapy important for the professional identity", col=terrain.colors(3))
```

## Do you want to practise Psychotherapy ?
```{r, echo=TRUE}
#table(Slovenia_data$q_0008)
prop.table(table(Slovenia_data$q_0008))
pie(table(Slovenia_data$q_0008), main="Plan to practise Psychotherapy after training")
```

## Are you interested in this psychotherapy?
```{r, echo=TRUE}
q9df <- Slovenia_data[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","Not Any","Other"),main="Interested in this therapy", las=1, col=rainbow(6),)
```

##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"
```{r, echo=TRUE, eval=FALSE}

barplot(table(Slovenia_data$q_0011_SQ001), col="green", main="Theoretical lectures or seminars in psychotherapy", border=NA)
abline(v=1.3, lwd=3)
text(0.6,215, "UEMS <", adj = c(0, -.1), font=2)
```
> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r, echo=TRUE, eval=FALSE}
#barplot(PWS, col="blue", main="Conducting Psychotherapy without supervision", border=NA)
```

```{r, echo=TRUE, eval=FALSE}

barplot(table(Slovenia_data$q_0011_SQ003), col="yellow", main="Conducting Psychotherapy under supervision")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Slovenia_data$q_0011_SQ004), col="orange", main="Personal Psychotherapy")
```

```{r, echo=TRUE}
TL <- table(Slovenia_data$q_0011_SQ001)
PNS <- table(Slovenia_data$q_0011_SQ002)
PWS <- table(Slovenia_data$q_0011_SQ003)
PP <- table(Slovenia_data$q_0011_SQ004)

mandatory <- cbind(prop.table(TL),prop.table(PNS), prop.table(PWS), prop.table(PP))
par(mar=c(3,3,5,9), xpd=TRUE)
barplot(mandatory, col=terrain.colors(3), names=c("Theorical lectures", "Psychotherapy 
without supervision", "Psychotherapy 
with supervision", "Personnal 
psychotherapy"), cex.name=1, main="The following experience in psychotherapy 
is a mandatory part of my training in Psychiatry", cex.main=1.5)
legend("topright", inset=c(-0.27,0), legend = c("Yes", "No", "Uncertain"), fill=(terrain.colors(3)), cex=0.9, bty="n")
```

```{r, echo=TRUE}
qualified <- prop.table(table(Slovenia_data$q_0012))
par(mar=c(4,5,5,3))
barplot(qualified, col=terrain.colors(3) , main="Are you qualified 
        to practice psychotherapy after your training ?", las=1, ylab="Frequency", cex.names=1.4, cex.lab=1.4, cex.main=1.4)
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
```{r, echo=TRUE}
#table(Slovenia_data$q_0013)
```

## How many hours of supervision
```{r, echo=TRUE}
par(mar=c(5,5,3,3), xpd=FALSE)
hist(Slovenia_data$q_0014_SQ001[which(is.na(Slovenia_data$q_0014_SQ001)==FALSE)], col="cornflowerblue", xlim=c(0,10), main ="Repartition of the hours of supervision in Europe", ylab="Frequency", xlab= "Hours by month", lwd=3, las=1, cex.lab=1.3, cex.main=1.3, breaks=10, freq=FALSE)
text(3.5, 0.30, paste(" Mean :",round(mean(Slovenia_data$q_0014_SQ001[which(is.na(Slovenia_data$q_0014_SQ001)==FALSE)]),2), "h"), font=2, cex=1.5, col="cornflowerblue")
text(3.3, 0.20, paste(" Median :", (median(Slovenia_data$q_0014_SQ001[which(is.na(Slovenia_data$q_0014_SQ001)==FALSE)])), "h"), font=2, cex=1.5, col="cornflowerblue")
abline(v=mean(Slovenia_data$q_0014_SQ001[which(is.na(Slovenia_data$q_0014_SQ001)==FALSE)]), col="cornflowerblue", lwd=3)
abline(v=1.7, lty=3, lwd=3)
text(3.5,0.40, "UEMS > 1.7h", font=2, cex=1.5)
#lines(density(Slovenia_data$q_0014_SQ002[which(is.na(Slovenia_data$q_0014_SQ002)==FALSE)]), col=rainbow(5)[2])
#lines(density(Slovenia_data$q_0014_SQ003[which(is.na(Slovenia_data$q_0014_SQ003)==FALSE)]), col=rainbow(5)[3])
#lines(density(Slovenia_data$q_0014_SQ004[which(is.na(Slovenia_data$q_0014_SQ004)==FALSE)]), col=rainbow(5)[4])
#lines(density(Slovenia_data$q_0014_SQ005[which(is.na(Slovenia_data$q_0014_SQ005)==FALSE)]), col=rainbow(5)[5])
#legend("topright", legend=c("Hours of Psychotherapy supervision per month", "Small group supervision (3 - 5 people)", "Large group supervision (more than 5 people)", "Generic Balint group", "Other form of supervision"), fill = rainbow(4), cex=0.7)
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r, echo=TRUE, eval=FALSE}
hist(Slovenia_data$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(2.5,300, "> UEMS", font=2)
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Slovenia_data$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Slovenia_data$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Slovenia_data$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r, echo=TRUE, eval=FALSE}
hist(Slovenia_data$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

table(Slovenia_data$q_0015)

##Who pays?
```{r, echo=TRUE, eval=FALSE}
barplot(table(Slovenia_data$q_0016_SQ002), col="light blue",
        xlab="Who pays for this component of Psychotherapy experience?",
        names=c("I pay", "State pays", "I don't have", "Free"),
        main="Supervision - individual")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Slovenia_data$q_0016_SQ003), col="light blue",
        main="Supervision - group",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Slovenia_data$q_0016_SQ004), col="light blue",
        main="Balint groups",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Slovenia_data$q_0016_SQ005), col="light blue",
        main="Sessions with patient(s)",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Slovenia_data$q_0016_SQ006), col="light blue",
        main="Self-experience",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays")
```

```{r, echo=TRUE}
par(mar=c(6,2.5,3,9), xpd=TRUE)
payTL <- table(Slovenia_data$q_0016_SQ001)
paySI <- table(Slovenia_data$q_0016_SQ002)
paySG <- table(Slovenia_data$q_0016_SQ003)
payBG <- table(Slovenia_data$q_0016_SQ004)
paySP <- table(Slovenia_data$q_0016_SQ005)
paySE <- table(Slovenia_data$q_0016_SQ006)
pay <- cbind(prop.table(payTL), prop.table(paySI), prop.table(paySG), prop.table(payBG), prop.table(paySP), prop.table(paySE))
barplot(pay, col=terrain.colors(4),
        main="Who pays?",
        names=c("Theorectical 
lectures", "Supervision 
indiv.", "Supervision 
group", "Balint
groups ", "Sessions
with patient(s)", "Self
experience"), cex.name=0.8, las=2)
legend("topright", inset=c(-0.38,0), legend = c("I pay", "The state pays", "I don't have", "Free"), fill=(terrain.colors(4)), cex=0.9, bty="n")
```

## Would you train for free?
```{r, echo=TRUE}
prop.table(table(Slovenia_data$q_0017))
par(mar=c(3,2,2,2))
pie(table(Slovenia_data$q_0017),
    main="Motivated to train in Psychotherapy for free?")
text(-0.2,-0.95, "UEMS recommendations states that psychotherapy training 
of trainees should be funded publicly and free for trainees.")
```

## How much would you invest in psychotherapy training ?
```{r, echo=TRUE}
par(mar=c(6,2.5,3,2), xpd=FALSE)
hist(Slovenia_data$q_0018[which(Slovenia_data$q_0018<100)], col="light green",
     main="% of annual salary for psychotherapy training",
     xlab="Percentage of your annual salary do you intend to spend on funding your psychotherapy training In the next 12 months?", cex.lab=1.1, cex.main=1.7)
abline(v=mean(Slovenia_data$q_0018[which(Slovenia_data$q_0018<100)]), lwd=2, lty=2)
text(20, 200, paste("Mean :",round( mean(Slovenia_data$q_0018[which(Slovenia_data$q_0018<100)])), " %"), font=2, cex=1.3)
text(20, 150, paste("Median :" , median(Slovenia_data$q_0018[which(Slovenia_data$q_0018<100)]), " %"), font=2, cex=1.3)
```

## Satisfaction group
```{r, echo=TRUE}
# make auxiliary table to hold our likert Slovenia_data
sat1<-Slovenia_data[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(Slovenia_data$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- Slovenia_data[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## UEMS recommendations awareness
```{r, echo=TRUE}
# and same with the
uems2 <- Slovenia_data[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

# Spain results
```{r,include = FALSE}
dim(Spain_data)
str(Spain_data)
summary(Spain_data)
```

## Number of participants
```{r, echo = FALSE}
# table(Spain_data[which(complete.cases(Spain_data$q_0000)==TRUE),]$q_0000)
countryanswers <- sort(table(Spain_data$q_0000), decreasing = FALSE)
answering_countries <- countryanswers[which (countryanswers > 0)]
#delete France false data
answering_countries <- answering_countries[-3]

par(mar=c(2.5,9.5,2,2))
barplot(answering_countries, cex.names=0.9, las=1, main="Number of answers by country", col="cornflowerblue", horiz=TRUE, border=NA)
text(45,6, paste(length(answering_countries), "countries
                Total of answers :", sum(answering_countries),
                 "
                              Mean answers by country: " , round(mean(answering_countries)),"
               
                      Top 4: Romania, France, 
                      Slovenia, Czech Republic"), cex=1.2)
abline(v=mean(answering_countries), lty=2)
text(19, 0.7,"Mean", font=2)
```

## Gender
```{r, echo=TRUE, fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
gender <-table(Spain_data$q_0001)
#prop.table(gender)
pie(gender, main="Gender of participants in Europe reponses")
```

##Age
```{r, echo=TRUE,  fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
#error max = 1969 !!!
age_Europe <- Spain_data$q_0002[which(Spain_data$q_0002<1969)]
hist(age_Europe, col="cornflowerblue",
     xlab="Age", ylab="Number", main="Age distribution", freq=TRUE, border=NA, breaks=25 )
text(47, 40, paste("Mean age:", round(mean(age_Europe),0), "years"))
abline(v=mean(age_Europe), lty=2)
```

## Year in Training
```{r, echo=TRUE}
YoT <- table(Spain_data$q_0003)
names(YoT)<- c(1:8, "> 8", "TF")
par(mfrow=c(1,1), mar=c(3,3,2,2))
barplot(YoT, main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number", cex.names=1)
```
>TF for training finished

## Are you receiving personal psychotherapy or have you received it in the past?
```{r, echo=TRUE}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
Spain_data[, 7] <- as.numeric(Spain_data[, 7])
attributes(Spain_data)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
Spain_data[, 7] <- factor(Spain_data[, 7], levels=c(1,2),labels=c("Yes","No"))
names(Spain_data)[7] <- "q_0004"
#table(Spain_data$q_0004)
par(mar=c(3,3,2,2))
prop.table(table(Spain_data$q_0004))
pie(table(Spain_data$q_0004), main = "Receiving personal psychotherapy (present or past)")
```

```{r, echo=TRUE}
## I am undertaking training in Psychotherapy within my training programme in Psychiatry
## NO DATA ????
#tab <- table(Spain_data$q_0005_S05A1)
#length(tab)
#pie(table(Spain_data$q_0005_S05A1), main="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r, echo=TRUE}
table(Spain_data$q_0005_S05A2)
prop.table(table(Spain_data$q_0005_S05A2))
pie(table(Spain_data$q_0005_S05A2), main="Training in psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r, echo=TRUE}
#table(Spain_data$q_0005_S05A3)
pie(table(Spain_data$q_0005_S05A3),  main="I am not undertaking any training in Psychotherapy")
```

> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r, echo=TRUE}
#table(Spain_data$q_0005_S05A4)
prop.table(table(Spain_data$q_0005_S05A4))
pie(table(Spain_data$q_0005_S05A4), main="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality
```{r, echo=TRUE}
table(is.na(Spain_data$q_0006))
prop.table(table(is.na(Spain_data$q_0006)))
pie(table(is.na(Spain_data$q_0006)),main="I am training in some modality of psychotherapy")
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r, echo=TRUE}
table(Spain_data$q_0007)
prop.table(table(Spain_data$q_0007))
pie(table(Spain_data$q_0007), main="Psychotherapy important for the professional identity", col=terrain.colors(3))
```

## Do you want to practise Psychotherapy ?
```{r, echo=TRUE}
#table(Spain_data$q_0008)
prop.table(table(Spain_data$q_0008))
pie(table(Spain_data$q_0008), main="Plan to practise Psychotherapy after training")
```

## Are you interested in this psychotherapy?
```{r, echo=TRUE}
q9df <- Spain_data[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","Not Any","Other"),main="Interested in this therapy", las=1, col=rainbow(6),)
```

##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"
```{r, echo=TRUE, eval=FALSE}

barplot(table(Spain_data$q_0011_SQ001), col="green", main="Theoretical lectures or seminars in psychotherapy", border=NA)
abline(v=1.3, lwd=3)
text(0.6,215, "UEMS <", adj = c(0, -.1), font=2)
```
> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r, echo=TRUE, eval=FALSE}
#barplot(PWS, col="blue", main="Conducting Psychotherapy without supervision", border=NA)
```

```{r, echo=TRUE, eval=FALSE}

barplot(table(Spain_data$q_0011_SQ003), col="yellow", main="Conducting Psychotherapy under supervision")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Spain_data$q_0011_SQ004), col="orange", main="Personal Psychotherapy")
```

```{r, echo=TRUE}
TL <- table(Spain_data$q_0011_SQ001)
PNS <- table(Spain_data$q_0011_SQ002)
PWS <- table(Spain_data$q_0011_SQ003)
PP <- table(Spain_data$q_0011_SQ004)

mandatory <- cbind(prop.table(TL),prop.table(PNS), prop.table(PWS), prop.table(PP))
par(mar=c(3,3,5,9), xpd=TRUE)
barplot(mandatory, col=terrain.colors(3), names=c("Theorical lectures", "Psychotherapy 
without supervision", "Psychotherapy 
with supervision", "Personnal 
psychotherapy"), cex.name=1, main="The following experience in psychotherapy 
is a mandatory part of my training in Psychiatry", cex.main=1.5)
legend("topright", inset=c(-0.27,0), legend = c("Yes", "No", "Uncertain"), fill=(terrain.colors(3)), cex=0.9, bty="n")
```

```{r, echo=TRUE}
qualified <- prop.table(table(Spain_data$q_0012))
par(mar=c(4,5,5,3))
barplot(qualified, col=terrain.colors(3) , main="Are you qualified 
        to practice psychotherapy after your training ?", las=1, ylab="Frequency", cex.names=1.4, cex.lab=1.4, cex.main=1.4)
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
```{r, echo=TRUE}
#table(Spain_data$q_0013)
```

## How many hours of supervision
```{r, echo=TRUE}
par(mar=c(5,5,3,3), xpd=FALSE)
hist(Spain_data$q_0014_SQ001[which(is.na(Spain_data$q_0014_SQ001)==FALSE)], col="cornflowerblue", xlim=c(0,10), main ="Repartition of the hours of supervision in Europe", ylab="Frequency", xlab= "Hours by month", lwd=3, las=1, cex.lab=1.3, cex.main=1.3, breaks=10, freq=FALSE)
text(3.5, 0.30, paste(" Mean :",round(mean(Spain_data$q_0014_SQ001[which(is.na(Spain_data$q_0014_SQ001)==FALSE)]),2), "h"), font=2, cex=1.5, col="cornflowerblue")
text(3.3, 0.20, paste(" Median :", (median(Spain_data$q_0014_SQ001[which(is.na(Spain_data$q_0014_SQ001)==FALSE)])), "h"), font=2, cex=1.5, col="cornflowerblue")
abline(v=mean(Spain_data$q_0014_SQ001[which(is.na(Spain_data$q_0014_SQ001)==FALSE)]), col="cornflowerblue", lwd=3)
abline(v=1.7, lty=3, lwd=3)
text(3.5,0.40, "UEMS > 1.7h", font=2, cex=1.5)
#lines(density(Spain_data$q_0014_SQ002[which(is.na(Spain_data$q_0014_SQ002)==FALSE)]), col=rainbow(5)[2])
#lines(density(Spain_data$q_0014_SQ003[which(is.na(Spain_data$q_0014_SQ003)==FALSE)]), col=rainbow(5)[3])
#lines(density(Spain_data$q_0014_SQ004[which(is.na(Spain_data$q_0014_SQ004)==FALSE)]), col=rainbow(5)[4])
#lines(density(Spain_data$q_0014_SQ005[which(is.na(Spain_data$q_0014_SQ005)==FALSE)]), col=rainbow(5)[5])
#legend("topright", legend=c("Hours of Psychotherapy supervision per month", "Small group supervision (3 - 5 people)", "Large group supervision (more than 5 people)", "Generic Balint group", "Other form of supervision"), fill = rainbow(4), cex=0.7)
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r, echo=TRUE, eval=FALSE}
hist(Spain_data$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(2.5,300, "> UEMS", font=2)
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Spain_data$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Spain_data$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r, echo=TRUE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(Spain_data$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r, echo=TRUE, eval=FALSE}
hist(Spain_data$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

table(Spain_data$q_0015)

##Who pays?
```{r, echo=TRUE, eval=FALSE}
barplot(table(Spain_data$q_0016_SQ002), col="light blue",
        xlab="Who pays for this component of Psychotherapy experience?",
        names=c("I pay", "State pays", "I don't have", "Free"),
        main="Supervision - individual")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Spain_data$q_0016_SQ003), col="light blue",
        main="Supervision - group",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Spain_data$q_0016_SQ004), col="light blue",
        main="Balint groups",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Spain_data$q_0016_SQ005), col="light blue",
        main="Sessions with patient(s)",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=TRUE, eval=FALSE}
barplot(table(Spain_data$q_0016_SQ006), col="light blue",
        main="Self-experience",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays")
```

```{r, echo=TRUE}
par(mar=c(6,2.5,3,9), xpd=TRUE)
payTL <- table(Spain_data$q_0016_SQ001)
paySI <- table(Spain_data$q_0016_SQ002)
paySG <- table(Spain_data$q_0016_SQ003)
payBG <- table(Spain_data$q_0016_SQ004)
paySP <- table(Spain_data$q_0016_SQ005)
paySE <- table(Spain_data$q_0016_SQ006)
pay <- cbind(prop.table(payTL), prop.table(paySI), prop.table(paySG), prop.table(payBG), prop.table(paySP), prop.table(paySE))
barplot(pay, col=terrain.colors(4),
        main="Who pays?",
        names=c("Theorectical 
lectures", "Supervision 
indiv.", "Supervision 
group", "Balint
groups ", "Sessions
with patient(s)", "Self
experience"), cex.name=0.8, las=2)
legend("topright", inset=c(-0.38,0), legend = c("I pay", "The state pays", "I don't have", "Free"), fill=(terrain.colors(4)), cex=0.9, bty="n")
```

## Would you train for free?
```{r, echo=TRUE}
prop.table(table(Spain_data$q_0017))
par(mar=c(3,2,2,2))
pie(table(Spain_data$q_0017),
    main="Motivated to train in Psychotherapy for free?")
text(-0.2,-0.95, "UEMS recommendations states that psychotherapy training 
of trainees should be funded publicly and free for trainees.")
```

## How much would you invest in psychotherapy training ?
```{r, echo=TRUE}
par(mar=c(6,2.5,3,2), xpd=FALSE)
hist(Spain_data$q_0018[which(Spain_data$q_0018<100)], col="light green",
     main="% of annual salary for psychotherapy training",
     xlab="Percentage of your annual salary do you intend to spend on funding your psychotherapy training In the next 12 months?", cex.lab=1.1, cex.main=1.7)
abline(v=mean(Spain_data$q_0018[which(Spain_data$q_0018<100)]), lwd=2, lty=2)
text(20, 200, paste("Mean :",round( mean(Spain_data$q_0018[which(Spain_data$q_0018<100)])), " %"), font=2, cex=1.3)
text(20, 150, paste("Median :" , median(Spain_data$q_0018[which(Spain_data$q_0018<100)]), " %"), font=2, cex=1.3)
```

## Satisfaction group
```{r, echo=TRUE}
# make auxiliary table to hold our likert Spain_data
sat1<-Spain_data[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(Spain_data$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- Spain_data[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## UEMS recommendations awareness
```{r, echo=TRUE}
# and same with the
uems2 <- Spain_data[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## Research
UEMS recommendations states that research methodology should be included in psychotherapy training.

## Bibliography
* Please join our [zotero group](https://www.zotero.org/groups/480046)

